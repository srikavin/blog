<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta content="width=device-width,initial-scale=1" name="viewport"><title>pwnable.kr - Tags - srikavin.me</title><link href="/assets/favicon.png" rel="icon"><link href="/bundle.css" rel="stylesheet"><script src="https://www.googletagmanager.com/gtag/js?id=G-X8ZVFPQ0CK" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-X8ZVFPQ0CK');</script></head><body><script>const theme = localStorage.getItem("theme");
    document.body.className = "light"; // theme || (window.matchMedia("(prefers-color-scheme: dark)").matches ? "dark" : "light");</script><nav><div class="nav-left"><span><a href="https://srikavin.me" class="name">Srikavin Ramkumar</a> </span><span><a href="/posts" class="nav-link">Posts</a> </span><span><a href="/tags" class="nav-link">Tags</a></span></div><div class="nav-right"><a href="https://github.com/srikavin"><img alt="Github" src="/assets/gh-logo.png" height="24px" width="24px"></a></div></nav><section class="section"><div class="container"><div class="page-container tags-content"><h1>Posts tagged with <span class="minimal tag">pwnable.kr</span></h1><div class="blog-preview-list"><div class="blog-preview"><div class="blog-header"><h1 class="title"><a href="https://blog.srikavin.me/posts/pwnable-kr-toddler-s-bottle/">pwnable.kr - Toddler&#x27;s Bottle</a></h1><div class="subtitle"><span>Posted on <span class="date" title="Created: 2020-04-27T12:59:37.396Z&#10;Updated: 2020-12-27">April 27, 2020* </span>in ctf-writeups</span></div><div class="tags"><a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;pwnable-kr&#x2F;"><span class="minimal tag interactive">pwnable.kr</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;binary-exploitation&#x2F;"><span class="minimal tag interactive">binary-exploitation</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;buffer-overflow&#x2F;"><span class="minimal tag interactive">buffer-overflow</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;pwntools&#x2F;"><span class="minimal tag interactive">pwntools</span></a></div></div><div class="blog-content"><h1 id="fd-1pt">fd - 1pt</h1><h2 id="challenge">Challenge</h2><blockquote><p>Mommy! what is a file descriptor in Linux?</p><p>ssh fd@pwnable.kr -p2222 (pw:guest)</p></blockquote><h2 id="source-code">Source Code</h2><p>After ssh-ing into the server with the given details, we can view the source code of the challenge by running <code>cat fd.c</code>:</p><pre style="background-color:#ffffff;">
<code><span style="font-weight:bold;color:#a71d5d;">#include </span><span style="color:#183691;">&lt;stdio.h&gt;
</span><span style="font-weight:bold;color:#a71d5d;">#include </span><span style="color:#183691;">&lt;stdlib.h&gt;
</span><span style="font-weight:bold;color:#a71d5d;">#include </span><span style="color:#183691;">&lt;string.h&gt;
</span><span style="font-weight:bold;color:#a71d5d;">char</span><span style="color:#323232;"> buf[</span><span style="color:#0086b3;">32</span><span style="color:#323232;">];
</span><span style="font-weight:bold;color:#a71d5d;">int </span><span style="font-weight:bold;color:#795da3;">main</span><span style="color:#323232;">(</span><span style="font-weight:bold;color:#a71d5d;">int </span><span style="color:#323232;">argc, </span><span style="font-weight:bold;color:#a71d5d;">char* </span><span style="color:#323232;">argv[], </span><span style="font-weight:bold;color:#a71d5d;">char* </span><span style="color:#323232;">envp[]){
        </span><span style="font-weight:bold;color:#a71d5d;">if</span><span style="color:#323232;">(argc</span><span style="font-weight:bold;color:#a71d5d;">&lt;</span><span style="color:#0086b3;">2</span><span style="color:#323232;">){
                </span><span style="color:#62a35c;">printf</span><span style="color:#323232;">(</span><span style="color:#183691;">&quot;pass argv[1] a number</span><span style="color:#0086b3;">\n</span><span style="color:#183691;">&quot;</span><span style="color:#323232;">);
                </span><span style="font-weight:bold;color:#a71d5d;">return </span><span style="color:#0086b3;">0</span><span style="color:#323232;">;
        }
        </span><span style="font-weight:bold;color:#a71d5d;">int</span><span style="color:#323232;"> fd </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#62a35c;">atoi</span><span style="color:#323232;">( argv[</span><span style="color:#0086b3;">1</span><span style="color:#323232;">] ) </span><span style="font-weight:bold;color:#a71d5d;">- </span><span style="color:#0086b3;">0x1234</span><span style="color:#323232;">;
        </span><span style="font-weight:bold;color:#a71d5d;">int</span><span style="color:#323232;"> len </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#0086b3;">0</span><span style="color:#323232;">;
        len </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#323232;">read(fd, buf, </span><span style="color:#0086b3;">32</span><span style="color:#323232;">);
        </span><span style="font-weight:bold;color:#a71d5d;">if</span><span style="color:#323232;">(</span><span style="font-weight:bold;color:#a71d5d;">!</span><span style="color:#62a35c;">strcmp</span><span style="color:#323232;">(</span><span style="color:#183691;">&quot;LETMEWIN</span><span style="color:#0086b3;">\n</span><span style="color:#183691;">&quot;</span><span style="color:#323232;">, buf)){
                </span><span style="color:#62a35c;">printf</span><span style="color:#323232;">(</span><span style="color:#183691;">&quot;good job :)</span><span style="color:#0086b3;">\n</span><span style="color:#183691;">&quot;</span><span style="color:#323232;">);
                </span><span style="color:#62a35c;">system</span><span style="color:#323232;">(</span><span style="color:#183691;">&quot;/bin/cat flag&quot;</span><span style="color:#323232;">);
                </span><span style="color:#62a35c;">exit</span><span style="color:#323232;">(</span><span style="color:#0086b3;">0</span><span style="color:#323232;">);
        }
        </span><span style="color:#62a35c;">printf</span><span style="color:#323232;">(</span><span style="color:#183691;">&quot;learn about Linux file IO</span><span style="color:#0086b3;">\n</span><span style="color:#183691;">&quot;</span><span style="color:#323232;">);
        </span><span style="font-weight:bold;color:#a71d5d;">return </span><span style="color:#0086b3;">0</span><span style="color:#323232;">;
}
</span></code></pre></div><a href="https://blog.srikavin.me/posts/pwnable-kr-toddler-s-bottle/" class="blog-preview-continue-reading">Continue Reading</a></div></div></div></div></section><div class="disabled" id="theme-selector"><div id="dark-icon"><img alt="Switch to Dark Mode" src="/assets/dark-icon.svg"><div>Dark</div></div><div id="light-icon"><img alt="Switch to Light Mode" src="/assets/light-icon.svg"><div>Light</div></div></div><script>const ts = document.getElementById("theme-selector");
    // ts.classList.remove("disabled");
    ts.onclick = () => {
        if (document.body.classList.contains("dark")) {
            document.body.classList.remove("dark");
            document.body.classList.add("light");
        } else {
            document.body.classList.remove("light");
            document.body.classList.add("dark");
        }
        localStorage.setItem("theme", document.body.classList.contains("dark") ? "dark" : "light");
    };</script><script src="/bundle.js" defer></script></body></html>