<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta content="width=device-width,initial-scale=1" name="viewport"><title>python - Tags - srikavin.me</title><link href="/favicon.png" rel="icon"><link href="/bundle.css" rel="stylesheet"></head><body><nav><div class="nav-left"><span><a href="https://srikavin.me" class="name">Srikavin Ramkumar</a> </span><span><a href="/posts" class="nav-link">Posts</a> </span><span><a href="/tags" class="nav-link">Tags</a></span></div></nav><section class="section"><div class="container"><div class="page-container tags-content"><h1>Posts tagged with <span class="minimal tag">python</span></h1><div class="blog-preview-list"><div class="blog-preview"><div class="blog-header"><h1 class="title"><a href="/posts/redpwnctf20-aall/">redpwnCTF - aall</a></h1><div class="subtitle"><span>Posted on <span class="date" title="Created: 2020-06-25">June 25, 2020 </span>in ctf-writeups</span></div><div class="tags"><a href="&#x2F;tags&#x2F;redpwnctf20&#x2F;"><span class="minimal tag interactive">redpwnctf20</span></a> <a href="&#x2F;tags&#x2F;reversing&#x2F;"><span class="minimal tag interactive">reversing</span></a> <a href="&#x2F;tags&#x2F;python&#x2F;"><span class="minimal tag interactive">python</span></a></div></div><div class="blog-content"><h1 id="challenge">Challenge</h1><blockquote><p>how many layers of vm are you on</p><p>like,, maybe 5, or 6 right now my dude</p><p>you are like a baby... watch this</p><p>nc 2020.redpwnc.tf 31755</p></blockquote><p>We're also given a <a href="https://gist.github.com/srikavin/f6fc3f9cf62155b95868bac16a40ba5a#file-aall-py">python file</a> and a <a href="https://gist.github.com/srikavin/f6fc3f9cf62155b95868bac16a40ba5a#file-dockerfile">Dockerfile</a>.</p><h1 id="decoding">Decoding</h1><p>Looking at the python file shows that it writes out a file named <code>breakout.aallo</code> and calls <code>exec</code> on a string after base64-decoding and lzma-uncompressing it. We can modify the file to save the executed file to disk instead. It's a <a href="https://gist.github.com/srikavin/0cba74ad88e43442154dd341979c9b6d">python script</a>, but all of the variables are random unicode characters. Although the python interpreter is happy to run the code, it's nearly impossible to understand.</p></div><a href="/posts/redpwnctf20-aall/" class="blog-preview-continue-reading">Continue Reading</a></div><div class="blog-preview"><div class="blog-header"><h1 class="title"><a href="/posts/picoctf-2018-circuit123/">picoCTF 2018 - circuit123</a></h1><div class="subtitle"><span>Posted on <span class="date" title="Created: 2018-10-17T02:23:29.709Z&#10;Updated: 2018-10-17T02:29:08.242Z">October 17, 2018* </span>in ctf-writeups</span></div><div class="tags"><a href="&#x2F;tags&#x2F;picoctf18&#x2F;"><span class="minimal tag interactive">picoctf18</span></a> <a href="&#x2F;tags&#x2F;python&#x2F;"><span class="minimal tag interactive">python</span></a> <a href="&#x2F;tags&#x2F;z3&#x2F;"><span class="minimal tag interactive">z3</span></a> <a href="&#x2F;tags&#x2F;reversing&#x2F;"><span class="minimal tag interactive">reversing</span></a></div></div><div class="blog-content"><h1 id="problem">Problem</h1><blockquote><p>Can you crack the key to <a href="https://2018shell2.picoctf.com/static/27ebc8a7ba2202cfcba1471080e05e2c/decrypt.py">decrypt</a> <a href="https://2018shell2.picoctf.com/static/27ebc8a7ba2202cfcba1471080e05e2c/map2.txt">map2</a> for us? The key to <a href="https://2018shell2.picoctf.com/static/27ebc8a7ba2202cfcba1471080e05e2c/map1.txt">map1</a> is 11443513758266689915.</p></blockquote><h2 id="hint">Hint</h2><blockquote><p>z3</p></blockquote><h1 id="solution">Solution</h1><p>Given the problem and the hint, it is clear that we can use z3 to solve this problem. We can create a z3 <code>BitVec</code> and pass it into the verify function to avoid writing a custom decrypter. Because we don't know the length of the bit vector, I used a conservative estimate of <code>128</code>.</p></div><a href="/posts/picoctf-2018-circuit123/" class="blog-preview-continue-reading">Continue Reading</a></div><div class="blog-preview"><div class="blog-header"><h1 class="title"><a href="/posts/picoctf-2018-flaskcards-and-freedom/">picoCTF 2018 - Flaskcards and Freedom</a></h1><div class="subtitle"><span>Posted on <span class="date" title="Created: 2018-10-12T21:02:44.42Z&#10;Updated: 2018-10-12T22:55:27.216Z">October 12, 2018* </span>in ctf-writeups</span></div><div class="tags"><a href="&#x2F;tags&#x2F;picoctf18&#x2F;"><span class="minimal tag interactive">picoctf18</span></a> <a href="&#x2F;tags&#x2F;web&#x2F;"><span class="minimal tag interactive">web</span></a> <a href="&#x2F;tags&#x2F;python&#x2F;"><span class="minimal tag interactive">python</span></a> <a href="&#x2F;tags&#x2F;rce&#x2F;"><span class="minimal tag interactive">rce</span></a></div></div><div class="blog-content"><h1 id="problem">Problem</h1><blockquote><p>&quot;There seem to be a few more files stored on the flash card server but we can't login. Can you?&quot;</p></blockquote><h1 id="solution">Solution</h1><p>The site appears to be the same as the previous flaskcard challenges <code>Flaskcards Skeleton Key</code> and <code>Flaskcards.</code></p><p>When we create an account, we are presented with the following screen: <img alt="" src="/posts/picoctf-2018-flaskcards-and-freedom/5bc10c83f1882e545d7f430a.png"></p><p>We can try server side injection. If we type in <code>{{1+1}}</code>, the webpage displays <code>2</code>. Any values in double brackets is being executed on the server. After trying to find hidden variables, such as <code>config</code>, <code>flag</code>, etc; I decided to look for a remote code execution vulnerability.</p></div><a href="/posts/picoctf-2018-flaskcards-and-freedom/" class="blog-preview-continue-reading">Continue Reading</a></div></div></div></div></section><script src="/bundle.js"></script></body></html>