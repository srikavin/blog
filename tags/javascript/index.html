<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
     
    <title>
javascript - Tags
 - srikavin.me</title>
    <link rel="stylesheet" href="/bundle.css">
</head>

<body>
<nav>
    <div class="nav-left">
        <span>
            <a href="https://srikavin.me" class="name">Srikavin Ramkumar</a>
        </span>
        <span>
            <a href="/posts" class="nav-link">Posts</a>
        </span>
        <span>
            <a class="nav-link" href="/tags">Tags</a>
        </span>
    </div>
</nav>
<section class="section">
    <div class="container">
        

<div class="tags-content">
    <h1>Posts tagged with <span class="tag minimal">javascript</span></h1>
    
<div class="blog-preview-list">
    
    <div class="blog-preview">
        

<div class="blog-header">
    <h1 class="title">
        
        <a href="/posts/picoctf-2019-java-script-kiddie-2/">picoCTF 2019 - Java Script Kiddie 2</a>
        
    </h1>
    <div class="subtitle">
                    <span>Posted on
                        <span class="date" title="Created: 2019-10-12T22:48:41.356Z&#10;Updated: 2019-11-14T04:43:58.202Z">October 12, 2019*
                        </span>

                        in ctf-writeups
                        
                </span>
    </div>
    <div class="tags">
        
        
        <a href="&#x2F;tags&#x2F;picoctf19&#x2F;"><span class="tag minimal interactive">picoctf19</span></a>
        
        
        <a href="&#x2F;tags&#x2F;web&#x2F;"><span class="tag minimal interactive">web</span></a>
        
        
        <a href="&#x2F;tags&#x2F;reversing&#x2F;"><span class="tag minimal interactive">reversing</span></a>
        
        
        <a href="&#x2F;tags&#x2F;javascript&#x2F;"><span class="tag minimal interactive">javascript</span></a>
        
    </div>
</div>

<div class="blog-content">
    <p>We are given a website, that is nearly identical to Java Script Kiddie 1. The <code>assemble_png</code> function takes in a key of 
length 32, and manipulates the bytes to decode the <code>src</code> attribute of an image.</p>
<pre style="background-color:#ffffff;">
<code><span style="font-weight:bold;color:#a71d5d;">function </span><span style="font-weight:bold;color:#795da3;">assemble_png</span><span style="color:#323232;">(u_in){
    </span><span style="font-weight:bold;color:#a71d5d;">var </span><span style="color:#0086b3;">LEN </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#0086b3;">16</span><span style="color:#323232;">;
    </span><span style="font-weight:bold;color:#a71d5d;">var </span><span style="color:#323232;">key </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#183691;">&quot;00000000000000000000000000000000&quot;</span><span style="color:#323232;">;
    </span><span style="font-weight:bold;color:#a71d5d;">var </span><span style="color:#323232;">shifter;
    </span><span style="font-weight:bold;color:#a71d5d;">if</span><span style="color:#323232;">(u_in.length </span><span style="font-weight:bold;color:#a71d5d;">== </span><span style="color:#323232;">key.length){
        key </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#323232;">u_in;
    }
    </span><span style="font-weight:bold;color:#a71d5d;">var </span><span style="color:#323232;">result </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#323232;">[];
    </span><span style="font-weight:bold;color:#a71d5d;">for</span><span style="color:#323232;">(</span><span style="font-weight:bold;color:#a71d5d;">var </span><span style="color:#323232;">i </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#0086b3;">0</span><span style="color:#323232;">; i </span><span style="font-weight:bold;color:#a71d5d;">&lt; </span><span style="color:#0086b3;">LEN</span><span style="color:#323232;">; i</span><span style="font-weight:bold;color:#a71d5d;">++</span><span style="color:#323232;">){
        shifter </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#0086b3;">Number</span><span style="color:#323232;">(key.slice((i</span><span style="font-weight:bold;color:#a71d5d;">*</span><span style="color:#0086b3;">2</span><span style="color:#323232;">),(i</span><span style="font-weight:bold;color:#a71d5d;">*</span><span style="color:#0086b3;">2</span><span style="color:#323232;">)</span><span style="font-weight:bold;color:#a71d5d;">+</span><span style="color:#0086b3;">1</span><span style="color:#323232;">));
        </span><span style="font-weight:bold;color:#a71d5d;">for</span><span style="color:#323232;">(</span><span style="font-weight:bold;color:#a71d5d;">var </span><span style="color:#323232;">j </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#0086b3;">0</span><span style="color:#323232;">; j </span><span style="font-weight:bold;color:#a71d5d;">&lt; </span><span style="color:#323232;">(bytes.length </span><span style="font-weight:bold;color:#a71d5d;">/ </span><span style="color:#0086b3;">LEN</span><span style="color:#323232;">); j </span><span style="font-weight:bold;color:#a71d5d;">++</span><span style="color:#323232;">){
            result[(j </span><span style="font-weight:bold;color:#a71d5d;">* </span><span style="color:#0086b3;">LEN</span><span style="color:#323232;">) </span><span style="font-weight:bold;color:#a71d5d;">+ </span><span style="color:#323232;">i] </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#323232;">bytes[(((j </span><span style="font-weight:bold;color:#a71d5d;">+ </span><span style="color:#323232;">shifter) </span><span style="font-weight:bold;color:#a71d5d;">* </span><span style="color:#0086b3;">LEN</span><span style="color:#323232;">) </span><span style="font-weight:bold;color:#a71d5d;">% </span><span style="color:#323232;">bytes.length) </span><span style="font-weight:bold;color:#a71d5d;">+ </span><span style="color:#323232;">i]
        }
    }
    </span><span style="font-weight:bold;color:#a71d5d;">while</span><span style="color:#323232;">(result[result.length</span><span style="font-weight:bold;color:#a71d5d;">-</span><span style="color:#0086b3;">1</span><span style="color:#323232;">] </span><span style="font-weight:bold;color:#a71d5d;">== </span><span style="color:#0086b3;">0</span><span style="color:#323232;">){
        result </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#323232;">result.slice(</span><span style="color:#0086b3;">0</span><span style="color:#323232;">,result.length</span><span style="font-weight:bold;color:#a71d5d;">-</span><span style="color:#0086b3;">1</span><span style="color:#323232;">);
    }
    </span><span style="color:#0086b3;">document</span><span style="color:#323232;">.getElementById(</span><span style="color:#183691;">&quot;Area&quot;</span><span style="color:#323232;">).src </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#183691;">&quot;data:image/png;base64,&quot; </span><span style="font-weight:bold;color:#a71d5d;">+ </span><span style="color:#323232;">btoa(</span><span style="color:#0086b3;">String</span><span style="color:#323232;">.</span><span style="color:#0086b3;">fromCharCode</span><span style="color:#323232;">.apply(</span><span style="color:#0086b3;">null</span><span style="color:#323232;">, </span><span style="font-weight:bold;color:#a71d5d;">new </span><span style="color:#0086b3;">Uint8Array</span><span style="color:#323232;">(result)));
    </span><span style="font-weight:bold;color:#a71d5d;">return </span><span style="color:#0086b3;">false</span><span style="color:#323232;">;
}
</span></code></pre>
</div>

        <a class="blog-preview-continue-reading" href="/posts/picoctf-2019-java-script-kiddie-2/">Continue Reading</a>
    </div>
    
</div>

</div>


    </div>
</section>

<script src="/bundle.js"></script>
 

</body>

</html>
