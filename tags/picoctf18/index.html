<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta content="width=device-width,initial-scale=1" name="viewport"><title>picoctf18 - Tags - srikavin.me</title><link href="/favicon.png" rel="icon"><link href="/bundle.css" rel="stylesheet"></head><body><nav><div class="nav-left"><span><a href="https://srikavin.me" class="name">Srikavin Ramkumar</a> </span><span><a href="/posts" class="nav-link">Posts</a> </span><span><a href="/tags" class="nav-link">Tags</a></span></div></nav><section class="section"><div class="container"><div class="page-container tags-content"><h1>Posts tagged with <span class="minimal tag">picoctf18</span></h1><div class="blog-preview-list"><div class="blog-preview"><div class="blog-header"><h1 class="title"><a href="/posts/picoctf-2018-lambdash/">picoCTF 2018 - Lambdash</a></h1><div class="subtitle"><span>Posted on <span class="date" title="Created: 2018-10-18T14:08:16.365Z&#10;Updated: 2019-02-09T07:15:03.393Z">October 18, 2018* </span>in ctf-writeups</span></div><div class="tags"><a href="&#x2F;tags&#x2F;picoctf18&#x2F;"><span class="minimal tag interactive">picoctf18</span></a> <a href="&#x2F;tags&#x2F;web&#x2F;"><span class="minimal tag interactive">web</span></a></div></div><div class="blog-content"><h1 id="problem">Problem</h1><blockquote><p>C? Who uses that anymore. If we really want to be secure, we should all start learning lambda calculus. http://2018shell2.picoctf.com:41367</p></blockquote><h1 id="solution">Solution</h1><p>An extremely large payload to the interpreter results in an <code>node.js</code> error message</p><pre style="background-color:#ffffff;">
<code><span style="color:#323232;">PayloadTooLargeError: request entity too large
    at readStream (/problems/lambdash-3_0_867a993b23b277b2e144cc3e2d73f6e4/node_modules/raw-body/index.js:155:17)
    at getRawBody (/problems/lambdash-3_0_867a993b23b277b2e144cc3e2d73f6e4/node_modules/raw-body/index.js:108:12)
    at read (/problems/lambdash-3_0_867a993b23b277b2e144cc3e2d73f6e4/node_modules/body-parser/lib/read.js:77:3)
    at urlencodedParser (/problems/lambdash-3_0_867a993b23b277b2e144cc3e2d73f6e4/node_modules/body-parser/lib/types/urlencoded.js:116:5)
    at Layer.handle [as handle_request] (/problems/lambdash-3_0_867a993b23b277b2e144cc3e2d73f6e4/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/problems/lambdash-3_0_867a993b23b277b2e144cc3e2d73f6e4/node_modules/express/lib/router/index.js:317:13)
    at /problems/lambdash-3_0_867a993b23b277b2e144cc3e2d73f6e4/node_modules/express/lib/router/index.js:284:7
    at Function.process_params (/problems/lambdash-3_0_867a993b23b277b2e144cc3e2d73f6e4/node_modules/express/lib/router/index.js:335:12)
    at next (/problems/lambdash-3_0_867a993b23b277b2e144cc3e2d73f6e4/node_modules/express/lib/router/index.js:275:10)
    at expressInit (/problems/lambdash-3_0_867a993b23b277b2e144cc3e2d73f6e4/node_modules/express/lib/middleware/init.js:40:5)
</span></code></pre></div><a href="/posts/picoctf-2018-lambdash/" class="blog-preview-continue-reading">Continue Reading</a></div><div class="blog-preview"><div class="blog-header"><h1 class="title"><a href="/posts/picoctf-2018-circuit123/">picoCTF 2018 - circuit123</a></h1><div class="subtitle"><span>Posted on <span class="date" title="Created: 2018-10-17T02:23:29.709Z&#10;Updated: 2018-10-17T02:29:08.242Z">October 17, 2018* </span>in ctf-writeups</span></div><div class="tags"><a href="&#x2F;tags&#x2F;picoctf18&#x2F;"><span class="minimal tag interactive">picoctf18</span></a> <a href="&#x2F;tags&#x2F;python&#x2F;"><span class="minimal tag interactive">python</span></a> <a href="&#x2F;tags&#x2F;z3&#x2F;"><span class="minimal tag interactive">z3</span></a> <a href="&#x2F;tags&#x2F;reversing&#x2F;"><span class="minimal tag interactive">reversing</span></a></div></div><div class="blog-content"><h1 id="problem">Problem</h1><blockquote><p>Can you crack the key to <a href="https://2018shell2.picoctf.com/static/27ebc8a7ba2202cfcba1471080e05e2c/decrypt.py">decrypt</a> <a href="https://2018shell2.picoctf.com/static/27ebc8a7ba2202cfcba1471080e05e2c/map2.txt">map2</a> for us? The key to <a href="https://2018shell2.picoctf.com/static/27ebc8a7ba2202cfcba1471080e05e2c/map1.txt">map1</a> is 11443513758266689915.</p></blockquote><h2 id="hint">Hint</h2><blockquote><p>z3</p></blockquote><h1 id="solution">Solution</h1><p>Given the problem and the hint, it is clear that we can use z3 to solve this problem. We can create a z3 <code>BitVec</code> and pass it into the verify function to avoid writing a custom decrypter. Because we don't know the length of the bit vector, I used a conservative estimate of <code>128</code>.</p></div><a href="/posts/picoctf-2018-circuit123/" class="blog-preview-continue-reading">Continue Reading</a></div><div class="blog-preview"><div class="blog-header"><h1 class="title"><a href="/posts/picoctf-2018-be-quick-or-be-dead-3/">picoCTF 2018 - be-quick-or-be-dead-3</a></h1><div class="subtitle"><span>Posted on <span class="date" title="Created: 2018-10-16T13:53:29.636Z&#10;Updated: 2018-10-19T00:42:37.752Z">October 16, 2018* </span>in ctf-writeups</span></div><div class="tags"><a href="&#x2F;tags&#x2F;picoctf18&#x2F;"><span class="minimal tag interactive">picoctf18</span></a> <a href="&#x2F;tags&#x2F;binary-exploitation&#x2F;"><span class="minimal tag interactive">binary-exploitation</span></a> <a href="&#x2F;tags&#x2F;reversing&#x2F;"><span class="minimal tag interactive">reversing</span></a></div></div><div class="blog-content"><h1 id="problem">Problem</h1><blockquote><p>As the <a href="https://www.youtube.com/watch?v=CTt1vk9nM9c">song</a> draws closer to the end, another executable <a href="https://2018shell2.picoctf.com/static/1da7d7f7d74df19b7bdb54a3294dd930/be-quick-or-be-dead-3">be-quick-or-be-dead-3</a> suddenly pops up. This one requires even faster machines. Can you run it fast enough too?</p></blockquote><h1 id="solution">Solution</h1><p>After decompiling the program with <a href="https://derevenets.com/">Snowman</a>, we can see pseudocode for the <code>calc</code> function:</p><pre style="background-color:#ffffff;">
<code><span style="color:#0086b3;">uint32_t </span><span style="font-weight:bold;color:#795da3;">calc</span><span style="color:#323232;">(</span><span style="color:#0086b3;">uint32_t </span><span style="color:#323232;">edi) {
    </span><span style="color:#0086b3;">uint32_t</span><span style="color:#323232;"> eax2;
    </span><span style="color:#0086b3;">uint32_t</span><span style="color:#323232;"> eax3;
    </span><span style="color:#0086b3;">uint32_t</span><span style="color:#323232;"> eax4;
    </span><span style="color:#0086b3;">uint32_t</span><span style="color:#323232;"> eax5;
    </span><span style="color:#0086b3;">uint32_t</span><span style="color:#323232;"> eax6;
    </span><span style="color:#0086b3;">uint32_t</span><span style="color:#323232;"> v7;

    </span><span style="font-weight:bold;color:#a71d5d;">if </span><span style="color:#323232;">(edi </span><span style="font-weight:bold;color:#a71d5d;">&gt; </span><span style="color:#0086b3;">4</span><span style="color:#323232;">) {
        eax2 </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#323232;">calc(edi </span><span style="font-weight:bold;color:#a71d5d;">- </span><span style="color:#0086b3;">1</span><span style="color:#323232;">);
        eax3 </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#323232;">calc(edi </span><span style="font-weight:bold;color:#a71d5d;">- </span><span style="color:#0086b3;">2</span><span style="color:#323232;">);
        eax4 </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#323232;">calc(edi </span><span style="font-weight:bold;color:#a71d5d;">- </span><span style="color:#0086b3;">3</span><span style="color:#323232;">);
        eax5 </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#323232;">calc(edi </span><span style="font-weight:bold;color:#a71d5d;">- </span><span style="color:#0086b3;">4</span><span style="color:#323232;">);
        eax6 </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#323232;">calc(edi </span><span style="font-weight:bold;color:#a71d5d;">- </span><span style="color:#0086b3;">5</span><span style="color:#323232;">);
        v7 </span><span style="font-weight:bold;color:#a71d5d;">=</span><span style="color:#323232;"> eax6 </span><span style="font-weight:bold;color:#a71d5d;">* </span><span style="color:#0086b3;">0x1234 </span><span style="font-weight:bold;color:#a71d5d;">+ </span><span style="color:#323232;">(eax2 </span><span style="font-weight:bold;color:#a71d5d;">-</span><span style="color:#323232;"> eax3 </span><span style="font-weight:bold;color:#a71d5d;">+ </span><span style="color:#323232;">(eax4 </span><span style="font-weight:bold;color:#a71d5d;">-</span><span style="color:#323232;"> eax5));
    } </span><span style="font-weight:bold;color:#a71d5d;">else </span><span style="color:#323232;">{
        v7 </span><span style="font-weight:bold;color:#a71d5d;">=</span><span style="color:#323232;"> edi </span><span style="font-weight:bold;color:#a71d5d;">*</span><span style="color:#323232;"> edi </span><span style="font-weight:bold;color:#a71d5d;">+ </span><span style="color:#0086b3;">0x2345</span><span style="color:#323232;">;
    }
    </span><span style="font-weight:bold;color:#a71d5d;">return</span><span style="color:#323232;"> v7;
}
</span></code></pre></div><a href="/posts/picoctf-2018-be-quick-or-be-dead-3/" class="blog-preview-continue-reading">Continue Reading</a></div><div class="blog-preview"><div class="blog-header"><h1 class="title"><a href="/posts/picoctf-2018-dog-or-frog/">picoCTF 2018 - Dog or Frog</a></h1><div class="subtitle"><span>Posted on <span class="date" title="Created: 2018-10-14T03:51:44.809Z&#10;Updated: 2018-10-14T06:43:05.105Z">October 14, 2018* </span>in ctf-writeups</span></div><div class="tags"><a href="&#x2F;tags&#x2F;picoctf18&#x2F;"><span class="minimal tag interactive">picoctf18</span></a> <a href="&#x2F;tags&#x2F;machine-learning&#x2F;"><span class="minimal tag interactive">machine-learning</span></a> <a href="&#x2F;tags&#x2F;adversarial-learning&#x2F;"><span class="minimal tag interactive">adversarial-learning</span></a></div></div><div class="blog-content"><h1 id="problem">Problem</h1><blockquote><p>Dressing up dogs are kinda the new thing, see if you can get this lovely girl ready for her costume party. <a href="http://2018shell2.picoctf.com:5467/">Dog Or Frog</a></p></blockquote><h1 id="solution">Solution</h1><p>When we visit the page, we are greeted with a submission form. The instructions tell us that this is a machine learning problem and to not approach it as a web-exploitation problem. The goal is to submit an image that is similar (on a byte-by-byte basis) that is similar to the dog, but is recognized as a tree frog.</p><p><img alt="" src="/posts/picoctf-2018-dog-or-frog/5bc2bb38da39a06603ce0d43.png"></p></div><a href="/posts/picoctf-2018-dog-or-frog/" class="blog-preview-continue-reading">Continue Reading</a></div><div class="blog-preview"><div class="blog-header"><h1 class="title"><a href="/posts/picoctf-2018-electric/">picoCTF 2018 - eleCTRic</a></h1><div class="subtitle"><span>Posted on <span class="date" title="Created: 2018-10-13T02:36:19.176Z&#10;Updated: 2018-12-28T23:10:12.884Z">October 13, 2018* </span>in ctf-writeups</span></div><div class="tags"><a href="&#x2F;tags&#x2F;picoctf18&#x2F;"><span class="minimal tag interactive">picoctf18</span></a> <a href="&#x2F;tags&#x2F;cryptography&#x2F;"><span class="minimal tag interactive">cryptography</span></a> <a href="&#x2F;tags&#x2F;aes-ctr&#x2F;"><span class="minimal tag interactive">aes-ctr</span></a> <a href="&#x2F;tags&#x2F;aes&#x2F;"><span class="minimal tag interactive">aes</span></a></div></div><div class="blog-content"><h1 id="problem">Problem</h1><blockquote><p>&quot;You came across a custom server that Dr Xernon's company eleCTRic Ltd uses. It seems to be storing some encrypted files. Connect with <code>nc 2018shell2.picoctf.com 15037</code>. Can you get us the flag?&quot; <a href="https://2018shell2.picoctf.com/static/61d78e61c2bd099775499bba7edc1d62/eleCTRic.py">Source</a></p></blockquote><h1 id="solution">Solution</h1><p>The title makes a clear reference to <a href="https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#Counter_(CTR)">AES-CTR</a>. We can see that this mode of AES requires a unique nonce for each encrypted value to remain cryptographically secure. If we look at the problem's source code, we can see that the counter remains constant for all values. This breaks the encryption used and we are able to reveal the keystream and encrypt arbritary data.</p><pre style="background-color:#ffffff;">
<code><span style="font-weight:bold;color:#a71d5d;">class </span><span style="color:#0086b3;">AESCipher</span><span style="color:#323232;">(</span><span style="color:#0086b3;">object</span><span style="color:#323232;">):
    </span><span style="font-weight:bold;color:#a71d5d;">def </span><span style="font-weight:bold;color:#62a35c;">__init__</span><span style="color:#323232;">(self):
        self.bs </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#0086b3;">32
        </span><span style="color:#323232;">random </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#323232;">Random.new()
        self.key </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#323232;">random.read(</span><span style="color:#0086b3;">AES</span><span style="color:#323232;">.block_size)
        self.ctr </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#323232;">random.read(</span><span style="color:#0086b3;">AES</span><span style="color:#323232;">.block_size)

    </span><span style="font-weight:bold;color:#a71d5d;">def </span><span style="font-weight:bold;color:#323232;">encrypt</span><span style="color:#323232;">(self, raw):
        cipher </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#323232;">AES.new(self.key, </span><span style="color:#0086b3;">AES</span><span style="color:#323232;">.</span><span style="color:#0086b3;">MODE_CTR</span><span style="color:#323232;">, counter</span><span style="font-weight:bold;color:#a71d5d;">=lambda</span><span style="color:#323232;">: self.ctr)
        </span><span style="font-weight:bold;color:#a71d5d;">return </span><span style="color:#323232;">cipher.encrypt(raw).encode(</span><span style="color:#183691;">&#39;base64&#39;</span><span style="color:#323232;">).replace(</span><span style="color:#183691;">&#39;</span><span style="color:#0086b3;">\n</span><span style="color:#183691;">&#39;</span><span style="color:#323232;">, </span><span style="color:#183691;">&#39;&#39;</span><span style="color:#323232;">)
</span></code></pre></div><a href="/posts/picoctf-2018-electric/" class="blog-preview-continue-reading">Continue Reading</a></div><div class="blog-preview"><div class="blog-header"><h1 class="title"><a href="/posts/picoctf-2018-flaskcards-and-freedom/">picoCTF 2018 - Flaskcards and Freedom</a></h1><div class="subtitle"><span>Posted on <span class="date" title="Created: 2018-10-12T21:02:44.42Z&#10;Updated: 2018-10-12T22:55:27.216Z">October 12, 2018* </span>in ctf-writeups</span></div><div class="tags"><a href="&#x2F;tags&#x2F;picoctf18&#x2F;"><span class="minimal tag interactive">picoctf18</span></a> <a href="&#x2F;tags&#x2F;web&#x2F;"><span class="minimal tag interactive">web</span></a> <a href="&#x2F;tags&#x2F;python&#x2F;"><span class="minimal tag interactive">python</span></a> <a href="&#x2F;tags&#x2F;rce&#x2F;"><span class="minimal tag interactive">rce</span></a></div></div><div class="blog-content"><h1 id="problem">Problem</h1><blockquote><p>&quot;There seem to be a few more files stored on the flash card server but we can't login. Can you?&quot;</p></blockquote><h1 id="solution">Solution</h1><p>The site appears to be the same as the previous flaskcard challenges <code>Flaskcards Skeleton Key</code> and <code>Flaskcards.</code></p><p>When we create an account, we are presented with the following screen: <img alt="" src="/posts/picoctf-2018-flaskcards-and-freedom/5bc10c83f1882e545d7f430a.png"></p><p>We can try server side injection. If we type in <code>{{1+1}}</code>, the webpage displays <code>2</code>. Any values in double brackets is being executed on the server. After trying to find hidden variables, such as <code>config</code>, <code>flag</code>, etc; I decided to look for a remote code execution vulnerability.</p></div><a href="/posts/picoctf-2018-flaskcards-and-freedom/" class="blog-preview-continue-reading">Continue Reading</a></div></div></div></div></section><script src="/bundle.js"></script></body></html>