<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta content="width=device-width,initial-scale=1" name="viewport"><title>reversing - Tags - srikavin.me</title><link href="/favicon.png" rel="icon"><link href="/bundle.css" rel="stylesheet"><script src="https://www.googletagmanager.com/gtag/js?id=G-X8ZVFPQ0CK" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-X8ZVFPQ0CK');</script></head><body><nav><div class="nav-left"><span><a href="https://srikavin.me" class="name">Srikavin Ramkumar</a> </span><span><a href="/posts" class="nav-link">Posts</a> </span><span><a href="/tags" class="nav-link">Tags</a></span></div><div class="nav-right"><a href="https://github.com/srikavin"><img alt="Github" height="24px" src="/gh-logo.png" width="24px"></a></div></nav><section class="section"><div class="container"><div class="page-container tags-content"><h1>Posts tagged with <span class="minimal tag">reversing</span></h1><div class="blog-preview-list"><div class="blog-preview"><div class="blog-header"><h1 class="title"><a href="https://blog.srikavin.me/posts/redpwnctf20-aall/">redpwnCTF - aall</a></h1><div class="subtitle"><span>Posted on <span class="date" title="Created: 2020-06-25">June 25, 2020 </span>in ctf-writeups</span></div><div class="tags"><a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;redpwnctf20&#x2F;"><span class="minimal tag interactive">redpwnctf20</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;reversing&#x2F;"><span class="minimal tag interactive">reversing</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;python&#x2F;"><span class="minimal tag interactive">python</span></a></div></div><div class="blog-content"><h1 id="challenge">Challenge</h1><blockquote><p>how many layers of vm are you on</p><p>like,, maybe 5, or 6 right now my dude</p><p>you are like a baby... watch this</p><p>nc 2020.redpwnc.tf 31755</p></blockquote><p>We're also given a <a href="https://gist.github.com/srikavin/f6fc3f9cf62155b95868bac16a40ba5a#file-aall-py">python file</a> and a <a href="https://gist.github.com/srikavin/f6fc3f9cf62155b95868bac16a40ba5a#file-dockerfile">Dockerfile</a>.</p><h1 id="decoding">Decoding</h1><p>Looking at the python file shows that it writes out a file named <code>breakout.aallo</code> and calls <code>exec</code> on a string after base64-decoding and lzma-uncompressing it. We can modify the file to save the executed file to disk instead. It's a <a href="https://gist.github.com/srikavin/0cba74ad88e43442154dd341979c9b6d">python script</a>, but all of the variables are random unicode characters. Although the python interpreter is happy to run the code, it's nearly impossible to understand.</p></div><a href="https://blog.srikavin.me/posts/redpwnctf20-aall/" class="blog-preview-continue-reading">Continue Reading</a></div><div class="blog-preview"><div class="blog-header"><h1 class="title"><a href="https://blog.srikavin.me/posts/picoctf-2019-java-script-kiddie-2/">picoCTF 2019 - Java Script Kiddie 2</a></h1><div class="subtitle"><span>Posted on <span class="date" title="Created: 2019-10-12T22:48:41.356Z&#10;Updated: 2019-11-14T04:43:58.202Z">October 12, 2019* </span>in ctf-writeups</span></div><div class="tags"><a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;picoctf19&#x2F;"><span class="minimal tag interactive">picoctf19</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;web&#x2F;"><span class="minimal tag interactive">web</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;reversing&#x2F;"><span class="minimal tag interactive">reversing</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;javascript&#x2F;"><span class="minimal tag interactive">javascript</span></a></div></div><div class="blog-content"><p>We are given a website, that is nearly identical to Java Script Kiddie 1. The <code>assemble_png</code> function takes in a key of length 32, and manipulates the bytes to decode the <code>src</code> attribute of an image.</p><pre style="background-color:#ffffff;">
<code><span style="font-weight:bold;color:#a71d5d;">function </span><span style="font-weight:bold;color:#795da3;">assemble_png</span><span style="color:#323232;">(u_in){
    </span><span style="font-weight:bold;color:#a71d5d;">var </span><span style="color:#0086b3;">LEN </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#0086b3;">16</span><span style="color:#323232;">;
    </span><span style="font-weight:bold;color:#a71d5d;">var </span><span style="color:#323232;">key </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#183691;">&quot;00000000000000000000000000000000&quot;</span><span style="color:#323232;">;
    </span><span style="font-weight:bold;color:#a71d5d;">var </span><span style="color:#323232;">shifter;
    </span><span style="font-weight:bold;color:#a71d5d;">if</span><span style="color:#323232;">(u_in.length </span><span style="font-weight:bold;color:#a71d5d;">== </span><span style="color:#323232;">key.length){
        key </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#323232;">u_in;
    }
    </span><span style="font-weight:bold;color:#a71d5d;">var </span><span style="color:#323232;">result </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#323232;">[];
    </span><span style="font-weight:bold;color:#a71d5d;">for</span><span style="color:#323232;">(</span><span style="font-weight:bold;color:#a71d5d;">var </span><span style="color:#323232;">i </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#0086b3;">0</span><span style="color:#323232;">; i </span><span style="font-weight:bold;color:#a71d5d;">&lt; </span><span style="color:#0086b3;">LEN</span><span style="color:#323232;">; i</span><span style="font-weight:bold;color:#a71d5d;">++</span><span style="color:#323232;">){
        shifter </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#0086b3;">Number</span><span style="color:#323232;">(key.slice((i</span><span style="font-weight:bold;color:#a71d5d;">*</span><span style="color:#0086b3;">2</span><span style="color:#323232;">),(i</span><span style="font-weight:bold;color:#a71d5d;">*</span><span style="color:#0086b3;">2</span><span style="color:#323232;">)</span><span style="font-weight:bold;color:#a71d5d;">+</span><span style="color:#0086b3;">1</span><span style="color:#323232;">));
        </span><span style="font-weight:bold;color:#a71d5d;">for</span><span style="color:#323232;">(</span><span style="font-weight:bold;color:#a71d5d;">var </span><span style="color:#323232;">j </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#0086b3;">0</span><span style="color:#323232;">; j </span><span style="font-weight:bold;color:#a71d5d;">&lt; </span><span style="color:#323232;">(bytes.length </span><span style="font-weight:bold;color:#a71d5d;">/ </span><span style="color:#0086b3;">LEN</span><span style="color:#323232;">); j </span><span style="font-weight:bold;color:#a71d5d;">++</span><span style="color:#323232;">){
            result[(j </span><span style="font-weight:bold;color:#a71d5d;">* </span><span style="color:#0086b3;">LEN</span><span style="color:#323232;">) </span><span style="font-weight:bold;color:#a71d5d;">+ </span><span style="color:#323232;">i] </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#323232;">bytes[(((j </span><span style="font-weight:bold;color:#a71d5d;">+ </span><span style="color:#323232;">shifter) </span><span style="font-weight:bold;color:#a71d5d;">* </span><span style="color:#0086b3;">LEN</span><span style="color:#323232;">) </span><span style="font-weight:bold;color:#a71d5d;">% </span><span style="color:#323232;">bytes.length) </span><span style="font-weight:bold;color:#a71d5d;">+ </span><span style="color:#323232;">i]
        }
    }
    </span><span style="font-weight:bold;color:#a71d5d;">while</span><span style="color:#323232;">(result[result.length</span><span style="font-weight:bold;color:#a71d5d;">-</span><span style="color:#0086b3;">1</span><span style="color:#323232;">] </span><span style="font-weight:bold;color:#a71d5d;">== </span><span style="color:#0086b3;">0</span><span style="color:#323232;">){
        result </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#323232;">result.slice(</span><span style="color:#0086b3;">0</span><span style="color:#323232;">,result.length</span><span style="font-weight:bold;color:#a71d5d;">-</span><span style="color:#0086b3;">1</span><span style="color:#323232;">);
    }
    </span><span style="color:#0086b3;">document</span><span style="color:#323232;">.getElementById(</span><span style="color:#183691;">&quot;Area&quot;</span><span style="color:#323232;">).src </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#183691;">&quot;data:image/png;base64,&quot; </span><span style="font-weight:bold;color:#a71d5d;">+ </span><span style="color:#323232;">btoa(</span><span style="color:#0086b3;">String</span><span style="color:#323232;">.</span><span style="color:#0086b3;">fromCharCode</span><span style="color:#323232;">.apply(</span><span style="color:#0086b3;">null</span><span style="color:#323232;">, </span><span style="font-weight:bold;color:#a71d5d;">new </span><span style="color:#0086b3;">Uint8Array</span><span style="color:#323232;">(result)));
    </span><span style="font-weight:bold;color:#a71d5d;">return </span><span style="color:#0086b3;">false</span><span style="color:#323232;">;
}
</span></code></pre></div><a href="https://blog.srikavin.me/posts/picoctf-2019-java-script-kiddie-2/" class="blog-preview-continue-reading">Continue Reading</a></div><div class="blog-preview"><div class="blog-header"><h1 class="title"><a href="https://blog.srikavin.me/posts/picoctf-2018-circuit123/">picoCTF 2018 - circuit123</a></h1><div class="subtitle"><span>Posted on <span class="date" title="Created: 2018-10-17T02:23:29.709Z&#10;Updated: 2018-10-17T02:29:08.242Z">October 17, 2018* </span>in ctf-writeups</span></div><div class="tags"><a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;picoctf18&#x2F;"><span class="minimal tag interactive">picoctf18</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;python&#x2F;"><span class="minimal tag interactive">python</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;z3&#x2F;"><span class="minimal tag interactive">z3</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;reversing&#x2F;"><span class="minimal tag interactive">reversing</span></a></div></div><div class="blog-content"><h1 id="problem">Problem</h1><blockquote><p>Can you crack the key to <a href="https://2018shell2.picoctf.com/static/27ebc8a7ba2202cfcba1471080e05e2c/decrypt.py">decrypt</a> <a href="https://2018shell2.picoctf.com/static/27ebc8a7ba2202cfcba1471080e05e2c/map2.txt">map2</a> for us? The key to <a href="https://2018shell2.picoctf.com/static/27ebc8a7ba2202cfcba1471080e05e2c/map1.txt">map1</a> is 11443513758266689915.</p></blockquote><h2 id="hint">Hint</h2><blockquote><p>z3</p></blockquote><h1 id="solution">Solution</h1><p>Given the problem and the hint, it is clear that we can use z3 to solve this problem. We can create a z3 <code>BitVec</code> and pass it into the verify function to avoid writing a custom decrypter. Because we don't know the length of the bit vector, I used a conservative estimate of <code>128</code>.</p></div><a href="https://blog.srikavin.me/posts/picoctf-2018-circuit123/" class="blog-preview-continue-reading">Continue Reading</a></div><div class="blog-preview"><div class="blog-header"><h1 class="title"><a href="https://blog.srikavin.me/posts/picoctf-2018-be-quick-or-be-dead-3/">picoCTF 2018 - be-quick-or-be-dead-3</a></h1><div class="subtitle"><span>Posted on <span class="date" title="Created: 2018-10-16T13:53:29.636Z&#10;Updated: 2018-10-19T00:42:37.752Z">October 16, 2018* </span>in ctf-writeups</span></div><div class="tags"><a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;picoctf18&#x2F;"><span class="minimal tag interactive">picoctf18</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;binary-exploitation&#x2F;"><span class="minimal tag interactive">binary-exploitation</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;reversing&#x2F;"><span class="minimal tag interactive">reversing</span></a></div></div><div class="blog-content"><h1 id="problem">Problem</h1><blockquote><p>As the <a href="https://www.youtube.com/watch?v=CTt1vk9nM9c">song</a> draws closer to the end, another executable <a href="https://2018shell2.picoctf.com/static/1da7d7f7d74df19b7bdb54a3294dd930/be-quick-or-be-dead-3">be-quick-or-be-dead-3</a> suddenly pops up. This one requires even faster machines. Can you run it fast enough too?</p></blockquote><h1 id="solution">Solution</h1><p>After decompiling the program with <a href="https://derevenets.com/">Snowman</a>, we can see pseudocode for the <code>calc</code> function:</p><pre style="background-color:#ffffff;">
<code><span style="color:#0086b3;">uint32_t </span><span style="font-weight:bold;color:#795da3;">calc</span><span style="color:#323232;">(</span><span style="color:#0086b3;">uint32_t </span><span style="color:#323232;">edi) {
    </span><span style="color:#0086b3;">uint32_t</span><span style="color:#323232;"> eax2;
    </span><span style="color:#0086b3;">uint32_t</span><span style="color:#323232;"> eax3;
    </span><span style="color:#0086b3;">uint32_t</span><span style="color:#323232;"> eax4;
    </span><span style="color:#0086b3;">uint32_t</span><span style="color:#323232;"> eax5;
    </span><span style="color:#0086b3;">uint32_t</span><span style="color:#323232;"> eax6;
    </span><span style="color:#0086b3;">uint32_t</span><span style="color:#323232;"> v7;

    </span><span style="font-weight:bold;color:#a71d5d;">if </span><span style="color:#323232;">(edi </span><span style="font-weight:bold;color:#a71d5d;">&gt; </span><span style="color:#0086b3;">4</span><span style="color:#323232;">) {
        eax2 </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#323232;">calc(edi </span><span style="font-weight:bold;color:#a71d5d;">- </span><span style="color:#0086b3;">1</span><span style="color:#323232;">);
        eax3 </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#323232;">calc(edi </span><span style="font-weight:bold;color:#a71d5d;">- </span><span style="color:#0086b3;">2</span><span style="color:#323232;">);
        eax4 </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#323232;">calc(edi </span><span style="font-weight:bold;color:#a71d5d;">- </span><span style="color:#0086b3;">3</span><span style="color:#323232;">);
        eax5 </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#323232;">calc(edi </span><span style="font-weight:bold;color:#a71d5d;">- </span><span style="color:#0086b3;">4</span><span style="color:#323232;">);
        eax6 </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#323232;">calc(edi </span><span style="font-weight:bold;color:#a71d5d;">- </span><span style="color:#0086b3;">5</span><span style="color:#323232;">);
        v7 </span><span style="font-weight:bold;color:#a71d5d;">=</span><span style="color:#323232;"> eax6 </span><span style="font-weight:bold;color:#a71d5d;">* </span><span style="color:#0086b3;">0x1234 </span><span style="font-weight:bold;color:#a71d5d;">+ </span><span style="color:#323232;">(eax2 </span><span style="font-weight:bold;color:#a71d5d;">-</span><span style="color:#323232;"> eax3 </span><span style="font-weight:bold;color:#a71d5d;">+ </span><span style="color:#323232;">(eax4 </span><span style="font-weight:bold;color:#a71d5d;">-</span><span style="color:#323232;"> eax5));
    } </span><span style="font-weight:bold;color:#a71d5d;">else </span><span style="color:#323232;">{
        v7 </span><span style="font-weight:bold;color:#a71d5d;">=</span><span style="color:#323232;"> edi </span><span style="font-weight:bold;color:#a71d5d;">*</span><span style="color:#323232;"> edi </span><span style="font-weight:bold;color:#a71d5d;">+ </span><span style="color:#0086b3;">0x2345</span><span style="color:#323232;">;
    }
    </span><span style="font-weight:bold;color:#a71d5d;">return</span><span style="color:#323232;"> v7;
}
</span></code></pre></div><a href="https://blog.srikavin.me/posts/picoctf-2018-be-quick-or-be-dead-3/" class="blog-preview-continue-reading">Continue Reading</a></div></div></div></div></section><script src="/bundle.js"></script></body></html>