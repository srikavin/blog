<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta content="width=device-width,initial-scale=1" name="viewport"><title>return-oriented-programming - Tags - srikavin.me</title><link href="/favicon.png" rel="icon"><link href="/bundle.css" rel="stylesheet"></head><body><nav><div class="nav-left"><span><a href="https://srikavin.me" class="name">Srikavin Ramkumar</a> </span><span><a href="/posts" class="nav-link">Posts</a> </span><span><a href="/tags" class="nav-link">Tags</a></span></div></nav><section class="section"><div class="container"><div class="tags-content"><h1>Posts tagged with <span class="minimal tag">return-oriented-programming</span></h1><div class="blog-preview-list"><div class="blog-preview"><div class="blog-header"><h1 class="title"><a href="/posts/pwnable-tw-silver-bullet/">pwnable.tw - silver bullet</a></h1><div class="subtitle"><span>Posted on <span class="date" title="Created: 2020-02-01T22:31:07.835Z&#10;Updated: 2020-02-04T19:12:43.206Z">February 1, 2020* </span>in ctf-writeups</span></div><div class="tags"><a href="&#x2F;tags&#x2F;pwnable-tw&#x2F;"><span class="minimal tag interactive">pwnable.tw</span></a> <a href="&#x2F;tags&#x2F;binary-exploitation&#x2F;"><span class="minimal tag interactive">binary-exploitation</span></a> <a href="&#x2F;tags&#x2F;return-oriented-programming&#x2F;"><span class="minimal tag interactive">return-oriented-programming</span></a> <a href="&#x2F;tags&#x2F;pwntools&#x2F;"><span class="minimal tag interactive">pwntools</span></a></div></div><div class="blog-content"><h1 id="challenge">Challenge</h1><blockquote><p>Please kill the werewolf with silver bullet!</p><p><code>nc chall.pwnable.tw 10103</code></p></blockquote><p>We are also provided a binary and the libc used on the server.</p><h1 id="solution">Solution</h1><p>When running the binary, we can see that we have four options:</p><p><img alt="" src="/posts/pwnable-tw-silver-bullet/5d0810548487900bf40e47d5.png"></p><p>The provided binary was not stripped, so reversing was easy with Ghidra.</p><pre style="background-color:#ffffff;">
<code><span style="font-weight:bold;color:#a71d5d;">void </span><span style="font-weight:bold;color:#795da3;">create_bullet</span><span style="color:#323232;">(bullet </span><span style="font-weight:bold;color:#a71d5d;">*</span><span style="color:#323232;">bullet)
{
  </span><span style="color:#0086b3;">size_t</span><span style="color:#323232;"> size;
  
  </span><span style="font-weight:bold;color:#a71d5d;">if </span><span style="color:#323232;">(bullet-&gt;description[</span><span style="color:#0086b3;">0</span><span style="color:#323232;">] </span><span style="font-weight:bold;color:#a71d5d;">== </span><span style="color:#183691;">&#39;</span><span style="color:#0086b3;">\0</span><span style="color:#183691;">&#39;</span><span style="color:#323232;">) {
    </span><span style="color:#62a35c;">printf</span><span style="color:#323232;">(</span><span style="color:#183691;">&quot;Give me your description of bullet :&quot;</span><span style="color:#323232;">,</span><span style="color:#0086b3;">0</span><span style="color:#323232;">);
    read_input((</span><span style="font-weight:bold;color:#a71d5d;">char *</span><span style="color:#323232;">)bullet,</span><span style="color:#0086b3;">0x30</span><span style="color:#323232;">);
    size </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#62a35c;">strlen</span><span style="color:#323232;">((</span><span style="font-weight:bold;color:#a71d5d;">char *</span><span style="color:#323232;">)bullet);
    </span><span style="color:#62a35c;">printf</span><span style="color:#323232;">(</span><span style="color:#183691;">&quot;Your power is : </span><span style="color:#0086b3;">%u\n</span><span style="color:#183691;">&quot;</span><span style="color:#323232;">,size);
    bullet-&gt;power </span><span style="font-weight:bold;color:#a71d5d;">=</span><span style="color:#323232;"> size;
    </span><span style="color:#62a35c;">puts</span><span style="color:#323232;">(</span><span style="color:#183691;">&quot;Good luck !!&quot;</span><span style="color:#323232;">);
  }
  </span><span style="font-weight:bold;color:#a71d5d;">else </span><span style="color:#323232;">{
    </span><span style="color:#62a35c;">puts</span><span style="color:#323232;">(</span><span style="color:#183691;">&quot;You have been created the Bullet !&quot;</span><span style="color:#323232;">);
  }
  </span><span style="font-weight:bold;color:#a71d5d;">return</span><span style="color:#323232;">;
}
</span></code></pre></div><a href="/posts/pwnable-tw-silver-bullet/" class="blog-preview-continue-reading">Continue Reading</a></div><div class="blog-preview"><div class="blog-header"><h1 class="title"><a href="/posts/nactf-2019-loopy-0/">nactf 2019 - Loopy #0</a></h1><div class="subtitle"><span>Posted on <span class="date" title="Created: 2019-09-22T20:39:04.285Z&#10;Updated: 2019-11-24T03:53:01.555Z">September 22, 2019* </span>in ctf-writeups</span></div><div class="tags"><a href="&#x2F;tags&#x2F;nactf2019&#x2F;"><span class="minimal tag interactive">nactf2019</span></a> <a href="&#x2F;tags&#x2F;binary-exploitation&#x2F;"><span class="minimal tag interactive">binary-exploitation</span></a> <a href="&#x2F;tags&#x2F;pwntools&#x2F;"><span class="minimal tag interactive">pwntools</span></a> <a href="&#x2F;tags&#x2F;format-string&#x2F;"><span class="minimal tag interactive">format-string</span></a> <a href="&#x2F;tags&#x2F;return-oriented-programming&#x2F;"><span class="minimal tag interactive">return-oriented-programming</span></a></div></div><div class="blog-content"><h1 id="challenge">Challenge</h1><blockquote><p>This program is quite short, but has got <code>printf</code> and <code>gets</code> in it! This shouldn't be too hard, right?</p><p>Connect at <code>nc shell.2019.nactf.com 31283</code></p></blockquote><p>We are given the libc used, the binary, and the source code.</p><pre style="background-color:#ffffff;">
<code><span style="font-weight:bold;color:#a71d5d;">#include </span><span style="color:#183691;">&lt;stdio.h&gt;

</span><span style="font-weight:bold;color:#a71d5d;">void </span><span style="font-weight:bold;color:#795da3;">vuln</span><span style="color:#323232;">()
{
	</span><span style="font-weight:bold;color:#a71d5d;">char</span><span style="color:#323232;"> buf[</span><span style="color:#0086b3;">64</span><span style="color:#323232;">];
	</span><span style="color:#62a35c;">fputs</span><span style="color:#323232;">(</span><span style="color:#183691;">&quot;Type something&gt;&quot;</span><span style="color:#323232;">, stdout);
	</span><span style="color:#62a35c;">gets</span><span style="color:#323232;">(buf);
	</span><span style="color:#62a35c;">fputs</span><span style="color:#323232;">(</span><span style="color:#183691;">&quot;You typed: &quot;</span><span style="color:#323232;">, stdout);
	</span><span style="color:#62a35c;">printf</span><span style="color:#323232;">(buf);
}

</span><span style="font-weight:bold;color:#a71d5d;">int </span><span style="font-weight:bold;color:#795da3;">main</span><span style="color:#323232;">()
{
	</span><span style="font-style:italic;color:#969896;">/* Disable buffering on stdout */
	</span><span style="color:#62a35c;">setvbuf</span><span style="color:#323232;">(stdout, </span><span style="color:#0086b3;">NULL</span><span style="color:#323232;">, _IONBF, </span><span style="color:#0086b3;">0</span><span style="color:#323232;">);

	vuln();

	</span><span style="font-weight:bold;color:#a71d5d;">return </span><span style="color:#0086b3;">0</span><span style="color:#323232;">;
}
</span></code></pre></div><a href="/posts/nactf-2019-loopy-0/" class="blog-preview-continue-reading">Continue Reading</a></div></div></div></div></section><script src="/bundle.js"></script></body></html>