<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta content="width=device-width,initial-scale=1" name="viewport"><title>Posts - srikavin.me</title><link href="/favicon.png" rel="icon"><link href="/bundle.css" rel="stylesheet"><script src="https://www.googletagmanager.com/gtag/js?id=G-X8ZVFPQ0CK" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-X8ZVFPQ0CK');</script></head><body><nav><div class="nav-left"><span><a href="https://srikavin.me" class="name">Srikavin Ramkumar</a> </span><span><a href="/posts" class="nav-link">Posts</a> </span><span><a href="/tags" class="nav-link">Tags</a></span></div><div class="nav-right"><a href="https://github.com/srikavin"><img alt="Github" src="/gh-logo.png" height="24px" width="24px"></a></div></nav><section class="section"><div class="container"><div class="page-container"><div class="blog-preview-list"><div class="blog-preview"><div class="blog-header"><h1 class="title"><a href="https://blog.srikavin.me/posts/asisctf20-abusing-php-constants-to-bypass-eval-filters/">Abusing PHP Constants, Temporary Uploads, and FastCGI to Bypass Restrictions</a></h1><div class="subtitle"><span>Posted on <span class="date" title="Created: 2020-12-13">December 13, 2020 </span>in ctf-writeups</span></div><div class="tags"><a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;asisctf-finals2020&#x2F;"><span class="interactive minimal tag">asisctf-finals2020</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;web&#x2F;"><span class="interactive minimal tag">web</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;php&#x2F;"><span class="interactive minimal tag">php</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;rce&#x2F;"><span class="interactive minimal tag">rce</span></a></div></div><div class="blog-content"><h1 id="challenge">Challenge</h1><blockquote><p>Can you obtain the more <a href="https://securesecrets.asisctf.com/Y0U_CANT_GUESS_THIS_5TUPLFGSGZYWXOKHINMBDWCKAGERCQJV.php">secure</a> secret? Even with all those filters? I don't think so :)</p></blockquote><p>We also have the <a href="https://blog.srikavin.me/posts/asisctf20-abusing-php-constants-to-bypass-eval-filters/configs.zip">configuration files</a> from the previous challenge <code>Less Secure Secrets</code>.</p><p>When we visit the given link, we see that the page prints out the source code of the current page:</p><pre style="background-color:#ffffff;">
<code><span style="color:#323232;">&lt;</span><span style="color:#63a35c;">html</span><span style="color:#323232;">&gt;&lt;</span><span style="color:#63a35c;">head</span><span style="color:#323232;">&gt;&lt;/</span><span style="color:#63a35c;">head</span><span style="color:#323232;">&gt;
&lt;</span><span style="color:#63a35c;">body</span><span style="color:#323232;">&gt;
&lt;</span><span style="color:#63a35c;">img </span><span style="color:#795da3;">width</span><span style="color:#323232;">=</span><span style="color:#183691;">&quot;300px&quot; </span><span style="color:#795da3;">src</span><span style="color:#323232;">=</span><span style="color:#183691;">&quot;/img.jpg&quot; </span><span style="color:#795da3;">style</span><span style="color:#323232;">=</span><span style="color:#183691;">&quot;</span><span style="color:#0086b3;">display</span><span style="color:#323232;">:block;</span><span style="color:#183691;">&quot;</span><span style="color:#323232;">&gt;

&lt;?php
</span><span style="font-weight:bold;color:#a71d5d;">function </span><span style="font-weight:bold;color:#795da3;">no_errors_baby</span><span style="color:#323232;">($ab){
    </span><span style="font-weight:bold;color:#a71d5d;">die</span><span style="color:#323232;">(</span><span style="color:#183691;">&quot;I don&#39;t like errors and warnings&quot;</span><span style="color:#323232;">);
}
</span><span style="font-weight:bold;color:#a71d5d;">function </span><span style="font-weight:bold;color:#795da3;">no_race</span><span style="color:#323232;">($item, $key){}
    
</span><span style="color:#62a35c;">array_walk_recursive</span><span style="color:#323232;">($_SERVER, </span><span style="color:#183691;">&#39;no_race&#39;</span><span style="color:#323232;">);
</span><span style="color:#62a35c;">array_walk_recursive</span><span style="color:#323232;">($_GET, </span><span style="color:#183691;">&#39;no_race&#39;</span><span style="color:#323232;">);
</span><span style="color:#62a35c;">array_walk_recursive</span><span style="color:#323232;">($_POST, </span><span style="color:#183691;">&#39;no_race&#39;</span><span style="color:#323232;">);
</span><span style="color:#62a35c;">array_walk_recursive</span><span style="color:#323232;">($_REQUEST, </span><span style="color:#183691;">&#39;no_race&#39;</span><span style="color:#323232;">);
</span><span style="color:#62a35c;">set_error_handler </span><span style="color:#323232;">( </span><span style="color:#183691;">&quot;no_errors_baby&quot; </span><span style="color:#323232;">, </span><span style="color:#0086b3;">E_ALL </span><span style="color:#323232;">);

</span><span style="font-weight:bold;color:#a71d5d;">if</span><span style="color:#323232;">(</span><span style="font-weight:bold;color:#a71d5d;">!</span><span style="color:#62a35c;">isset</span><span style="color:#323232;">($_GET[</span><span style="color:#183691;">&quot;yummy&quot;</span><span style="color:#323232;">])){
    </span><span style="color:#62a35c;">highlight_file</span><span style="color:#323232;">(</span><span style="color:#0086b3;">__FILE__</span><span style="color:#323232;">);
} </span><span style="font-weight:bold;color:#a71d5d;">else </span><span style="color:#323232;">{
    </span><span style="color:#62a35c;">sleep</span><span style="color:#323232;">(</span><span style="color:#0086b3;">2</span><span style="color:#323232;">); </span><span style="font-style:italic;color:#969896;">//Anti-race
    </span><span style="color:#62a35c;">echo </span><span style="color:#183691;">&quot;&lt;!--&quot;</span><span style="color:#323232;">;
    </span><span style="color:#62a35c;">phpinfo</span><span style="color:#323232;">(); 
    </span><span style="color:#62a35c;">echo </span><span style="color:#183691;">&quot;--&gt;&quot;</span><span style="color:#323232;">;
    </span><span style="font-weight:bold;color:#a71d5d;">if</span><span style="color:#323232;">(</span><span style="color:#62a35c;">preg_match</span><span style="color:#323232;">(</span><span style="color:#183691;">&#39;/</span><span style="color:#0086b3;">\$</span><span style="font-weight:bold;color:#a71d5d;">|</span><span style="color:#0086b3;">\?</span><span style="font-weight:bold;color:#a71d5d;">|</span><span style="color:#183691;">`</span><span style="font-weight:bold;color:#a71d5d;">|</span><span style="color:#0086b3;">\&#39;</span><span style="font-weight:bold;color:#a71d5d;">|</span><span style="color:#183691;">&quot;</span><span style="font-weight:bold;color:#a71d5d;">|</span><span style="color:#183691;">%</span><span style="font-weight:bold;color:#a71d5d;">|</span><span style="color:#183691;">!</span><span style="font-weight:bold;color:#a71d5d;">|</span><span style="color:#0086b3;">[0-9]</span><span style="font-weight:bold;color:#a71d5d;">|</span><span style="color:#183691;">@</span><span style="font-weight:bold;color:#a71d5d;">|</span><span style="color:#0086b3;">\(</span><span style="font-weight:bold;color:#a71d5d;">|</span><span style="color:#0086b3;">\)</span><span style="font-weight:bold;color:#a71d5d;">|</span><span style="color:#0086b3;">\^</span><span style="font-weight:bold;color:#a71d5d;">|</span><span style="color:#183691;">&amp;</span><span style="font-weight:bold;color:#a71d5d;">|</span><span style="color:#0086b3;">\*</span><span style="font-weight:bold;color:#a71d5d;">|</span><span style="color:#183691;">-</span><span style="font-weight:bold;color:#a71d5d;">|</span><span style="color:#0086b3;">\+</span><span style="font-weight:bold;color:#a71d5d;">|</span><span style="color:#183691;">=</span><span style="font-weight:bold;color:#a71d5d;">|</span><span style="color:#183691;">&lt;</span><span style="font-weight:bold;color:#a71d5d;">|</span><span style="color:#183691;">&gt;</span><span style="font-weight:bold;color:#a71d5d;">|</span><span style="color:#0086b3;">\\|</span><span style="color:#183691;">{</span><span style="font-weight:bold;color:#a71d5d;">|</span><span style="color:#183691;">}</span><span style="font-weight:bold;color:#a71d5d;">|</span><span style="color:#0086b3;">\/</span><span style="font-weight:bold;color:#a71d5d;">|</span><span style="color:#0086b3;">\|</span><span style="font-weight:bold;color:#a71d5d;">|</span><span style="color:#183691;">true</span><span style="font-weight:bold;color:#a71d5d;">|</span><span style="color:#183691;">false</span><span style="font-weight:bold;color:#a71d5d;">|</span><span style="color:#183691;">null</span><span style="font-weight:bold;color:#a71d5d;">|</span><span style="color:#183691;">secret/i&#39;</span><span style="color:#323232;">, $_GET[</span><span style="color:#183691;">&quot;yummy&quot;</span><span style="color:#323232;">]) 
        </span><span style="font-weight:bold;color:#a71d5d;">|| </span><span style="color:#62a35c;">strlen</span><span style="color:#323232;">($_GET[</span><span style="color:#183691;">&quot;yummy&quot;</span><span style="color:#323232;">]) </span><span style="font-weight:bold;color:#a71d5d;">&gt; </span><span style="color:#0086b3;">5000</span><span style="color:#323232;">)
        </span><span style="font-weight:bold;color:#a71d5d;">die</span><span style="color:#323232;">(</span><span style="color:#183691;">&quot;Don&#39;t try harder&quot;</span><span style="color:#323232;">);
    </span><span style="color:#62a35c;">eval</span><span style="color:#323232;">($_GET[</span><span style="color:#183691;">&quot;yummy&quot;</span><span style="color:#323232;">]);
}
?&gt;
&lt;/</span><span style="color:#63a35c;">body</span><span style="color:#323232;">&gt;
&lt;/</span><span style="color:#63a35c;">html</span><span style="color:#323232;">&gt;
</span></code></pre></div><a href="https://blog.srikavin.me/posts/asisctf20-abusing-php-constants-to-bypass-eval-filters/" class="blog-preview-continue-reading">Continue Reading</a></div><div class="blog-preview"><div class="blog-header"><h1 class="title"><a href="https://blog.srikavin.me/posts/pwnable-tw-applestore/">pwnable.tw - applestore</a></h1><div class="subtitle"><span>Posted on <span class="date" title="Created: 2020-08-27&#10;Updated: 2020-11-06">August 27, 2020* </span>in ctf-writeups</span></div><div class="tags"><a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;pwnable-tw&#x2F;"><span class="interactive minimal tag">pwnable.tw</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;binary-exploitation&#x2F;"><span class="interactive minimal tag">binary-exploitation</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;pwntools&#x2F;"><span class="interactive minimal tag">pwntools</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;rce&#x2F;"><span class="interactive minimal tag">rce</span></a></div></div><div class="blog-content"><h1 id="challenge">Challenge</h1><blockquote><p>tomcr00se rooted the galaxy S5, but we need you to jailbreak the iPhone8!</p><p>nc chall.pwnable.tw 10104</p></blockquote><p>We're also given a <a href="https://pwnable.tw/static/chall/applestore">binary</a> and <a href="https://pwnable.tw/static/libc/libc_32.so.6">libc</a> shared executable.</p><h1 id="reversing">Reversing</h1><p>When reversing binaries, I usually run the binary and compare its execution alongside the disassemby+pseudocode. When we run the given binary, we're greeted by a menu with 6 options:</p></div><a href="https://blog.srikavin.me/posts/pwnable-tw-applestore/" class="blog-preview-continue-reading">Continue Reading</a></div><div class="blog-preview"><div class="blog-header"><h1 class="title"><a href="https://blog.srikavin.me/posts/uiuctf20-solving-minecraft-captchas/">Solving Minecraft Captchas with Neural Networks</a></h1><div class="subtitle"><span>Posted on <span class="date" title="Created: 2020-07-25&#10;Updated: 2020-11-09">July 25, 2020* </span>in ctf-writeups</span></div><div class="tags"><a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;uiuctf20&#x2F;"><span class="interactive minimal tag">uiuctf20</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;machine-learning&#x2F;"><span class="interactive minimal tag">machine-learning</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;neural-networks&#x2F;"><span class="interactive minimal tag">neural-networks</span></a></div></div><div class="blog-content"><h1 id="challenge">Challenge</h1><blockquote><p>When on website: +1 spam resistance +10 user annoyance</p><p>Gotta be fast! 500 in 10 minutes!</p><p>https://captcha.chal.uiuc.tf</p></blockquote><p>We're given a link to a website, which contains a picture of a Minecraft enchanting window. When we try to type into the input field, our input is displayed in the <a href="https://minecraft.gamepedia.com/Enchanting_Table#Standard_Galactic_Alphabet">Standard Galactic Alphabet</a>. The challenge description tells us that we need to solve 500 of these captchas in 10 minutes. Even if I were fluent in this language, it would be difficult to solve 50 of these in a minute.</p><p><img alt="" src="https://blog.srikavin.me/posts/uiuctf20-solving-minecraft-captchas/page-screenshot.png"></p></div><a href="https://blog.srikavin.me/posts/uiuctf20-solving-minecraft-captchas/" class="blog-preview-continue-reading">Continue Reading</a></div><div class="blog-preview"><div class="blog-header"><h1 class="title"><a href="https://blog.srikavin.me/posts/redpwnctf20-aall/">redpwnCTF - aall</a></h1><div class="subtitle"><span>Posted on <span class="date" title="Created: 2020-06-25">June 25, 2020 </span>in ctf-writeups</span></div><div class="tags"><a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;redpwnctf20&#x2F;"><span class="interactive minimal tag">redpwnctf20</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;reversing&#x2F;"><span class="interactive minimal tag">reversing</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;python&#x2F;"><span class="interactive minimal tag">python</span></a></div></div><div class="blog-content"><h1 id="challenge">Challenge</h1><blockquote><p>how many layers of vm are you on</p><p>like,, maybe 5, or 6 right now my dude</p><p>you are like a baby... watch this</p><p>nc 2020.redpwnc.tf 31755</p></blockquote><p>We're also given a <a href="https://gist.github.com/srikavin/f6fc3f9cf62155b95868bac16a40ba5a#file-aall-py">python file</a> and a <a href="https://gist.github.com/srikavin/f6fc3f9cf62155b95868bac16a40ba5a#file-dockerfile">Dockerfile</a>.</p><h1 id="decoding">Decoding</h1><p>Looking at the python file shows that it writes out a file named <code>breakout.aallo</code> and calls <code>exec</code> on a string after base64-decoding and lzma-uncompressing it. We can modify the file to save the executed file to disk instead. It's a <a href="https://gist.github.com/srikavin/0cba74ad88e43442154dd341979c9b6d">python script</a>, but all of the variables are random unicode characters. Although the python interpreter is happy to run the code, it's nearly impossible to understand.</p></div><a href="https://blog.srikavin.me/posts/redpwnctf20-aall/" class="blog-preview-continue-reading">Continue Reading</a></div><div class="blog-preview"><div class="blog-header"><h1 class="title"><a href="https://blog.srikavin.me/posts/redpwnctf20-tux-fanpage/">redpwnCTF - tux fanpage</a></h1><div class="subtitle"><span>Posted on <span class="date" title="Created: 2020-06-25">June 25, 2020 </span>in ctf-writeups</span></div><div class="tags"><a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;redpwnctf20&#x2F;"><span class="interactive minimal tag">redpwnctf20</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;web&#x2F;"><span class="interactive minimal tag">web</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;local-file-inclusion&#x2F;"><span class="interactive minimal tag">local-file-inclusion</span></a></div></div><div class="blog-content"><h1 id="challenge">Challenge</h1><blockquote><p>My friend made a fanpage for Tux; can you steal the source code for me?</p><p>Site: <a href="http://tux-fanpage.2020.redpwnc.tf">tux-fanpage.2020.redpwnc.tf</a></p></blockquote><p>We're also given the source code:</p></div><a href="https://blog.srikavin.me/posts/redpwnctf20-tux-fanpage/" class="blog-preview-continue-reading">Continue Reading</a></div><div class="blog-preview"><div class="blog-header"><h1 class="title"><a href="https://blog.srikavin.me/posts/pwnable-kr-toddler-s-bottle/">pwnable.kr - Toddler&#x27;s Bottle</a></h1><div class="subtitle"><span>Posted on <span class="date" title="Created: 2020-04-27T12:59:37.396Z&#10;Updated: 2020-04-27T13:02:48.347Z">April 27, 2020* </span>in ctf-writeups</span></div><div class="tags"><a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;pwnable-kr&#x2F;"><span class="interactive minimal tag">pwnable.kr</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;binary-exploitation&#x2F;"><span class="interactive minimal tag">binary-exploitation</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;buffer-overflow&#x2F;"><span class="interactive minimal tag">buffer-overflow</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;pwntools&#x2F;"><span class="interactive minimal tag">pwntools</span></a></div></div><div class="blog-content"><h1 id="fd-1pt">fd - 1pt</h1><h2 id="challenge">Challenge</h2><blockquote><p>Mommy! what is a file descriptor in Linux?</p><p>ssh fd@pwnable.kr -p2222 (pw:guest)</p></blockquote><h2 id="source-code">Source Code</h2><p>After ssh-ing into the server with the given details, we can view the source code of the challenge by running <code>cat fd.c</code>:</p><pre style="background-color:#ffffff;">
<code><span style="font-weight:bold;color:#a71d5d;">#include </span><span style="color:#183691;">&lt;stdio.h&gt;
</span><span style="font-weight:bold;color:#a71d5d;">#include </span><span style="color:#183691;">&lt;stdlib.h&gt;
</span><span style="font-weight:bold;color:#a71d5d;">#include </span><span style="color:#183691;">&lt;string.h&gt;
</span><span style="font-weight:bold;color:#a71d5d;">char</span><span style="color:#323232;"> buf[</span><span style="color:#0086b3;">32</span><span style="color:#323232;">];
</span><span style="font-weight:bold;color:#a71d5d;">int </span><span style="font-weight:bold;color:#795da3;">main</span><span style="color:#323232;">(</span><span style="font-weight:bold;color:#a71d5d;">int </span><span style="color:#323232;">argc, </span><span style="font-weight:bold;color:#a71d5d;">char* </span><span style="color:#323232;">argv[], </span><span style="font-weight:bold;color:#a71d5d;">char* </span><span style="color:#323232;">envp[]){
        </span><span style="font-weight:bold;color:#a71d5d;">if</span><span style="color:#323232;">(argc</span><span style="font-weight:bold;color:#a71d5d;">&lt;</span><span style="color:#0086b3;">2</span><span style="color:#323232;">){
                </span><span style="color:#62a35c;">printf</span><span style="color:#323232;">(</span><span style="color:#183691;">&quot;pass argv[1] a number</span><span style="color:#0086b3;">\n</span><span style="color:#183691;">&quot;</span><span style="color:#323232;">);
                </span><span style="font-weight:bold;color:#a71d5d;">return </span><span style="color:#0086b3;">0</span><span style="color:#323232;">;
        }
        </span><span style="font-weight:bold;color:#a71d5d;">int</span><span style="color:#323232;"> fd </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#62a35c;">atoi</span><span style="color:#323232;">( argv[</span><span style="color:#0086b3;">1</span><span style="color:#323232;">] ) </span><span style="font-weight:bold;color:#a71d5d;">- </span><span style="color:#0086b3;">0x1234</span><span style="color:#323232;">;
        </span><span style="font-weight:bold;color:#a71d5d;">int</span><span style="color:#323232;"> len </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#0086b3;">0</span><span style="color:#323232;">;
        len </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#323232;">read(fd, buf, </span><span style="color:#0086b3;">32</span><span style="color:#323232;">);
        </span><span style="font-weight:bold;color:#a71d5d;">if</span><span style="color:#323232;">(</span><span style="font-weight:bold;color:#a71d5d;">!</span><span style="color:#62a35c;">strcmp</span><span style="color:#323232;">(</span><span style="color:#183691;">&quot;LETMEWIN</span><span style="color:#0086b3;">\n</span><span style="color:#183691;">&quot;</span><span style="color:#323232;">, buf)){
                </span><span style="color:#62a35c;">printf</span><span style="color:#323232;">(</span><span style="color:#183691;">&quot;good job :)</span><span style="color:#0086b3;">\n</span><span style="color:#183691;">&quot;</span><span style="color:#323232;">);
                </span><span style="color:#62a35c;">system</span><span style="color:#323232;">(</span><span style="color:#183691;">&quot;/bin/cat flag&quot;</span><span style="color:#323232;">);
                </span><span style="color:#62a35c;">exit</span><span style="color:#323232;">(</span><span style="color:#0086b3;">0</span><span style="color:#323232;">);
        }
        </span><span style="color:#62a35c;">printf</span><span style="color:#323232;">(</span><span style="color:#183691;">&quot;learn about Linux file IO</span><span style="color:#0086b3;">\n</span><span style="color:#183691;">&quot;</span><span style="color:#323232;">);
        </span><span style="font-weight:bold;color:#a71d5d;">return </span><span style="color:#0086b3;">0</span><span style="color:#323232;">;
}
</span></code></pre></div><a href="https://blog.srikavin.me/posts/pwnable-kr-toddler-s-bottle/" class="blog-preview-continue-reading">Continue Reading</a></div><div class="blog-preview"><div class="blog-header"><h1 class="title"><a href="https://blog.srikavin.me/posts/pwnable-tw-seethefile/">pwnable.tw - seethefile</a></h1><div class="subtitle"><span>Posted on <span class="date" title="Created: 2020-03-29T01:23:36.608Z&#10;Updated: 2020-03-30T08:23:31.139Z">March 29, 2020* </span>in ctf-writeups</span></div><div class="tags"><a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;pwnable-tw&#x2F;"><span class="interactive minimal tag">pwnable.tw</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;binary-exploitation&#x2F;"><span class="interactive minimal tag">binary-exploitation</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;file-stream-oriented-programming&#x2F;"><span class="interactive minimal tag">file-stream-oriented-programming</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;pwntools&#x2F;"><span class="interactive minimal tag">pwntools</span></a></div></div><div class="blog-content"><h1 id="challenge">Challenge</h1><blockquote><p>Can you see anything?</p><p>Get a shell for me.</p><p><code>nc chall.pwnable.tw 10200</code></p><p><a href="https://pwnable.tw/static/chall/seethefile">seethefile</a></p><p><a href="https://pwnable.tw/static/libc/libc_32.so.6">libc.so</a></p></blockquote><h1 id="background">Background</h1><h2 id="io-file-plus">_IO_FILE_plus</h2><p>Files are internally represented using the <a href="https://elixir.bootlin.com/glibc/glibc-2.23/source/libio/libioP.h#L342"><code>_IO_FILE_plus</code></a> struct in glibc:</p><pre style="background-color:#ffffff;">
<code><span style="font-weight:bold;color:#a71d5d;">struct </span><span style="color:#323232;">_IO_FILE_plus
{
  _IO_FILE file;
  </span><span style="font-weight:bold;color:#a71d5d;">const struct </span><span style="color:#323232;">_IO_jump_t *vtable;
};
</span></code></pre></div><a href="https://blog.srikavin.me/posts/pwnable-tw-seethefile/" class="blog-preview-continue-reading">Continue Reading</a></div><div class="blog-preview"><div class="blog-header"><h1 class="title"><a href="https://blog.srikavin.me/posts/angstromctf-leettube/">ångstromCTF - LeetTube</a></h1><div class="subtitle"><span>Posted on <span class="date" title="Created: 2020-03-18T23:36:12.437Z&#10;Updated: 2020-03-29T02:10:25.394Z">March 18, 2020* </span>in ctf-writeups</span></div><div class="tags"><a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;angstromctf2020&#x2F;"><span class="interactive minimal tag">angstromctf2020</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;web&#x2F;"><span class="interactive minimal tag">web</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;local-file-inclusion&#x2F;"><span class="interactive minimal tag">local-file-inclusion</span></a></div></div><div class="blog-content"><h1 id="challenge">Challenge</h1><blockquote><p>I developed a new video streaming service just for hackers. Learn all about viruses, IP addresses, and more on <a href="https://leettube.2020.chall.actf.co/">LeetTube</a>! Here's the <a href="https://files.actf.co/5fb7188c18fde9206e4a43f5c817b4a9db6ee784366b65033904a2538d0d1782/leettube.py">source code</a> and the <a href="https://files.actf.co/929adf47a8fe915cc89618c9f4ec38068cc08525087171832cdd3c9c3f6db897/Dockerfile">Dockerfile</a>.</p><p>Note: the server is also running behind NGINX.</p></blockquote><p><img alt="" src="https://blog.srikavin.me/posts/angstromctf-leettube/5e72b03ad6d41508cf61f794.png"></p><p>The application is simple enough--It serves videos and has both public and unlisted videos. The Dockerfile uses <code>FROM kmh11/python3.1</code>, which is weird because <a href="https://www.python.org/download/releases/3.1/">Python 3.1</a> was released nearly 11 years ago. To ensure the name wasn't misleading, I ended up verifying the Python binary in the docker image, but I didn't find any related vulnerabilities. However, there is a noticeable vulnerability in how paths are handled.</p></div><a href="https://blog.srikavin.me/posts/angstromctf-leettube/" class="blog-preview-continue-reading">Continue Reading</a></div><div class="blog-preview"><div class="blog-header"><h1 class="title"><a href="https://blog.srikavin.me/posts/pwnable-tw-tcache-tear/">pwnable.tw - Tcache Tear</a></h1><div class="subtitle"><span>Posted on <span class="date" title="Created: 2020-02-23T07:19:49.665Z&#10;Updated: 2020-03-02T18:52:31.838Z">February 23, 2020* </span>in ctf-writeups</span></div><div class="tags"><a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;pwnable-tw&#x2F;"><span class="interactive minimal tag">pwnable.tw</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;binary-exploitation&#x2F;"><span class="interactive minimal tag">binary-exploitation</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;heap-exploitation&#x2F;"><span class="interactive minimal tag">heap-exploitation</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;pwntools&#x2F;"><span class="interactive minimal tag">pwntools</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;double-free&#x2F;"><span class="interactive minimal tag">double-free</span></a></div></div><div class="blog-content"><h1 id="challenge">Challenge</h1><blockquote><p>Make tcache great again !</p><p><code>nc chall.pwnable.tw 10207</code></p><p><a href="https://pwnable.tw/static/chall/tcache_tear">tcache_tear</a></p><p><a href="https://pwnable.tw/static/libc/libc-18292bd12d37bfaf58e8dded9db7f1f5da1192cb.so">libc.so</a></p></blockquote><h1 id="background">Background</h1><p>Per-thread cache (tcache) is an optimization enabled in versions of <code>libc</code> after 2.26. To increase heap performance, security checks are limited within the tcache implementation. Tcache is implemented using two important internal structures:</p></div><a href="https://blog.srikavin.me/posts/pwnable-tw-tcache-tear/" class="blog-preview-continue-reading">Continue Reading</a></div><div class="blog-preview"><div class="blog-header"><h1 class="title"><a href="https://blog.srikavin.me/posts/pwnable-tw-silver-bullet/">pwnable.tw - silver bullet</a></h1><div class="subtitle"><span>Posted on <span class="date" title="Created: 2020-02-01T22:31:07.835Z&#10;Updated: 2020-02-04T19:12:43.206Z">February 1, 2020* </span>in ctf-writeups</span></div><div class="tags"><a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;pwnable-tw&#x2F;"><span class="interactive minimal tag">pwnable.tw</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;binary-exploitation&#x2F;"><span class="interactive minimal tag">binary-exploitation</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;return-oriented-programming&#x2F;"><span class="interactive minimal tag">return-oriented-programming</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;pwntools&#x2F;"><span class="interactive minimal tag">pwntools</span></a></div></div><div class="blog-content"><h1 id="challenge">Challenge</h1><blockquote><p>Please kill the werewolf with silver bullet!</p><p><code>nc chall.pwnable.tw 10103</code></p></blockquote><p>We are also provided a binary and the libc used on the server.</p><h1 id="solution">Solution</h1><p>When running the binary, we can see that we have four options:</p><p><img alt="" src="https://blog.srikavin.me/posts/pwnable-tw-silver-bullet/5d0810548487900bf40e47d5.png"></p><p>The provided binary was not stripped, so reversing was easy with Ghidra.</p><pre style="background-color:#ffffff;">
<code><span style="font-weight:bold;color:#a71d5d;">void </span><span style="font-weight:bold;color:#795da3;">create_bullet</span><span style="color:#323232;">(bullet </span><span style="font-weight:bold;color:#a71d5d;">*</span><span style="color:#323232;">bullet)
{
  </span><span style="color:#0086b3;">size_t</span><span style="color:#323232;"> size;
  
  </span><span style="font-weight:bold;color:#a71d5d;">if </span><span style="color:#323232;">(bullet-&gt;description[</span><span style="color:#0086b3;">0</span><span style="color:#323232;">] </span><span style="font-weight:bold;color:#a71d5d;">== </span><span style="color:#183691;">&#39;</span><span style="color:#0086b3;">\0</span><span style="color:#183691;">&#39;</span><span style="color:#323232;">) {
    </span><span style="color:#62a35c;">printf</span><span style="color:#323232;">(</span><span style="color:#183691;">&quot;Give me your description of bullet :&quot;</span><span style="color:#323232;">,</span><span style="color:#0086b3;">0</span><span style="color:#323232;">);
    read_input((</span><span style="font-weight:bold;color:#a71d5d;">char *</span><span style="color:#323232;">)bullet,</span><span style="color:#0086b3;">0x30</span><span style="color:#323232;">);
    size </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#62a35c;">strlen</span><span style="color:#323232;">((</span><span style="font-weight:bold;color:#a71d5d;">char *</span><span style="color:#323232;">)bullet);
    </span><span style="color:#62a35c;">printf</span><span style="color:#323232;">(</span><span style="color:#183691;">&quot;Your power is : </span><span style="color:#0086b3;">%u\n</span><span style="color:#183691;">&quot;</span><span style="color:#323232;">,size);
    bullet-&gt;power </span><span style="font-weight:bold;color:#a71d5d;">=</span><span style="color:#323232;"> size;
    </span><span style="color:#62a35c;">puts</span><span style="color:#323232;">(</span><span style="color:#183691;">&quot;Good luck !!&quot;</span><span style="color:#323232;">);
  }
  </span><span style="font-weight:bold;color:#a71d5d;">else </span><span style="color:#323232;">{
    </span><span style="color:#62a35c;">puts</span><span style="color:#323232;">(</span><span style="color:#183691;">&quot;You have been created the Bullet !&quot;</span><span style="color:#323232;">);
  }
  </span><span style="font-weight:bold;color:#a71d5d;">return</span><span style="color:#323232;">;
}
</span></code></pre></div><a href="https://blog.srikavin.me/posts/pwnable-tw-silver-bullet/" class="blog-preview-continue-reading">Continue Reading</a></div><div class="blog-preview"><div class="blog-header"><h1 class="title"><a href="https://blog.srikavin.me/posts/pwnable-tw-hacknote/">pwnable.tw - hacknote</a></h1><div class="subtitle"><span>Posted on <span class="date" title="Created: 2020-01-12T19:40:43.176Z&#10;Updated: 2020-03-23T05:57:18.669Z">January 12, 2020* </span>in ctf-writeups</span></div><div class="tags"><a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;pwnable-tw&#x2F;"><span class="interactive minimal tag">pwnable.tw</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;binary-exploitation&#x2F;"><span class="interactive minimal tag">binary-exploitation</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;heap-exploitation&#x2F;"><span class="interactive minimal tag">heap-exploitation</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;use-after-free&#x2F;"><span class="interactive minimal tag">use-after-free</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;pwntools&#x2F;"><span class="interactive minimal tag">pwntools</span></a></div></div><div class="blog-content"><h1 id="challenge">Challenge</h1><blockquote><p>A good Hacker should always take good notes!</p><p><code>nc chall.pwnable.tw 10102</code></p></blockquote><p>We are also provided a binary and the libc used on the server.</p><h1 id="solution">Solution</h1><p>When running the binary, we can see four options:</p><p><img alt="" src="https://blog.srikavin.me/posts/pwnable-tw-hacknote/5d07df70508cb0091260f634.png"></p><h2 id="understanding-the-binary">Understanding the binary</h2><p>When reversing the binary, we can use the shown options to help identify functions used. I reversed the binary in Ghidra, and the following are the cleaned up decompilation output from the binary.</p></div><a href="https://blog.srikavin.me/posts/pwnable-tw-hacknote/" class="blog-preview-continue-reading">Continue Reading</a></div><div class="blog-preview"><div class="blog-header"><h1 class="title"><a href="https://blog.srikavin.me/posts/gci-exploiting-a-buffer-overflow-vulnerability/">GCI - Fedora Project - Exploiting a Buffer Overflow Vulnerability</a></h1><div class="subtitle"><span>Posted on <span class="date" title="Created: 2019-12-15">December 15, 2019 </span>in ctf-writeups</span></div><div class="tags"><a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;google-code-in&#x2F;"><span class="interactive minimal tag">google-code-in</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;binary-exploitation&#x2F;"><span class="interactive minimal tag">binary-exploitation</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;buffer-overflow&#x2F;"><span class="interactive minimal tag">buffer-overflow</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;aslr&#x2F;"><span class="interactive minimal tag">aslr</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;rce&#x2F;"><span class="interactive minimal tag">rce</span></a></div></div><div class="blog-content"><h1 id="challenge">Challenge</h1><p>We are given a binary to exploit. By running <code>checksec</code> on it, we see that the binary has the following protections: [show-line-numbers]: false</p><pre style="background-color:#ffffff;">
<code><span style="color:#323232;">Canary                        : No
NX                            : Yes
PIE                           : Yes
Fortify                       : No
RelRO                         : Partial
</span></code></pre><p>Because the binary has NX, we cannot place executable shell code in a buffer and then jump to it. PIE allows the code section of the binary to be located anywhere in memory. This means that we don't know the address of functions within the binary; however, we still know relative offsets.</p><h2 id="reverse-engineering">Reverse Engineering</h2><pre style="background-color:#ffffff;">
<code><span style="color:#323232;">Dump of assembler code for function main:
   0x0000000000001145 &lt;+0&gt;:     push   rbp                                  # Setup Stack
   0x0000000000001146 &lt;+1&gt;:     mov    rbp,rsp                              
   0x0000000000001149 &lt;+4&gt;:     sub    rsp,0x110                            # Allocate 0x110 bytes on stack
   0x0000000000001150 &lt;+11&gt;:    mov    DWORD PTR [rbp-0x104],edi            # Copies edi into stack offset 0x104
   0x0000000000001156 &lt;+17&gt;:    mov    QWORD PTR [rbp-0x110],rsi            # Copies rsi into stack offset 0x110
   0x000000000000115d &lt;+24&gt;:    mov    rax,QWORD PTR [rbp-0x110]            # Copies value of pointer into rax
   0x0000000000001164 &lt;+31&gt;:    add    rax,0x8                              # Adds size_t
   0x0000000000001168 &lt;+35&gt;:    mov    rdx,QWORD PTR [rax]                  # Copies the value of the pointer [rax + 8] into rdx
   0x000000000000116b &lt;+38&gt;:    lea    rax,[rbp-0x100]                      # Loads the address of [rbp - 0x100] into rax
   0x0000000000001172 &lt;+45&gt;:    mov    rsi,rdx                              # rsi = rdx
   0x0000000000001175 &lt;+48&gt;:    mov    rdi,rax                              # rdi = rax
   0x0000000000001178 &lt;+51&gt;:    call   0x1030 &lt;strcpy@plt&gt;                  # Calls strcpy(rsi, rdi) ; strcpy ([rbp - 0x100], argv[1])
   0x000000000000117d &lt;+56&gt;:    lea    rax,[rbp-0x100]                      # Loads address of [rbp-0x100] into rax
   0x0000000000001184 &lt;+63&gt;:    mov    rdi,rax                              # rdi = rax
   0x0000000000001187 &lt;+66&gt;:    call   0x1040 &lt;puts@plt&gt;                    # puts(rdi)
   0x000000000000118c &lt;+71&gt;:    mov    eax,0x0                              # return 0
   0x0000000000001191 &lt;+76&gt;:    leave                                       
   0x0000000000001192 &lt;+77&gt;:    ret                                         
End of assembler dump.
</span></code></pre></div><a href="https://blog.srikavin.me/posts/gci-exploiting-a-buffer-overflow-vulnerability/" class="blog-preview-continue-reading">Continue Reading</a></div><div class="blog-preview"><div class="blog-header"><h1 class="title"><a href="https://blog.srikavin.me/posts/pwnable-tw-start/">pwnable.tw - start</a></h1><div class="subtitle"><span>Posted on <span class="date" title="Created: 2019-11-22T18:30:01.515Z&#10;Updated: 2019-11-23T19:32:29.189Z">November 22, 2019* </span>in ctf-writeups</span></div><div class="tags"><a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;pwnable-tw&#x2F;"><span class="interactive minimal tag">pwnable.tw</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;binary-exploitation&#x2F;"><span class="interactive minimal tag">binary-exploitation</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;pwntools&#x2F;"><span class="interactive minimal tag">pwntools</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;shellcode&#x2F;"><span class="interactive minimal tag">shellcode</span></a></div></div><div class="blog-content"><p>We are given a linux binary. To start off, lets run <code>checksec</code> on it:</p><pre style="background-color:#ffffff;">
<code><span style="color:#323232;">Arch:     i386-32-little
RELRO:    No RELRO
Stack:    No canary found
NX:       NX disabled
PIE:      No PIE (0x8048000)
</span></code></pre><p>It looks like NX is disabled, so if needed, we can place and execute shell code from the stack. To understand how this binary works, I opened it with <code>Ghidra</code>. There are only two functions, <code>_entry</code> and <code>_exit</code>. Let's look at <code>_entry</code> first. Although the decompilation is mostly useless, the disassembly is more than enough.</p><p><img alt="" src="https://blog.srikavin.me/posts/pwnable-tw-start/5cff109009821b08235e212a.png"></p><p>We can see two <code>int 0x80</code>s that are syscalls. Looking at the value of <code>eax</code> and by referencing a <a href="https://www.informatik.htw-dresden.de/%7Ebeck/ASM/syscall_list.html">32-bit syscall table</a>, we can identify them. The reversed syscalls are shown in comments in the above screenshot. It's also clear that we control <code>EIP</code> due to the large <code>read</code> syscall that will overflow into the save return address on the stack.</p><p>As we saw earlier, the <code>NX</code> bit is disabled, so we can jump to our shellcode. To do so, we need to leak a stack address to identify where to jump to. Using <a href="https://github.com/pwndbg/pwndbg">pwndbg</a>, it's easy to watch the stack during execution.</p></div><a href="https://blog.srikavin.me/posts/pwnable-tw-start/" class="blog-preview-continue-reading">Continue Reading</a></div><div class="blog-preview"><div class="blog-header"><h1 class="title"><a href="https://blog.srikavin.me/posts/picoctf-2019-java-script-kiddie-2/">picoCTF 2019 - Java Script Kiddie 2</a></h1><div class="subtitle"><span>Posted on <span class="date" title="Created: 2019-10-12T22:48:41.356Z&#10;Updated: 2019-11-14T04:43:58.202Z">October 12, 2019* </span>in ctf-writeups</span></div><div class="tags"><a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;picoctf19&#x2F;"><span class="interactive minimal tag">picoctf19</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;web&#x2F;"><span class="interactive minimal tag">web</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;reversing&#x2F;"><span class="interactive minimal tag">reversing</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;javascript&#x2F;"><span class="interactive minimal tag">javascript</span></a></div></div><div class="blog-content"><p>We are given a website, that is nearly identical to Java Script Kiddie 1. The <code>assemble_png</code> function takes in a key of length 32, and manipulates the bytes to decode the <code>src</code> attribute of an image.</p><pre style="background-color:#ffffff;">
<code><span style="font-weight:bold;color:#a71d5d;">function </span><span style="font-weight:bold;color:#795da3;">assemble_png</span><span style="color:#323232;">(u_in){
    </span><span style="font-weight:bold;color:#a71d5d;">var </span><span style="color:#0086b3;">LEN </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#0086b3;">16</span><span style="color:#323232;">;
    </span><span style="font-weight:bold;color:#a71d5d;">var </span><span style="color:#323232;">key </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#183691;">&quot;00000000000000000000000000000000&quot;</span><span style="color:#323232;">;
    </span><span style="font-weight:bold;color:#a71d5d;">var </span><span style="color:#323232;">shifter;
    </span><span style="font-weight:bold;color:#a71d5d;">if</span><span style="color:#323232;">(u_in.length </span><span style="font-weight:bold;color:#a71d5d;">== </span><span style="color:#323232;">key.length){
        key </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#323232;">u_in;
    }
    </span><span style="font-weight:bold;color:#a71d5d;">var </span><span style="color:#323232;">result </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#323232;">[];
    </span><span style="font-weight:bold;color:#a71d5d;">for</span><span style="color:#323232;">(</span><span style="font-weight:bold;color:#a71d5d;">var </span><span style="color:#323232;">i </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#0086b3;">0</span><span style="color:#323232;">; i </span><span style="font-weight:bold;color:#a71d5d;">&lt; </span><span style="color:#0086b3;">LEN</span><span style="color:#323232;">; i</span><span style="font-weight:bold;color:#a71d5d;">++</span><span style="color:#323232;">){
        shifter </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#0086b3;">Number</span><span style="color:#323232;">(key.slice((i</span><span style="font-weight:bold;color:#a71d5d;">*</span><span style="color:#0086b3;">2</span><span style="color:#323232;">),(i</span><span style="font-weight:bold;color:#a71d5d;">*</span><span style="color:#0086b3;">2</span><span style="color:#323232;">)</span><span style="font-weight:bold;color:#a71d5d;">+</span><span style="color:#0086b3;">1</span><span style="color:#323232;">));
        </span><span style="font-weight:bold;color:#a71d5d;">for</span><span style="color:#323232;">(</span><span style="font-weight:bold;color:#a71d5d;">var </span><span style="color:#323232;">j </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#0086b3;">0</span><span style="color:#323232;">; j </span><span style="font-weight:bold;color:#a71d5d;">&lt; </span><span style="color:#323232;">(bytes.length </span><span style="font-weight:bold;color:#a71d5d;">/ </span><span style="color:#0086b3;">LEN</span><span style="color:#323232;">); j </span><span style="font-weight:bold;color:#a71d5d;">++</span><span style="color:#323232;">){
            result[(j </span><span style="font-weight:bold;color:#a71d5d;">* </span><span style="color:#0086b3;">LEN</span><span style="color:#323232;">) </span><span style="font-weight:bold;color:#a71d5d;">+ </span><span style="color:#323232;">i] </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#323232;">bytes[(((j </span><span style="font-weight:bold;color:#a71d5d;">+ </span><span style="color:#323232;">shifter) </span><span style="font-weight:bold;color:#a71d5d;">* </span><span style="color:#0086b3;">LEN</span><span style="color:#323232;">) </span><span style="font-weight:bold;color:#a71d5d;">% </span><span style="color:#323232;">bytes.length) </span><span style="font-weight:bold;color:#a71d5d;">+ </span><span style="color:#323232;">i]
        }
    }
    </span><span style="font-weight:bold;color:#a71d5d;">while</span><span style="color:#323232;">(result[result.length</span><span style="font-weight:bold;color:#a71d5d;">-</span><span style="color:#0086b3;">1</span><span style="color:#323232;">] </span><span style="font-weight:bold;color:#a71d5d;">== </span><span style="color:#0086b3;">0</span><span style="color:#323232;">){
        result </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#323232;">result.slice(</span><span style="color:#0086b3;">0</span><span style="color:#323232;">,result.length</span><span style="font-weight:bold;color:#a71d5d;">-</span><span style="color:#0086b3;">1</span><span style="color:#323232;">);
    }
    </span><span style="color:#0086b3;">document</span><span style="color:#323232;">.getElementById(</span><span style="color:#183691;">&quot;Area&quot;</span><span style="color:#323232;">).src </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#183691;">&quot;data:image/png;base64,&quot; </span><span style="font-weight:bold;color:#a71d5d;">+ </span><span style="color:#323232;">btoa(</span><span style="color:#0086b3;">String</span><span style="color:#323232;">.</span><span style="color:#0086b3;">fromCharCode</span><span style="color:#323232;">.apply(</span><span style="color:#0086b3;">null</span><span style="color:#323232;">, </span><span style="font-weight:bold;color:#a71d5d;">new </span><span style="color:#0086b3;">Uint8Array</span><span style="color:#323232;">(result)));
    </span><span style="font-weight:bold;color:#a71d5d;">return </span><span style="color:#0086b3;">false</span><span style="color:#323232;">;
}
</span></code></pre></div><a href="https://blog.srikavin.me/posts/picoctf-2019-java-script-kiddie-2/" class="blog-preview-continue-reading">Continue Reading</a></div><div class="blog-preview"><div class="blog-header"><h1 class="title"><a href="https://blog.srikavin.me/posts/picoctf-2019-shark-on-wire-2/">picoCTF 2019 - shark on wire 2</a></h1><div class="subtitle"><span>Posted on <span class="date" title="Created: 2019-10-09T20:23:07.387Z&#10;Updated: 2019-11-14T04:07:08.987Z">October 9, 2019* </span>in ctf-writeups</span></div><div class="tags"><a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;picoctf19&#x2F;"><span class="interactive minimal tag">picoctf19</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;steganography&#x2F;"><span class="interactive minimal tag">steganography</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;wireshark&#x2F;"><span class="interactive minimal tag">wireshark</span></a></div></div><div class="blog-content"><p>We are given a packet capture with little description of what to look for. While looking through the UDP streams, I came across two packets with the text <code>start</code> and <code>end</code> within in the data section:</p><p><strong>Packet 1104:</strong></p><p><img alt="" src="https://blog.srikavin.me/posts/picoctf-2019-shark-on-wire-2/5d9e3cb26bac7409ac9e7359.png"></p><p><strong>Packet 1303:</strong></p><p><img alt="" src="https://blog.srikavin.me/posts/picoctf-2019-shark-on-wire-2/5d9e3cf96bac7409ac9e735b.png"></p><p>The only bytes changing between the start packet (#1104) and the next UDP packet (#1106) were the data field, checksums, and the source port. I noticed that the difference between the source ports of these two packets (5112 - 5000 = 112) was the ASCII code for the letter <code>p</code>. I repeated this for all the UDP packets (excluding MDNS queries) and found the following numbers:</p></div><a href="https://blog.srikavin.me/posts/picoctf-2019-shark-on-wire-2/" class="blog-preview-continue-reading">Continue Reading</a></div><div class="blog-preview"><div class="blog-header"><h1 class="title"><a href="https://blog.srikavin.me/posts/nactf-2019-loopy-0/">nactf 2019 - Loopy #0</a></h1><div class="subtitle"><span>Posted on <span class="date" title="Created: 2019-09-22T20:39:04.285Z&#10;Updated: 2019-11-24T03:53:01.555Z">September 22, 2019* </span>in ctf-writeups</span></div><div class="tags"><a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;nactf2019&#x2F;"><span class="interactive minimal tag">nactf2019</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;binary-exploitation&#x2F;"><span class="interactive minimal tag">binary-exploitation</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;pwntools&#x2F;"><span class="interactive minimal tag">pwntools</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;format-string&#x2F;"><span class="interactive minimal tag">format-string</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;return-oriented-programming&#x2F;"><span class="interactive minimal tag">return-oriented-programming</span></a></div></div><div class="blog-content"><h1 id="challenge">Challenge</h1><blockquote><p>This program is quite short, but has got <code>printf</code> and <code>gets</code> in it! This shouldn't be too hard, right?</p><p>Connect at <code>nc shell.2019.nactf.com 31283</code></p></blockquote><p>We are given the libc used, the binary, and the source code.</p><pre style="background-color:#ffffff;">
<code><span style="font-weight:bold;color:#a71d5d;">#include </span><span style="color:#183691;">&lt;stdio.h&gt;

</span><span style="font-weight:bold;color:#a71d5d;">void </span><span style="font-weight:bold;color:#795da3;">vuln</span><span style="color:#323232;">()
{
	</span><span style="font-weight:bold;color:#a71d5d;">char</span><span style="color:#323232;"> buf[</span><span style="color:#0086b3;">64</span><span style="color:#323232;">];
	</span><span style="color:#62a35c;">fputs</span><span style="color:#323232;">(</span><span style="color:#183691;">&quot;Type something&gt;&quot;</span><span style="color:#323232;">, stdout);
	</span><span style="color:#62a35c;">gets</span><span style="color:#323232;">(buf);
	</span><span style="color:#62a35c;">fputs</span><span style="color:#323232;">(</span><span style="color:#183691;">&quot;You typed: &quot;</span><span style="color:#323232;">, stdout);
	</span><span style="color:#62a35c;">printf</span><span style="color:#323232;">(buf);
}

</span><span style="font-weight:bold;color:#a71d5d;">int </span><span style="font-weight:bold;color:#795da3;">main</span><span style="color:#323232;">()
{
	</span><span style="font-style:italic;color:#969896;">/* Disable buffering on stdout */
	</span><span style="color:#62a35c;">setvbuf</span><span style="color:#323232;">(stdout, </span><span style="color:#0086b3;">NULL</span><span style="color:#323232;">, _IONBF, </span><span style="color:#0086b3;">0</span><span style="color:#323232;">);

	vuln();

	</span><span style="font-weight:bold;color:#a71d5d;">return </span><span style="color:#0086b3;">0</span><span style="color:#323232;">;
}
</span></code></pre></div><a href="https://blog.srikavin.me/posts/nactf-2019-loopy-0/" class="blog-preview-continue-reading">Continue Reading</a></div><div class="blog-preview"><div class="blog-header"><h1 class="title"><a href="https://blog.srikavin.me/posts/nactf-2019-dr-j-s-group-test-randomizer-2-bbob/">nactf 2019 - Dr. J&#x27;s Group Test Randomizer #2: BBOB</a></h1><div class="subtitle"><span>Posted on <span class="date" title="Created: 2019-09-22T17:48:52.836Z&#10;Updated: 2019-09-22T22:03:40.121Z">September 22, 2019* </span>in ctf-writeups</span></div><div class="tags"><a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;nactf2019&#x2F;"><span class="interactive minimal tag">nactf2019</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;cryptography&#x2F;"><span class="interactive minimal tag">cryptography</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;z3&#x2F;"><span class="interactive minimal tag">z3</span></a></div></div><div class="blog-content"><h1 id="challenge">Challenge</h1><blockquote><p>This is it. The last group test of the year. Dr. J patched his prng again so numbers won't repeat, so I guess Leaf won't get to know the group test pairs ahead of time... oh WEYL. Who knew middle square could make such a good prng?</p><p><code>nc shell.2019.nactf.com 31382</code></p></blockquote><p>We're also given the source of the running application:</p><pre style="background-color:#ffffff;">
<code><span style="font-weight:bold;color:#a71d5d;">#include </span><span style="color:#183691;">&lt;stdio.h&gt;
</span><span style="font-weight:bold;color:#a71d5d;">#include </span><span style="color:#183691;">&lt;stdint.h&gt;
</span><span style="font-weight:bold;color:#a71d5d;">#include </span><span style="color:#183691;">&lt;sodium.h&gt;
</span><span style="font-weight:bold;color:#a71d5d;">#include </span><span style="color:#183691;">&lt;stdbool.h&gt;
</span><span style="font-weight:bold;color:#a71d5d;">#include </span><span style="color:#183691;">&lt;string.h&gt;
</span><span style="font-weight:bold;color:#a71d5d;">#define </span><span style="color:#323232;">NUM_CORRECT </span><span style="color:#0086b3;">10

uint64_t</span><span style="color:#323232;"> x </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#0086b3;">0</span><span style="color:#323232;">, w </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#0086b3;">0</span><span style="color:#323232;">, s </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#0086b3;">0xb5ad4eceda1ce2a9</span><span style="color:#323232;">;

</span><span style="color:#0086b3;">uint32_t </span><span style="font-weight:bold;color:#795da3;">nextRand</span><span style="color:#323232;">() {
  w </span><span style="font-weight:bold;color:#a71d5d;">+=</span><span style="color:#323232;"> s;
  x </span><span style="font-weight:bold;color:#a71d5d;">=</span><span style="color:#323232;"> x</span><span style="font-weight:bold;color:#a71d5d;">*</span><span style="color:#323232;">x </span><span style="font-weight:bold;color:#a71d5d;">+</span><span style="color:#323232;"> w;
  x </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#323232;">(x</span><span style="font-weight:bold;color:#a71d5d;">&gt;&gt;</span><span style="color:#0086b3;">32</span><span style="color:#323232;">) </span><span style="font-weight:bold;color:#a71d5d;">| </span><span style="color:#323232;">(x</span><span style="font-weight:bold;color:#a71d5d;">&lt;&lt;</span><span style="color:#0086b3;">32</span><span style="color:#323232;">);
  </span><span style="font-weight:bold;color:#a71d5d;">return</span><span style="color:#323232;"> x </span><span style="font-weight:bold;color:#a71d5d;">% </span><span style="color:#323232;">(</span><span style="color:#0086b3;">1</span><span style="font-weight:bold;color:#a71d5d;">UL&lt;&lt;</span><span style="color:#0086b3;">32</span><span style="color:#323232;">);
}

</span><span style="font-weight:bold;color:#a71d5d;">void </span><span style="font-weight:bold;color:#795da3;">init_seed</span><span style="color:#323232;">() {
  </span><span style="color:#0086b3;">uint64_t</span><span style="color:#323232;"> r1 </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#323232;">(</span><span style="color:#0086b3;">uint64_t</span><span style="color:#323232;">) randombytes_random();
  </span><span style="color:#0086b3;">uint64_t</span><span style="color:#323232;"> r2 </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#323232;">(</span><span style="color:#0086b3;">uint64_t</span><span style="color:#323232;">) randombytes_random();
  x </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#323232;">(r1 </span><span style="font-weight:bold;color:#a71d5d;">&lt;&lt; </span><span style="color:#0086b3;">32</span><span style="color:#323232;">) </span><span style="font-weight:bold;color:#a71d5d;">+</span><span style="color:#323232;"> r2;
  r1 </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#323232;">(</span><span style="color:#0086b3;">uint64_t</span><span style="color:#323232;">) randombytes_random();
  r2 </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#323232;">(</span><span style="color:#0086b3;">uint64_t</span><span style="color:#323232;">) randombytes_random();
  w </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#323232;">(r1 </span><span style="font-weight:bold;color:#a71d5d;">&lt;&lt; </span><span style="color:#0086b3;">32</span><span style="color:#323232;">) </span><span style="font-weight:bold;color:#a71d5d;">+</span><span style="color:#323232;"> r2;
}

</span><span style="font-weight:bold;color:#a71d5d;">void </span><span style="font-weight:bold;color:#795da3;">print_flag</span><span style="color:#323232;">() {
  FILE </span><span style="font-weight:bold;color:#a71d5d;">*</span><span style="color:#323232;">f </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#62a35c;">fopen</span><span style="color:#323232;">(</span><span style="color:#183691;">&quot;flag.txt&quot;</span><span style="color:#323232;">, </span><span style="color:#183691;">&quot;r&quot;</span><span style="color:#323232;">);
  </span><span style="font-weight:bold;color:#a71d5d;">char</span><span style="color:#323232;"> flag[</span><span style="color:#0086b3;">100</span><span style="color:#323232;">];
  </span><span style="color:#62a35c;">fgets</span><span style="color:#323232;">(flag, </span><span style="font-weight:bold;color:#a71d5d;">sizeof</span><span style="color:#323232;">(flag), f);
  </span><span style="color:#62a35c;">printf</span><span style="color:#323232;">(</span><span style="color:#183691;">&quot;</span><span style="color:#0086b3;">%s\n</span><span style="color:#183691;">&quot;</span><span style="color:#323232;">, flag);
  </span><span style="color:#62a35c;">fflush</span><span style="color:#323232;">( stdout );
  </span><span style="font-weight:bold;color:#a71d5d;">return</span><span style="color:#323232;">;
}

</span><span style="font-weight:bold;color:#a71d5d;">const char *</span><span style="color:#323232;">messages[NUM_CORRECT] </span><span style="font-weight:bold;color:#a71d5d;">=
</span><span style="color:#323232;">{ </span><span style="color:#183691;">&quot;</span><span style="color:#0086b3;">\n</span><span style="color:#183691;">Hmm... lucky guess...</span><span style="color:#0086b3;">\n</span><span style="color:#183691;">&quot;</span><span style="color:#323232;">,
  </span><span style="color:#183691;">&quot;</span><span style="color:#0086b3;">\n</span><span style="color:#183691;">Wow, that was coincidental!</span><span style="color:#0086b3;">\n</span><span style="color:#183691;">&quot;</span><span style="color:#323232;">,
  </span><span style="color:#183691;">&quot;</span><span style="color:#0086b3;">\n</span><span style="color:#183691;">What? How did you guess that?</span><span style="color:#0086b3;">\n</span><span style="color:#183691;">&quot;</span><span style="color:#323232;">,
  </span><span style="color:#183691;">&quot;</span><span style="color:#0086b3;">\n</span><span style="color:#183691;">That&#39;s right, but you won&#39;t be able to guess right again!</span><span style="color:#0086b3;">\n</span><span style="color:#183691;">&gt; &quot;</span><span style="color:#323232;">,
  </span><span style="color:#183691;">&quot;</span><span style="color:#0086b3;">\n</span><span style="color:#183691;">Strangely, that&#39;s correct...</span><span style="color:#0086b3;">\n</span><span style="color:#183691;">&quot;
</span><span style="color:#323232;">};

</span><span style="font-weight:bold;color:#a71d5d;">int </span><span style="font-weight:bold;color:#795da3;">main</span><span style="color:#323232;">() {
  </span><span style="color:#62a35c;">setvbuf</span><span style="color:#323232;">(stdout, </span><span style="color:#0086b3;">NULL</span><span style="color:#323232;">, _IONBF, </span><span style="color:#0086b3;">0</span><span style="color:#323232;">);
  init_seed();
  </span><span style="color:#62a35c;">printf</span><span style="color:#323232;">(</span><span style="color:#183691;">&quot;</span><span style="color:#0086b3;">\n</span><span style="color:#183691;">Welcome to Dr. J&#39;s Random Number Generator v3! We have received reports of &quot;
  &quot;a vulnerability involving repetition of output. This vulnerability has since been patched, &quot;
  &quot;and Dr. J&#39;s RNG is now 100</span><span style="color:#0086b3;">%%</span><span style="color:#183691;"> secure. </span><span style="color:#0086b3;">\n</span><span style="color:#183691;">&quot;
  &quot;[r] Print a new random number </span><span style="color:#0086b3;">\n</span><span style="color:#183691;">&quot;
  &quot;[g] Guess the next ten random numbers and receive the flag! </span><span style="color:#0086b3;">\n</span><span style="color:#183691;">&quot;
  &quot;[q] Quit </span><span style="color:#0086b3;">\n\n</span><span style="color:#183691;">&quot;</span><span style="color:#323232;">);
  </span><span style="font-weight:bold;color:#a71d5d;">char</span><span style="color:#323232;"> line[</span><span style="color:#0086b3;">100</span><span style="color:#323232;">];
  </span><span style="font-weight:bold;color:#a71d5d;">while </span><span style="color:#323232;">(</span><span style="color:#0086b3;">true</span><span style="color:#323232;">) {
    </span><span style="color:#62a35c;">printf</span><span style="color:#323232;">(</span><span style="color:#183691;">&quot;&gt; &quot;</span><span style="color:#323232;">);
    </span><span style="color:#62a35c;">fgets </span><span style="color:#323232;">(line, </span><span style="font-weight:bold;color:#a71d5d;">sizeof</span><span style="color:#323232;">(line), stdin);
    line[</span><span style="color:#62a35c;">strcspn</span><span style="color:#323232;">(line, </span><span style="color:#183691;">&quot;</span><span style="color:#0086b3;">\n</span><span style="color:#183691;">&quot;</span><span style="color:#323232;">)] </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#0086b3;">0</span><span style="color:#323232;">;

    </span><span style="font-weight:bold;color:#a71d5d;">if </span><span style="color:#323232;">(</span><span style="font-weight:bold;color:#a71d5d;">!</span><span style="color:#62a35c;">strcmp</span><span style="color:#323232;">(</span><span style="color:#183691;">&quot;r&quot;</span><span style="color:#323232;">, line)) {
      </span><span style="color:#0086b3;">uint64_t</span><span style="color:#323232;"> r </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#323232;">nextRand();
      </span><span style="color:#62a35c;">printf</span><span style="color:#323232;">(</span><span style="color:#183691;">&quot;</span><span style="color:#0086b3;">%lu\n</span><span style="color:#183691;">&quot;</span><span style="color:#323232;">, r);
    }
    </span><span style="font-weight:bold;color:#a71d5d;">if </span><span style="color:#323232;">(</span><span style="font-weight:bold;color:#a71d5d;">!</span><span style="color:#62a35c;">strcmp</span><span style="color:#323232;">(</span><span style="color:#183691;">&quot;g&quot;</span><span style="color:#323232;">, line)) {
      </span><span style="color:#62a35c;">printf</span><span style="color:#323232;">(</span><span style="color:#183691;">&quot;</span><span style="color:#0086b3;">\n</span><span style="color:#183691;">Guess the next ten random numbers for a flag! &quot;
      &quot;The chance of guessing all ten numbers correctly is 1/(2*10^96). I hope you&#39;re lucky! &quot;
      &quot;</span><span style="color:#0086b3;">\n</span><span style="color:#183691;">Enter Guess 1:</span><span style="color:#0086b3;">\n</span><span style="color:#183691;">&gt; &quot;</span><span style="color:#323232;">);

      </span><span style="font-weight:bold;color:#a71d5d;">for </span><span style="color:#323232;">(</span><span style="font-weight:bold;color:#a71d5d;">int</span><span style="color:#323232;"> i </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#0086b3;">0</span><span style="color:#323232;">; i </span><span style="font-weight:bold;color:#a71d5d;">&lt;</span><span style="color:#323232;"> NUM_CORRECT; i</span><span style="font-weight:bold;color:#a71d5d;">++</span><span style="color:#323232;">) {
        </span><span style="color:#0086b3;">uint64_t</span><span style="color:#323232;"> guess </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#0086b3;">0</span><span style="color:#323232;">;
        </span><span style="color:#62a35c;">fgets </span><span style="color:#323232;">(line, </span><span style="font-weight:bold;color:#a71d5d;">sizeof</span><span style="color:#323232;">(line), stdin);
        </span><span style="color:#62a35c;">sscanf</span><span style="color:#323232;">(line, </span><span style="color:#183691;">&quot;</span><span style="color:#0086b3;">%lu</span><span style="color:#183691;">&quot;</span><span style="color:#323232;">, </span><span style="font-weight:bold;color:#a71d5d;">&amp;</span><span style="color:#323232;">guess);
        </span><span style="font-weight:bold;color:#a71d5d;">if </span><span style="color:#323232;">(guess </span><span style="font-weight:bold;color:#a71d5d;">== </span><span style="color:#323232;">nextRand()) {
          </span><span style="font-weight:bold;color:#a71d5d;">int</span><span style="color:#323232;"> m </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#323232;">randombytes_uniform(</span><span style="color:#0086b3;">5</span><span style="color:#323232;">);
          </span><span style="color:#62a35c;">printf</span><span style="color:#323232;">(</span><span style="color:#183691;">&quot;</span><span style="color:#0086b3;">%s</span><span style="color:#183691;">&quot;</span><span style="color:#323232;">, messages[m]);
          </span><span style="font-weight:bold;color:#a71d5d;">if </span><span style="color:#323232;">(i </span><span style="font-weight:bold;color:#a71d5d;">&lt;</span><span style="color:#323232;"> NUM_CORRECT</span><span style="font-weight:bold;color:#a71d5d;">-</span><span style="color:#0086b3;">1</span><span style="color:#323232;">) {
            </span><span style="color:#62a35c;">printf</span><span style="color:#323232;">(</span><span style="color:#183691;">&quot;Enter Guess </span><span style="color:#0086b3;">%d</span><span style="color:#183691;">:</span><span style="color:#0086b3;">\n</span><span style="color:#183691;">&gt; &quot;</span><span style="color:#323232;">, i</span><span style="font-weight:bold;color:#a71d5d;">+</span><span style="color:#0086b3;">2</span><span style="color:#323232;">);
          }
          </span><span style="font-weight:bold;color:#a71d5d;">else </span><span style="color:#323232;">{
            </span><span style="color:#62a35c;">printf</span><span style="color:#323232;">(</span><span style="color:#183691;">&quot;What sorcery is this? That&#39;s impossible! I guess you deserve this flag:</span><span style="color:#0086b3;">\n</span><span style="color:#183691;">&quot;</span><span style="color:#323232;">);
            print_flag();
            </span><span style="font-weight:bold;color:#a71d5d;">break</span><span style="color:#323232;">;
          }
        }
        </span><span style="font-weight:bold;color:#a71d5d;">else </span><span style="color:#323232;">{
          </span><span style="color:#62a35c;">printf</span><span style="color:#323232;">(</span><span style="color:#183691;">&quot;That&#39;s incorrect. Get out of here!</span><span style="color:#0086b3;">\n</span><span style="color:#183691;">&quot;</span><span style="color:#323232;">);
          </span><span style="font-weight:bold;color:#a71d5d;">break</span><span style="color:#323232;">;
        }
      }
      </span><span style="font-weight:bold;color:#a71d5d;">break</span><span style="color:#323232;">;
    }
    </span><span style="font-weight:bold;color:#a71d5d;">if </span><span style="color:#323232;">(</span><span style="font-weight:bold;color:#a71d5d;">!</span><span style="color:#62a35c;">strcmp</span><span style="color:#323232;">(</span><span style="color:#183691;">&quot;q&quot;</span><span style="color:#323232;">, line)) {
      </span><span style="color:#62a35c;">printf</span><span style="color:#323232;">(</span><span style="color:#183691;">&quot;</span><span style="color:#0086b3;">\n</span><span style="color:#183691;">Goodbye!</span><span style="color:#0086b3;">\n</span><span style="color:#183691;">&quot;</span><span style="color:#323232;">);
      </span><span style="font-weight:bold;color:#a71d5d;">break</span><span style="color:#323232;">;
    }
  }
  </span><span style="font-weight:bold;color:#a71d5d;">return </span><span style="color:#0086b3;">0</span><span style="color:#323232;">;
}
</span></code></pre></div><a href="https://blog.srikavin.me/posts/nactf-2019-dr-j-s-group-test-randomizer-2-bbob/" class="blog-preview-continue-reading">Continue Reading</a></div><div class="blog-preview"><div class="blog-header"><h1 class="title"><a href="https://blog.srikavin.me/posts/overthewire-bandit/">overthewire - bandit</a></h1><div class="subtitle"><span>Posted on <span class="date" title="Created: 2019-06-20T17:35:22.906Z&#10;Updated: 2019-09-22T19:49:29.442Z">June 20, 2019* </span>in ctf-writeups</span></div><div class="tags"><a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;overthewire&#x2F;"><span class="interactive minimal tag">overthewire</span></a></div></div><div class="blog-content"><h1 id="level-0">Level 0</h1><blockquote><p>The password for the next level is stored in a file called <code>readme</code> located in the home directory. Use this password to log into bandit1 using SSH. Whenever you find a password for a level, use SSH (on port 2220) to log into that level and continue the game.</p></blockquote><p>To begin, we need to ssh into the server.</p><pre style="background-color:#ffffff;">
<code><span style="color:#323232;">ssh bandit0@bandit.labs.overthewire.org -p 2220
</span></code></pre><p>The password was given to be <code>bandit0</code>. After connecting to the server, we can list the files in the directory using <code>ls</code>.</p></div><a href="https://blog.srikavin.me/posts/overthewire-bandit/" class="blog-preview-continue-reading">Continue Reading</a></div><div class="blog-preview"><div class="blog-header"><h1 class="title"><a href="https://blog.srikavin.me/posts/pwnable-tw-orw/">pwnable.tw - orw</a></h1><div class="subtitle"><span>Posted on <span class="date" title="Created: 2019-06-11T19:45:48.202Z&#10;Updated: 2019-09-15T19:37:08.225Z">June 11, 2019* </span>in ctf-writeups</span></div><div class="tags"><a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;pwnable-tw&#x2F;"><span class="interactive minimal tag">pwnable.tw</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;binary-exploitation&#x2F;"><span class="interactive minimal tag">binary-exploitation</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;pwntools&#x2F;"><span class="interactive minimal tag">pwntools</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;assembly&#x2F;"><span class="interactive minimal tag">assembly</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;shellcode&#x2F;"><span class="interactive minimal tag">shellcode</span></a></div></div><div class="blog-content"><h1 id="challenge">Challenge</h1><blockquote><p>Read the flag from <code>/home/orw/flag</code>.</p><p>Only open read write syscall are allowed to use.</p><p><code>nc chall.pwnable.tw 10001</code></p></blockquote><h1 id="solution">Solution</h1><p>The binary simply reads in 200 bytes and then jumps to its address, after using <code>prctl</code> to prevent calling <code>execve</code>:</p><pre style="background-color:#ffffff;">
<code><span style="font-weight:bold;color:#a71d5d;">int </span><span style="font-weight:bold;color:#795da3;">main</span><span style="color:#323232;">(</span><span style="font-weight:bold;color:#a71d5d;">void</span><span style="color:#323232;">) {
  orw_seccomp();
  </span><span style="color:#62a35c;">printf</span><span style="color:#323232;">(</span><span style="color:#183691;">&quot;Give my your shellcode:&quot;</span><span style="color:#323232;">);
  read(</span><span style="color:#0086b3;">0</span><span style="color:#323232;">,shellcode,</span><span style="color:#0086b3;">200</span><span style="color:#323232;">);
  (</span><span style="font-weight:bold;color:#a71d5d;">*</span><span style="color:#323232;">(code </span><span style="font-weight:bold;color:#a71d5d;">*</span><span style="color:#323232;">)shellcode)();
  </span><span style="font-weight:bold;color:#a71d5d;">return </span><span style="color:#0086b3;">0</span><span style="color:#323232;">;
}
</span></code></pre><p>By using <code>strace</code>, we see that <code>orw_seccomp</code> calls <code>prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, {len = 12, filter = 0x400000020})</code>.<br>Based on this and the challenge description, it is clear that we cannot use a <code>execve</code> shell code like in the <a href="https://srikavin.me/blog/posts/5cfff3292569df08a43d04cc-pwnabletw-start">previous challenge</a>.</p><p>To assemble shellcode, I used an <a href="https://defuse.ca/online-x86-assembler.htm">online x86 assembler</a> rather than setting up nasm. We know that the flag is located in <code>/home/orw/flag</code>. Our shellcode needs to accomplish the following:</p></div><a href="https://blog.srikavin.me/posts/pwnable-tw-orw/" class="blog-preview-continue-reading">Continue Reading</a></div><div class="blog-preview"><div class="blog-header"><h1 class="title"><a href="https://blog.srikavin.me/posts/picoctf-2018-lambdash/">picoCTF 2018 - Lambdash</a></h1><div class="subtitle"><span>Posted on <span class="date" title="Created: 2018-10-18T14:08:16.365Z&#10;Updated: 2019-02-09T07:15:03.393Z">October 18, 2018* </span>in ctf-writeups</span></div><div class="tags"><a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;picoctf18&#x2F;"><span class="interactive minimal tag">picoctf18</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;web&#x2F;"><span class="interactive minimal tag">web</span></a></div></div><div class="blog-content"><h1 id="problem">Problem</h1><blockquote><p>C? Who uses that anymore. If we really want to be secure, we should all start learning lambda calculus. http://2018shell2.picoctf.com:41367</p></blockquote><h1 id="solution">Solution</h1><p>An extremely large payload to the interpreter results in an <code>node.js</code> error message</p><pre style="background-color:#ffffff;">
<code><span style="color:#323232;">PayloadTooLargeError: request entity too large
    at readStream (/problems/lambdash-3_0_867a993b23b277b2e144cc3e2d73f6e4/node_modules/raw-body/index.js:155:17)
    at getRawBody (/problems/lambdash-3_0_867a993b23b277b2e144cc3e2d73f6e4/node_modules/raw-body/index.js:108:12)
    at read (/problems/lambdash-3_0_867a993b23b277b2e144cc3e2d73f6e4/node_modules/body-parser/lib/read.js:77:3)
    at urlencodedParser (/problems/lambdash-3_0_867a993b23b277b2e144cc3e2d73f6e4/node_modules/body-parser/lib/types/urlencoded.js:116:5)
    at Layer.handle [as handle_request] (/problems/lambdash-3_0_867a993b23b277b2e144cc3e2d73f6e4/node_modules/express/lib/router/layer.js:95:5)
    at trim_prefix (/problems/lambdash-3_0_867a993b23b277b2e144cc3e2d73f6e4/node_modules/express/lib/router/index.js:317:13)
    at /problems/lambdash-3_0_867a993b23b277b2e144cc3e2d73f6e4/node_modules/express/lib/router/index.js:284:7
    at Function.process_params (/problems/lambdash-3_0_867a993b23b277b2e144cc3e2d73f6e4/node_modules/express/lib/router/index.js:335:12)
    at next (/problems/lambdash-3_0_867a993b23b277b2e144cc3e2d73f6e4/node_modules/express/lib/router/index.js:275:10)
    at expressInit (/problems/lambdash-3_0_867a993b23b277b2e144cc3e2d73f6e4/node_modules/express/lib/middleware/init.js:40:5)
</span></code></pre></div><a href="https://blog.srikavin.me/posts/picoctf-2018-lambdash/" class="blog-preview-continue-reading">Continue Reading</a></div><div class="blog-preview"><div class="blog-header"><h1 class="title"><a href="https://blog.srikavin.me/posts/picoctf-2018-circuit123/">picoCTF 2018 - circuit123</a></h1><div class="subtitle"><span>Posted on <span class="date" title="Created: 2018-10-17T02:23:29.709Z&#10;Updated: 2018-10-17T02:29:08.242Z">October 17, 2018* </span>in ctf-writeups</span></div><div class="tags"><a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;picoctf18&#x2F;"><span class="interactive minimal tag">picoctf18</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;python&#x2F;"><span class="interactive minimal tag">python</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;z3&#x2F;"><span class="interactive minimal tag">z3</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;reversing&#x2F;"><span class="interactive minimal tag">reversing</span></a></div></div><div class="blog-content"><h1 id="problem">Problem</h1><blockquote><p>Can you crack the key to <a href="https://2018shell2.picoctf.com/static/27ebc8a7ba2202cfcba1471080e05e2c/decrypt.py">decrypt</a> <a href="https://2018shell2.picoctf.com/static/27ebc8a7ba2202cfcba1471080e05e2c/map2.txt">map2</a> for us? The key to <a href="https://2018shell2.picoctf.com/static/27ebc8a7ba2202cfcba1471080e05e2c/map1.txt">map1</a> is 11443513758266689915.</p></blockquote><h2 id="hint">Hint</h2><blockquote><p>z3</p></blockquote><h1 id="solution">Solution</h1><p>Given the problem and the hint, it is clear that we can use z3 to solve this problem. We can create a z3 <code>BitVec</code> and pass it into the verify function to avoid writing a custom decrypter. Because we don't know the length of the bit vector, I used a conservative estimate of <code>128</code>.</p></div><a href="https://blog.srikavin.me/posts/picoctf-2018-circuit123/" class="blog-preview-continue-reading">Continue Reading</a></div><div class="blog-preview"><div class="blog-header"><h1 class="title"><a href="https://blog.srikavin.me/posts/picoctf-2018-be-quick-or-be-dead-3/">picoCTF 2018 - be-quick-or-be-dead-3</a></h1><div class="subtitle"><span>Posted on <span class="date" title="Created: 2018-10-16T13:53:29.636Z&#10;Updated: 2018-10-19T00:42:37.752Z">October 16, 2018* </span>in ctf-writeups</span></div><div class="tags"><a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;picoctf18&#x2F;"><span class="interactive minimal tag">picoctf18</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;binary-exploitation&#x2F;"><span class="interactive minimal tag">binary-exploitation</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;reversing&#x2F;"><span class="interactive minimal tag">reversing</span></a></div></div><div class="blog-content"><h1 id="problem">Problem</h1><blockquote><p>As the <a href="https://www.youtube.com/watch?v=CTt1vk9nM9c">song</a> draws closer to the end, another executable <a href="https://2018shell2.picoctf.com/static/1da7d7f7d74df19b7bdb54a3294dd930/be-quick-or-be-dead-3">be-quick-or-be-dead-3</a> suddenly pops up. This one requires even faster machines. Can you run it fast enough too?</p></blockquote><h1 id="solution">Solution</h1><p>After decompiling the program with <a href="https://derevenets.com/">Snowman</a>, we can see pseudocode for the <code>calc</code> function:</p><pre style="background-color:#ffffff;">
<code><span style="color:#0086b3;">uint32_t </span><span style="font-weight:bold;color:#795da3;">calc</span><span style="color:#323232;">(</span><span style="color:#0086b3;">uint32_t </span><span style="color:#323232;">edi) {
    </span><span style="color:#0086b3;">uint32_t</span><span style="color:#323232;"> eax2;
    </span><span style="color:#0086b3;">uint32_t</span><span style="color:#323232;"> eax3;
    </span><span style="color:#0086b3;">uint32_t</span><span style="color:#323232;"> eax4;
    </span><span style="color:#0086b3;">uint32_t</span><span style="color:#323232;"> eax5;
    </span><span style="color:#0086b3;">uint32_t</span><span style="color:#323232;"> eax6;
    </span><span style="color:#0086b3;">uint32_t</span><span style="color:#323232;"> v7;

    </span><span style="font-weight:bold;color:#a71d5d;">if </span><span style="color:#323232;">(edi </span><span style="font-weight:bold;color:#a71d5d;">&gt; </span><span style="color:#0086b3;">4</span><span style="color:#323232;">) {
        eax2 </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#323232;">calc(edi </span><span style="font-weight:bold;color:#a71d5d;">- </span><span style="color:#0086b3;">1</span><span style="color:#323232;">);
        eax3 </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#323232;">calc(edi </span><span style="font-weight:bold;color:#a71d5d;">- </span><span style="color:#0086b3;">2</span><span style="color:#323232;">);
        eax4 </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#323232;">calc(edi </span><span style="font-weight:bold;color:#a71d5d;">- </span><span style="color:#0086b3;">3</span><span style="color:#323232;">);
        eax5 </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#323232;">calc(edi </span><span style="font-weight:bold;color:#a71d5d;">- </span><span style="color:#0086b3;">4</span><span style="color:#323232;">);
        eax6 </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#323232;">calc(edi </span><span style="font-weight:bold;color:#a71d5d;">- </span><span style="color:#0086b3;">5</span><span style="color:#323232;">);
        v7 </span><span style="font-weight:bold;color:#a71d5d;">=</span><span style="color:#323232;"> eax6 </span><span style="font-weight:bold;color:#a71d5d;">* </span><span style="color:#0086b3;">0x1234 </span><span style="font-weight:bold;color:#a71d5d;">+ </span><span style="color:#323232;">(eax2 </span><span style="font-weight:bold;color:#a71d5d;">-</span><span style="color:#323232;"> eax3 </span><span style="font-weight:bold;color:#a71d5d;">+ </span><span style="color:#323232;">(eax4 </span><span style="font-weight:bold;color:#a71d5d;">-</span><span style="color:#323232;"> eax5));
    } </span><span style="font-weight:bold;color:#a71d5d;">else </span><span style="color:#323232;">{
        v7 </span><span style="font-weight:bold;color:#a71d5d;">=</span><span style="color:#323232;"> edi </span><span style="font-weight:bold;color:#a71d5d;">*</span><span style="color:#323232;"> edi </span><span style="font-weight:bold;color:#a71d5d;">+ </span><span style="color:#0086b3;">0x2345</span><span style="color:#323232;">;
    }
    </span><span style="font-weight:bold;color:#a71d5d;">return</span><span style="color:#323232;"> v7;
}
</span></code></pre></div><a href="https://blog.srikavin.me/posts/picoctf-2018-be-quick-or-be-dead-3/" class="blog-preview-continue-reading">Continue Reading</a></div><div class="blog-preview"><div class="blog-header"><h1 class="title"><a href="https://blog.srikavin.me/posts/picoctf-2018-dog-or-frog/">picoCTF 2018 - Dog or Frog</a></h1><div class="subtitle"><span>Posted on <span class="date" title="Created: 2018-10-14T03:51:44.809Z&#10;Updated: 2018-10-14T06:43:05.105Z">October 14, 2018* </span>in ctf-writeups</span></div><div class="tags"><a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;picoctf18&#x2F;"><span class="interactive minimal tag">picoctf18</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;machine-learning&#x2F;"><span class="interactive minimal tag">machine-learning</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;adversarial-learning&#x2F;"><span class="interactive minimal tag">adversarial-learning</span></a></div></div><div class="blog-content"><h1 id="problem">Problem</h1><blockquote><p>Dressing up dogs are kinda the new thing, see if you can get this lovely girl ready for her costume party. <a href="http://2018shell2.picoctf.com:5467/">Dog Or Frog</a></p></blockquote><h1 id="solution">Solution</h1><p>When we visit the page, we are greeted with a submission form. The instructions tell us that this is a machine learning problem and to not approach it as a web-exploitation problem. The goal is to submit an image that is similar (on a byte-by-byte basis) that is similar to the dog, but is recognized as a tree frog.</p><p><img alt="" src="https://blog.srikavin.me/posts/picoctf-2018-dog-or-frog/5bc2bb38da39a06603ce0d43.png"></p></div><a href="https://blog.srikavin.me/posts/picoctf-2018-dog-or-frog/" class="blog-preview-continue-reading">Continue Reading</a></div><div class="blog-preview"><div class="blog-header"><h1 class="title"><a href="https://blog.srikavin.me/posts/picoctf-2018-electric/">picoCTF 2018 - eleCTRic</a></h1><div class="subtitle"><span>Posted on <span class="date" title="Created: 2018-10-13T02:36:19.176Z&#10;Updated: 2018-12-28T23:10:12.884Z">October 13, 2018* </span>in ctf-writeups</span></div><div class="tags"><a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;picoctf18&#x2F;"><span class="interactive minimal tag">picoctf18</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;cryptography&#x2F;"><span class="interactive minimal tag">cryptography</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;aes-ctr&#x2F;"><span class="interactive minimal tag">aes-ctr</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;aes&#x2F;"><span class="interactive minimal tag">aes</span></a></div></div><div class="blog-content"><h1 id="problem">Problem</h1><blockquote><p>&quot;You came across a custom server that Dr Xernon's company eleCTRic Ltd uses. It seems to be storing some encrypted files. Connect with <code>nc 2018shell2.picoctf.com 15037</code>. Can you get us the flag?&quot; <a href="https://2018shell2.picoctf.com/static/61d78e61c2bd099775499bba7edc1d62/eleCTRic.py">Source</a></p></blockquote><h1 id="solution">Solution</h1><p>The title makes a clear reference to <a href="https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#Counter_(CTR)">AES-CTR</a>. We can see that this mode of AES requires a unique nonce for each encrypted value to remain cryptographically secure. If we look at the problem's source code, we can see that the counter remains constant for all values. This breaks the encryption used and we are able to reveal the keystream and encrypt arbritary data.</p><pre style="background-color:#ffffff;">
<code><span style="font-weight:bold;color:#a71d5d;">class </span><span style="color:#0086b3;">AESCipher</span><span style="color:#323232;">(</span><span style="color:#0086b3;">object</span><span style="color:#323232;">):
    </span><span style="font-weight:bold;color:#a71d5d;">def </span><span style="font-weight:bold;color:#62a35c;">__init__</span><span style="color:#323232;">(self):
        self.bs </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#0086b3;">32
        </span><span style="color:#323232;">random </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#323232;">Random.new()
        self.key </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#323232;">random.read(</span><span style="color:#0086b3;">AES</span><span style="color:#323232;">.block_size)
        self.ctr </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#323232;">random.read(</span><span style="color:#0086b3;">AES</span><span style="color:#323232;">.block_size)

    </span><span style="font-weight:bold;color:#a71d5d;">def </span><span style="font-weight:bold;color:#323232;">encrypt</span><span style="color:#323232;">(self, raw):
        cipher </span><span style="font-weight:bold;color:#a71d5d;">= </span><span style="color:#323232;">AES.new(self.key, </span><span style="color:#0086b3;">AES</span><span style="color:#323232;">.</span><span style="color:#0086b3;">MODE_CTR</span><span style="color:#323232;">, counter</span><span style="font-weight:bold;color:#a71d5d;">=lambda</span><span style="color:#323232;">: self.ctr)
        </span><span style="font-weight:bold;color:#a71d5d;">return </span><span style="color:#323232;">cipher.encrypt(raw).encode(</span><span style="color:#183691;">&#39;base64&#39;</span><span style="color:#323232;">).replace(</span><span style="color:#183691;">&#39;</span><span style="color:#0086b3;">\n</span><span style="color:#183691;">&#39;</span><span style="color:#323232;">, </span><span style="color:#183691;">&#39;&#39;</span><span style="color:#323232;">)
</span></code></pre></div><a href="https://blog.srikavin.me/posts/picoctf-2018-electric/" class="blog-preview-continue-reading">Continue Reading</a></div><div class="blog-preview"><div class="blog-header"><h1 class="title"><a href="https://blog.srikavin.me/posts/picoctf-2018-flaskcards-and-freedom/">picoCTF 2018 - Flaskcards and Freedom</a></h1><div class="subtitle"><span>Posted on <span class="date" title="Created: 2018-10-12T21:02:44.42Z&#10;Updated: 2018-10-12T22:55:27.216Z">October 12, 2018* </span>in ctf-writeups</span></div><div class="tags"><a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;picoctf18&#x2F;"><span class="interactive minimal tag">picoctf18</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;web&#x2F;"><span class="interactive minimal tag">web</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;python&#x2F;"><span class="interactive minimal tag">python</span></a> <a href="https:&#x2F;&#x2F;blog.srikavin.me&#x2F;tags&#x2F;rce&#x2F;"><span class="interactive minimal tag">rce</span></a></div></div><div class="blog-content"><h1 id="problem">Problem</h1><blockquote><p>&quot;There seem to be a few more files stored on the flash card server but we can't login. Can you?&quot;</p></blockquote><h1 id="solution">Solution</h1><p>The site appears to be the same as the previous flaskcard challenges <code>Flaskcards Skeleton Key</code> and <code>Flaskcards.</code></p><p>When we create an account, we are presented with the following screen: <img alt="" src="https://blog.srikavin.me/posts/picoctf-2018-flaskcards-and-freedom/5bc10c83f1882e545d7f430a.png"></p><p>We can try server side injection. If we type in <code>{{1+1}}</code>, the webpage displays <code>2</code>. Any values in double brackets is being executed on the server. After trying to find hidden variables, such as <code>config</code>, <code>flag</code>, etc; I decided to look for a remote code execution vulnerability.</p></div><a href="https://blog.srikavin.me/posts/picoctf-2018-flaskcards-and-freedom/" class="blog-preview-continue-reading">Continue Reading</a></div></div></div></div></section><script src="/bundle.js"></script></body></html>